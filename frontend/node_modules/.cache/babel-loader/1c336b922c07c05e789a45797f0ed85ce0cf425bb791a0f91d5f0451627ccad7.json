{"ast":null,"code":"// NOTE: All backend API calls should use process.env.REACT_APP_API_URL (set in .env) for the base URL.\nimport React,{useState,useEffect}from'react';import{Car,ArrowLeft,Save,Send,CheckCircle,Loader2,Calendar,DollarSign,User,MapPin,Phone,Mail,Hash,Palette,Gauge,Info,Plus,AlertCircle}from'lucide-react';import{useAuth}from'./AuthContext';import{useNavigate}from'react-router-dom';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const NewDealEntry=()=>{const{user:currentUser,getAuthHeaders}=useAuth();const navigate=useNavigate();// Redirect to login if not authenticated\nuseEffect(()=>{if(!currentUser){navigate('/login');}},[currentUser,navigate]);// Utility to get backend API URL\nconst API_BASE=process.env.REACT_APP_API_URL||'';// Utility to merge auth headers\nconst buildHeaders=function(){let extra=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const headers={...getAuthHeaders(),'Content-Type':'application/json',...extra};// Debug: log token presence\nif(!headers['Authorization']){console.warn('[DEAL SUBMIT] No Authorization token in headers!');}else{console.log('[DEAL SUBMIT] Using Authorization header:',headers['Authorization']);}return headers;};const todayStr=new Date().toISOString().slice(0,10);const[formData,setFormData]=useState({// Vehicle Information\nvin:'',year:'',make:'',model:'',mileage:'',exteriorColor:'',interiorColor:'',// Deal Information\ndealType:'',dealType2SubType:'',// <-- Add this for Deal Type 2 sub-options\nfundingSource:'',purchaseDate:todayStr,paymentMethod:'check',// Default to 'check'\ncurrentStage:'contract-received',// Financial Information\npurchasePrice:'',listPrice:'',killPrice:'',wholesalePrice:'',commissionRate:'',brokerageFee:'',brokerageFeePaidTo:'',payoffBalance:'',amountDueToCustomer:'',amountDueToRP:'',// Seller Information\nsellerName:'',sellerAddress:'',sellerPhone:'',sellerEmail:'',sellerLicenseNumber:'',sellerTier:'Tier 1',// Buyer Information (for buy/sell deals)\nbuyerName:'',buyerAddress:'',buyerPhone:'',buyerEmail:'',buyerLicenseNumber:'',buyerTier:'Tier 1',// Buy/Sell Configuration\nbuyerType:'dealer',// 'private' or 'dealer' - default to dealer for buy/sell\nsellerType:'private',// 'private' or 'dealer'\n// RP Information\nrpStockNumber:'',vehicleDescription:'',generalNotes:'',// Documentation\ncontractRequired:false,titlePresent:false,driverLicensePresent:false,odometerPresent:false,dealerLicensePresent:false,documents:[],// For uploaded files\nsalesperson:''});const[vinDecoding,setVinDecoding]=useState(false);const[vinDecoded,setVinDecoded]=useState(false);const[dealerSuggestions,setDealerSuggestions]=useState([]);const[dealerBuyerSuggestions,setDealerBuyerSuggestions]=useState([]);// For Dealer Info (Buyer)\nconst[dealerSearch,setDealerSearch]=useState('');const[formErrors,setFormErrors]=useState({});const[saving,setSaving]=useState(false);const[currentStep,setCurrentStep]=useState(1);// Remove documentTypes and documentTypeSelections state\n// Add notes state for each file\nconst[documentNotes,setDocumentNotes]=useState([]);// Array of {fileIndex, note}\nuseEffect(()=>{// Fetch document types from backend\nfetch(`/api/backoffice/document-types`,{credentials:'include'}).then(res=>res.json()).then(data=>{if(data.success&&Array.isArray(data.data)){// setDocumentTypes(data.data); // This line is removed\n}}).catch(()=>{// setDocumentTypes([]); // This line is removed\n});},[]);// Helper function to format currency input\nconst formatCurrency=value=>{if(!value)return'';// Remove all non-numeric characters except decimal point\nconst numericValue=value.toString().replace(/[^\\d.]/g,'');// Ensure only one decimal point\nconst parts=numericValue.split('.');if(parts.length>2){return parts[0]+'.'+parts.slice(1).join('');}return numericValue;};// Add a helper to join address parts into a single line\nfunction joinAddress(address){if(!address)return'';const{street,city,state,zip}=address;return[street,city,state,zip].filter(Boolean).join(', ');}// Add a helper to parse a single line address into parts\nfunction parseAddress(full){if(!full)return{street:'',city:'',state:'',zip:''};const parts=full.split(',').map(s=>s.trim());return{street:parts[0]||'',city:parts[1]||'',state:parts[2]||'',zip:parts[3]||''};}// Get dynamic labels based on deal type\nconst getDynamicLabels=()=>{const dealType2=formData.dealType2SubType;const isRetailPP=formData.dealType==='retail-pp';return{purchasePriceLabel:dealType2==='sale'?'Sale Price':'Purchase Price',sellerLabel:dealType2==='sale'?'Sold To':'Purchased From',sellerSectionTitle:dealType2==='sale'?'Buyer Information':'Seller Information',// For retail PP deals, use more generic labels\ncompanyLabel:isRetailPP?'Company (if applicable)':'Company/Dealer',licenseLabel:isRetailPP?'License Number (if applicable)':'Dealer License Number',addressLabel:isRetailPP?'Address':'Seller Address'};};const dynamicLabels=getDynamicLabels();// Remove Deal Type 2 from main dealTypes\nconst dealTypes=[{value:'wholesale-d2d',label:'Wholesale - D2D'},{value:'wholesale-private',label:'Wholesale - Private Party'},{value:'wholesale-flip',label:'Wholesale - Flip'},{value:'retail-pp',label:'Retail - PP'},{value:'retail-auction',label:'Retail - Auction'},{value:'retail-dtod',label:'Retail - DtoD'},{value:'auction',label:'Auction'}];const fundingSources=[{value:'flpn-retail',label:'FLPN - Retail'},{value:'flpn-wholesale',label:'FLPN - Wholesale'},{value:'cash',label:'Cash'},{value:'flooring-line',label:'Flooring Line'},{value:'consignment',label:'Consignment'}];const paymentMethods=[{value:'check',label:'Check'},{value:'wire',label:'Wire Transfer'},{value:'ach',label:'ACH'},{value:'cash',label:'Cash'},{value:'financed',label:'Financed'}];const dealType2SubOptions=[{value:'buy',label:'Buy'},{value:'sale',label:'Sale'},{value:'buy-sell',label:'Buy/Sell'},{value:'consign-a',label:'Consign-A'},{value:'consign-b',label:'Consign-B'},{value:'consign-c',label:'Consign-C'},{value:'consign-rdnc',label:'Consign-RDNC'}];// Add to formData initial state\n// This block is removed as per the edit hint.\n// Add salesperson options\nconst salespersonOptions=[{value:'Brennan S',label:'Brennan S'},{value:'Parker G',label:'Parker G'},{value:'Dan M',label:'Dan M'},{value:'Adiana P',label:'Adiana P'},{value:'Brett M',label:'Brett M'},{value:'Other',label:'Other'}];// Get deal type specific fields\nconst getDealTypeFields=()=>{// Both dealType and dealType2SubType are always required\nconst dealType=formData.dealType;return{showFinancials:['wholesale-d2d','wholesale-private','wholesale-flip','retail-pp','retail-auction','retail-dtod','auction'].includes(dealType),showSellerInfo:true,showDocumentation:['wholesale-d2d','wholesale-private','wholesale-flip','retail-pp','retail-auction','retail-dtod','auction'].includes(dealType),requiredFields:['vin','dealType','dealType2SubType','year','make','model','sellerName']};};const dealTypeFields=getDealTypeFields();// Real VIN decode function using backend API\nconst decodeVIN=async vin=>{setVinDecoding(true);try{const headers={...getAuthHeaders(),'Content-Type':'application/json'};console.log('[VIN DECODE] Sending request with headers:',headers);const response=await fetch(`/api/deals/vin/decode`,{method:'POST',headers,body:JSON.stringify({vin}),credentials:'include'});console.log('[VIN DECODE] Response status:',response.status);const data=await response.json();console.log('[VIN DECODE] Response data:',data);if(data.success&&data.data){setFormData(prev=>({...prev,year:data.data.year||'',make:data.data.make||'',model:data.data.model||''}));setVinDecoded(true);setTimeout(()=>setVinDecoded(false),3000);}else{console.error('VIN decode failed:',data.error);alert(data.error||'Unable to decode VIN. Please check the VIN and try again.');}}catch(error){console.error('[VIN DECODE] Error:',error);alert('Unable to decode VIN. Please check your connection and try again.');}finally{setVinDecoding(false);}};// Real dealer search using backend API\nconst searchDealers=async query=>{if(query.length<2){setDealerSuggestions([]);return;}// setSearchingDealers(true); // Removed unused state\ntry{const response=await fetch(`/api/dealers/search?q=${encodeURIComponent(query)}`,{credentials:'include'});const data=await response.json();setDealerSuggestions(data.dealers||[]);console.log('[DEALER SEARCH] Suggestions:',data.dealers||[]);}catch(error){console.error('Dealer search error:',error);setDealerSuggestions([]);}};// Dealer search for Dealer Info (Buyer)\nconst searchDealersBuyer=async query=>{if(query.length<2){setDealerBuyerSuggestions([]);return;}try{const response=await fetch(`/api/dealers/search?q=${encodeURIComponent(query)}`,{credentials:'include'});const data=await response.json();setDealerBuyerSuggestions(data.dealers||[]);}catch(error){console.error('Dealer search error:',error);setDealerBuyerSuggestions([]);}};// Autofill dealer info when a suggestion is selected\nconst handleDealerSuggestionClick=dealer=>{setFormData(prev=>{const updated={...prev,sellerName:dealer.name||'',sellerAddress:dealer.addressString||'',sellerPhone:dealer.phone||'',sellerEmail:dealer.email||'',sellerLicenseNumber:dealer.licenseNumber||'',sellerTier:dealer.tier||'Tier 1',sellerType:'dealer'// Set sellerType to dealer when a dealer is selected\n};console.log('[DEBUG] handleDealerSuggestionClick - sellerType set to:',updated.sellerType);return updated;});setDealerSuggestions([]);setDealerSearch('');console.log('[DEALER AUTOFILL] Selected dealer:',dealer);console.log('[DEALER AUTOFILL] Autofilled address:',dealer.addressString);console.log('[DEALER AUTOFILL] Autofilled license number:',dealer.licenseNumber);};// Auto-generate stock number\n// useEffect(() => {\n//   if (!formData.rpStockNumber && formData.year && formData.make) {\n//     const year = new Date().getFullYear();\n//     const stockNumber = `RP${year}${String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0')}`;\n//     setFormData(prev => ({ ...prev, rpStockNumber: stockNumber }));\n//   }\n// }, [formData.year, formData.make, formData.rpStockNumber]);\nconst handleInputChange=(field,value)=>{let processedValue=value;// Handle currency formatting for financial fields\nif(['purchasePrice','listPrice','killPrice','wholesalePrice','brokerageFee','payoffBalance','amountDueToCustomer','amountDueToRP'].includes(field)){processedValue=formatCurrency(value);}// If changing dealType, reset dealType2SubType unless still deal-type-2\nif(field==='dealType'){setFormData(prev=>({...prev,dealType:processedValue,dealType2SubType:processedValue==='deal-type-2'?prev.dealType2SubType:processedValue==='wholesale-flip'?'buy-sell':''}));if(currentStep>1)setCurrentStep(1);return;}setFormData(prev=>({...prev,[field]:processedValue}));// Clear error when user starts typing\nif(formErrors[field]){setFormErrors(prev=>({...prev,[field]:null}));}// Trigger VIN decode when VIN is 17 characters\nif(field==='vin'&&processedValue.length===17&&!vinDecoded){decodeVIN(processedValue);}// Search dealers when typing in seller field (only if seller type is dealer)\nif(field==='sellerName'){if(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell'){// For buy/sell deals, only search if seller type is dealer\nif(formData.sellerType==='dealer'){searchDealers(processedValue);}else{setDealerSuggestions([]);// Clear suggestions for private party\n}}else{// For other deals, always search\nsearchDealers(processedValue);}}// Search dealers when typing in buyer field (only if buyer type is dealer)\nif(field==='buyerName'){if(formData.buyerType==='dealer'){searchDealersBuyer(processedValue);}else{setDealerBuyerSuggestions([]);// Clear suggestions for private party\n}}// Clear dealer suggestions when switching types\nif(field==='sellerType'||field==='buyerType'){if(field==='sellerType'&&processedValue==='private'){setDealerSuggestions([]);}if(field==='buyerType'&&processedValue==='private'){setDealerBuyerSuggestions([]);}}// Reset to step 1 when deal type changes\nif(field==='dealType'&&currentStep>1){setCurrentStep(1);}};// Handle file uploads for documentation\nconst handleDocumentUpload=e=>{const files=Array.from(e.target.files);setFormData(prev=>({...prev,documents:[...(prev.documents||[]),...files]}));setDocumentNotes(prev=>[...prev,...files.map((_,i)=>({fileIndex:prev.length+i,note:''}))]);};const handleRemoveDocument=index=>{setFormData(prev=>({...prev,documents:prev.documents.filter((_,i)=>i!==index)}));setDocumentNotes(prev=>prev.filter(sel=>sel.fileIndex!==index).map(sel=>({...sel,fileIndex:sel.fileIndex>index?sel.fileIndex-1:sel.fileIndex})));};const handleDocumentNoteChange=(fileIndex,note)=>{setDocumentNotes(prev=>{const found=prev.find(sel=>sel.fileIndex===fileIndex);if(found){return prev.map(sel=>sel.fileIndex===fileIndex?{...sel,note}:sel);}else{return[...prev,{fileIndex,note}];}});};// When a dealer is selected for seller, autofill full address and license number\nconst handleDealerSuggestionSelect=dealer=>{setFormData(prev=>{const updated={...prev,sellerName:dealer.name||'',sellerCompany:dealer.company||'',sellerPhone:dealer.phone||'',sellerEmail:dealer.email||'',sellerAddress:dealer.addressString||'',sellerLicenseNumber:dealer.licenseNumber||'',sellerTier:dealer.tier||'Tier 1',sellerType:'dealer'// Set sellerType to dealer when a dealer is selected\n};console.log('[DEBUG] handleDealerSuggestionSelect - sellerType set to:',updated.sellerType);return updated;});setDealerSuggestions([]);setDealerSearch('');};// When a dealer is selected for buyer, autofill full address and license number\nconst handleBuyerDealerSuggestionSelect=dealer=>{setFormData(prev=>({...prev,buyerName:dealer.name||'',buyerAddress:dealer.addressString||'',buyerPhone:dealer.phone||'',buyerEmail:dealer.email||'',buyerLicenseNumber:dealer.licenseNumber||'',buyerTier:dealer.tier||'Tier 1'}));setDealerBuyerSuggestions([]);console.log('[BUYER DEALER AUTOFILL] Selected dealer:',dealer);};const validateForm=()=>{const errors={};let requiredFields=dealTypeFields.requiredFields||['vin','dealType','dealType2SubType','year','make','model','sellerName'];// Add buyer fields for buy/sell deals\nif(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell'){requiredFields=[...requiredFields,'buyerName'];}requiredFields.forEach(field=>{if(!formData[field]||formData[field].toString().trim()===''){errors[field]=`${field.charAt(0).toUpperCase()+field.slice(1)} is required`;}});// Additional validation for specific fields\n// REMOVE strict VIN length check\n// if (formData.vin && formData.vin.length !== 17) {\n//   errors.vin = 'VIN must be exactly 17 characters';\n// }\nif(formData.year&&(formData.year<1900||formData.year>new Date().getFullYear()+1)){errors.year='Please enter a valid year';}if(formData.mileage&&formData.mileage<0){errors.mileage='Mileage cannot be negative';}if(dealTypeFields.showFinancials&&formData.purchasePrice&&formData.purchasePrice<=0){errors.purchasePrice='Purchase price must be greater than 0';}setFormErrors(errors);return Object.keys(errors).length===0;};const handleSave=async function(){let isDraft=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!currentUser){alert('You must be logged in to submit a deal.');navigate('/login');return;}if(!isDraft&&!validateForm()){console.log('[DEAL SUBMIT] Validation errors:',formErrors);return;}setSaving(true);try{// Debug: log formData before building dealData\nconsole.log('[DEAL SUBMIT] formData:',formData);console.log('[DEBUG] handleSave - sellerType in formData:',formData.sellerType);// Log all financial fields from formData\nconsole.log('[DEAL SUBMIT] Financial fields:',{brokerageFee:formData.brokerageFee,brokerageFeePaidTo:formData.brokerageFeePaidTo,payoffBalance:formData.payoffBalance,amountDueToCustomer:formData.amountDueToCustomer,amountDueToRP:formData.amountDueToRP,commissionRate:formData.commissionRate});const currentStage='contract-received';// First, create the deal in the backend\nconst dealData={vehicle:`${formData.year} ${formData.make} ${formData.model}`,vin:formData.vin,year:parseInt(formData.year),make:formData.make,model:formData.model,rpStockNumber:formData.rpStockNumber,color:formData.exteriorColor,exteriorColor:formData.exteriorColor,// Add this field\ninteriorColor:formData.interiorColor,// Add this field\nmileage:parseInt(formData.mileage)||0,purchasePrice:parseFloat(formData.purchasePrice)||0,listPrice:parseFloat(formData.listPrice)||0,killPrice:parseFloat(formData.killPrice)||0,wholesalePrice:parseFloat(formData.wholesalePrice)||0,dealType:formData.dealType,dealType2SubType:formData.dealType2SubType,// <-- Ensure this is sent\ndealType2:formData.dealType2SubType,// <-- Add this for backend compatibility\nseller:{name:formData.sellerName,type:formData.sellerType||(formData.dealType==='wholesale-flip'?'private':formData.dealType.includes('private')?'private':'dealer'),contact:{address:parseAddress(formData.sellerAddress),// Use parsed address\nphone:formData.sellerPhone,email:formData.sellerEmail},licenseNumber:formData.sellerLicenseNumber,tier:formData.sellerTier},// Always include buyer info if present\nbuyer:{name:formData.buyerName,type:formData.buyerType,contact:{address:parseAddress(formData.buyerAddress),phone:formData.buyerPhone,email:formData.buyerEmail},licenseNumber:formData.buyerLicenseNumber,tier:formData.buyerTier},fundingSource:formData.fundingSource,paymentMethod:formData.paymentMethod,purchaseDate:formData.purchaseDate?new Date(formData.purchaseDate):new Date(),currentStage:currentStage||'contract-received',salesperson:currentUser.name||'Unknown',// Use current user's name as salesperson\n// --- Add all financial fields below ---\nbrokerFee:parseFloat(formData.brokerageFee)||0,brokerFeePaidTo:formData.brokerageFeePaidTo||'',payoffBalance:parseFloat(formData.payoffBalance)||0,amountDueToCustomer:parseFloat(formData.amountDueToCustomer)||0,amountDueToRP:parseFloat(formData.amountDueToRP)||0,commissionRate:parseFloat(formData.commissionRate)||0,generalNotes:formData.generalNotes// <-- Ensure this is sent\n};console.log('[DEBUG] handleSave - dealData.seller.type:',dealData.seller.type);// Debug: log license numbers being sent\nconsole.log('[DEAL SUBMIT] SENDING seller license number:',formData.sellerLicenseNumber);console.log('[DEAL SUBMIT] SENDING buyer license number:',formData.buyerLicenseNumber);// Debug: log dealData before sending\nconsole.log('[DEAL SUBMIT] dealData to backend:',dealData);// Force as last resort\ndealData.currentStage='contract-received';console.log('[DEBUG] dealData.currentStage (final):',dealData.currentStage);console.log('[DEBUG] Full dealData:',dealData);// Create deal (this would be your existing deal creation endpoint)\nconst dealResponse=await fetch(`/api/deals`,{method:'POST',headers:buildHeaders(),body:JSON.stringify(dealData),credentials:'include'});// Debug: log backend response status\nconsole.log('[DEAL SUBMIT] Backend response status:',dealResponse.status);const dealResult=await dealResponse.json().catch(()=>({}));console.log('[DEAL SUBMIT] Backend response JSON:',dealResult);if(!dealResponse.ok){console.log('[DEAL SUBMIT] Backend error response:',dealResult);throw new Error('Failed to create deal');}const dealId=dealResult.deal._id;// Debug: Log what we're sending for document generation\nconsole.log('[DEAL SUBMIT] 🚀 Sending document generation request with:');console.log('[DEAL SUBMIT] 🚀 - dealType2SubType from formData:',formData.dealType2SubType);console.log('[DEAL SUBMIT] 🚀 - dealType2 from formData:',formData.dealType2SubType);// Generate document and create vehicle record\nconst documentResponse=await fetch(`/api/documents/generate/${dealId}`,{method:'POST',headers:buildHeaders(),body:JSON.stringify({dealType2:formData.dealType2SubType,dealType2SubType:formData.dealType2SubType,// Explicitly send dealType2SubType\ncommissionRate:parseFloat(formData.commissionRate)||0,stockNumber:formData.rpStockNumber,wholesalePrice:parseFloat(formData.wholesalePrice)||0,generalNotes:formData.generalNotes,vehicleDescription:formData.vehicleDescription,buyerName:formData.buyerName,buyerType:formData.buyerType,buyerAddress:formData.buyerAddress,buyerPhone:formData.buyerPhone,buyerEmail:formData.buyerEmail,buyerLicenseNumber:formData.buyerLicenseNumber,buyerTier:formData.buyerTier,sellerType:formData.sellerType}),credentials:'include'// Ensure cookies/session are sent for authentication\n});if(!documentResponse.ok){const err=await documentResponse.json().catch(()=>({}));throw new Error(err.error||'Failed to generate document');}const documentResult=await documentResponse.json();// --- UPLOAD USER DOCUMENTS ---\nif(formData.documents&&formData.documents.length>0){for(let i=0;i<formData.documents.length;i++){const file=formData.documents[i];const noteObj=documentNotes.find(sel=>sel.fileIndex===i);const note=noteObj?noteObj.note:'';const documentType='extra_doc';const form=new FormData();form.append('document',file);if(note)form.append('notes',note);try{const uploadRes=await fetch(`/api/backoffice/deals/${dealId}/documents/${documentType}/upload`,{method:'POST',headers:{'Authorization':getAuthHeaders()['Authorization']},body:form,credentials:'include'});if(!uploadRes.ok){const err=await uploadRes.json().catch(()=>({}));toast.error(`Failed to upload ${file.name}: ${err.error||uploadRes.statusText}`);}else{toast.success(`Uploaded ${file.name}`);}}catch(err){toast.error(`Error uploading ${file.name}: ${err.message}`);}}}// --- END UPLOAD USER DOCUMENTS ---\nconsole.log('Deal created and document generated:',documentResult);// Show success message with document info\nconst successMessage=isDraft?'Draft saved successfully!':`Deal submitted successfully!\\n\\nYour deal has been sent to the back office for processing. You will be notified when the deal is complete.`;toast.success(successMessage);// Optionally redirect to a success page or clear form\nif(!isDraft){// Clear form or redirect\nsetFormData({vin:'',year:'',make:'',model:'',mileage:'',exteriorColor:'',interiorColor:'',dealType:'',dealType2SubType:'',fundingSource:'',purchaseDate:todayStr,paymentMethod:'check',currentStage:'contract-received',purchasePrice:'',listPrice:'',killPrice:'',wholesalePrice:'',commissionRate:'',brokerageFee:'',brokerageFeePaidTo:'',payoffBalance:'',amountDueToCustomer:'',amountDueToRP:'',sellerName:'',sellerAddress:'',sellerPhone:'',sellerEmail:'',sellerLicenseNumber:'',sellerTier:'Tier 1',buyerName:'',buyerAddress:'',buyerPhone:'',buyerEmail:'',buyerLicenseNumber:'',buyerTier:'Tier 1',buyerType:'dealer',sellerType:'private',rpStockNumber:'',vehicleDescription:'',generalNotes:'',contractRequired:false,titlePresent:false,driverLicensePresent:false,odometerPresent:false,dealerLicensePresent:false,documents:[],salesperson:''});setCurrentStep(1);}}catch(error){if(error.message.includes('401')||error.message.includes('not authorized')){alert('Session expired or not authorized. Please log in again.');navigate('/login');}else{alert(`Error saving deal: ${error.message}`);console.log('[DEAL SUBMIT] Error:',error);}}finally{setSaving(false);}};const handleEmailToListingTeam=()=>{const emailBody=`New Vehicle Ready for Listing\n\nVehicle: ${formData.year} ${formData.make} ${formData.model}\nVIN: ${formData.vin}\nStock #: ${formData.rpStockNumber}\nMileage: ${formData.mileage}\nExterior: ${formData.exteriorColor}\nInterior: ${formData.interiorColor}\n\nDescription:\n${formData.vehicleDescription}\n\nPlease prepare listing materials for this vehicle.\n\nBest regards,\n${currentUser.name}`;const mailtoLink=`mailto:listing@rpexotics.com?subject=New Vehicle for Listing - ${formData.year} ${formData.make} ${formData.model}&body=${encodeURIComponent(emailBody)}`;window.open(mailtoLink);};// Remove handleCompleteDeal and use handleSave for final submission\n// Update button text and alerts\nconst renderStepIndicator=()=>/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:Array.from({length:totalSteps},(_,index)=>{const stepNumber=index+1;const isActive=currentStep===stepNumber;const isCompleted=currentStep>stepNumber;let stepTitle='';let stepDescription='';if(stepNumber===1){stepTitle='Vehicle & Deal Type';stepDescription='Enter vehicle information and select deal type';}else if(stepNumber===2){stepTitle='Deal Configuration';stepDescription='Configure funding, payment, and timeline';}else if(stepNumber===3&&dealTypeFields.showFinancials){stepTitle='Financial Information';stepDescription='Set pricing and financial terms';}else if(stepNumber===3&&!dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo||stepNumber===4&&dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo){stepTitle='Seller Information';stepDescription='Add seller contact information';}else if(stepNumber===3&&!dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation||stepNumber===4&&dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation||stepNumber===5&&dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation){stepTitle='Documentation & Notes';stepDescription='Document status and additional notes';}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors ${isActive?'bg-blue-600 border-blue-600 text-white':isCompleted?'bg-green-600 border-green-600 text-white':'bg-white/10 border-white/20 text-gray-400'}`,children:isCompleted?/*#__PURE__*/_jsx(CheckCircle,{className:\"h-5 w-5\"}):/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:stepNumber})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:`text-sm font-medium ${isActive?'text-white':'text-gray-400'}`,children:stepTitle}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:stepDescription})]}),stepNumber<totalSteps&&/*#__PURE__*/_jsx(\"div\",{className:`w-16 h-0.5 mx-4 ${isCompleted?'bg-green-600':'bg-white/20'}`})]},stepNumber);})})});const renderFormField=function(label,field){let type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'text';let options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let required=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;let icon=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;let isDealerBuyer=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center text-sm font-medium text-gray-300\",children:[icon&&/*#__PURE__*/React.createElement(icon,{className:\"h-4 w-4 mr-2\"}),label,required&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400 ml-1\",children:\"*\"})]}),type==='select'?/*#__PURE__*/_jsxs(\"select\",{value:formData[field],onChange:e=>handleInputChange(field,e.target.value),className:`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${formErrors[field]?'border-red-500':'border-white/20 hover:border-white/30'}`,children:[/*#__PURE__*/_jsxs(\"option\",{value:\"\",children:[\"Select \",label]}),options===null||options===void 0?void 0:options.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,className:\"bg-gray-800\",children:option.label},option.value))]}):type==='textarea'?/*#__PURE__*/_jsx(\"textarea\",{value:formData[field],onChange:e=>handleInputChange(field,e.target.value),rows:4,placeholder:`Enter ${label.toLowerCase()}...`,className:`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-none ${formErrors[field]?'border-red-500':'border-white/20 hover:border-white/30'}`}):type==='checkbox'?/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!formData[field],onChange:e=>handleInputChange(field,e.target.checked),className:\"rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-300\",children:label})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[['purchasePrice','listPrice','killPrice','wholesalePrice','brokerageFee','payoffBalance','amountDueToCustomer','amountDueToRP'].includes(field)&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm\",children:\"$\"}),/*#__PURE__*/_jsx(\"input\",{type:type,value:formData[field]||'',onChange:e=>{handleInputChange(field,e.target.value);},placeholder:`Enter ${label.toLowerCase()}...`,className:`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${formErrors[field]?'border-red-500':'border-white/20 hover:border-white/30'} ${field==='vin'?'pr-20':''} ${['purchasePrice','listPrice','killPrice','wholesalePrice','brokerageFee','payoffBalance','amountDueToCustomer','amountDueToRP'].includes(field)?'pl-8':''}`}),field==='vin'&&formData.vin.length===17&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-2 top-1/2 transform -translate-y-1/2\",children:vinDecoding?/*#__PURE__*/_jsx(Loader2,{className:\"h-5 w-5 text-blue-400 animate-spin\"}):vinDecoded?/*#__PURE__*/_jsx(CheckCircle,{className:\"h-5 w-5 text-green-400\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>decodeVIN(formData.vin),className:\"bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded transition-colors\",children:\"Decode\"})}),isDealerBuyer&&field==='dealerName'&&dealerBuyerSuggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\",children:dealerBuyerSuggestions.map(dealer=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\",onClick:()=>{setFormData(prev=>{var _dealer$contact;return{...prev,dealerName:dealer.name,dealerCompany:dealer.company,dealerPhone:dealer.phone,dealerEmail:((_dealer$contact=dealer.contact)===null||_dealer$contact===void 0?void 0:_dealer$contact.email)||dealer.email||'',dealerAddress:dealer.location||dealer.address||''};});setDealerBuyerSuggestions([]);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-white\",children:dealer.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-400\",children:[dealer.company,\" \\u2022 \",dealer.location]})]},dealer.id))}),field==='buyerName'&&formData.buyerType==='dealer'&&dealerBuyerSuggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\",children:dealerBuyerSuggestions.map(dealer=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\",onClick:()=>{handleBuyerDealerSuggestionSelect(dealer);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-white\",children:dealer.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-400\",children:[dealer.company,\" \\u2022 \",dealer.location]})]},dealer.id))}),field==='sellerName'&&dealerSuggestions.length>0&&(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell'&&formData.sellerType==='dealer'||!['retail-pp','retail-auction','retail-dtod'].includes(formData.dealType)&&!(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell'))&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\",children:dealerSuggestions.map(dealer=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\",onClick:()=>{handleDealerSuggestionSelect(dealer);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-white\",children:dealer.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-400\",children:[dealer.company,\" \\u2022 \",dealer.location]})]},dealer.id))})]}),formErrors[field]&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-red-400 text-sm\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"h-4 w-4 mr-1\"}),formErrors[field]]})]});};const renderStep=()=>{switch(currentStep){case 1:return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:\"Deal Type Selection\"}),renderFormField('Deal Type','dealType','select',dealTypes,true,Car),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:renderFormField('Deal Type 2','dealType2SubType','select',dealType2SubOptions,true)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:\"Vehicle Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:renderFormField('VIN','vin','text',null,true,Hash)}),renderFormField('Year','year','number',null,true,Calendar),renderFormField('Make','make','text',null,true),renderFormField('Model','model','text',null,true),renderFormField('Mileage','mileage','number',null,false,Gauge),renderFormField('Exterior Color','exteriorColor','text',null,false,Palette),renderFormField('Interior Color','interiorColor','text',null,false,Palette)]})]})]});case 2:return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:\"Deal Configuration\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[renderFormField('Funding Source','fundingSource','select',fundingSources,true,DollarSign),renderFormField('Purchase/Sale Date','purchaseDate','date',null,true,Calendar),renderFormField('Payment Method','paymentMethod','select',paymentMethods,true),renderFormField('RP Stock Number','rpStockNumber','text',null,false,Hash),renderFormField('Salesperson','salesperson','select',salespersonOptions,true,User)]})]})});case 3:return dealTypeFields.showFinancials?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:\"Financial Information\"}),formData.dealType2SubType==='sale'?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[renderFormField(dynamicLabels.purchasePriceLabel,'purchasePrice','number',null,true,DollarSign),renderFormField('Brokerage Fee','brokerageFee','number'),renderFormField('Brokerage Fee Paid To','brokerageFeePaidTo','text'),renderFormField('Amount Due to Customer','amountDueToCustomer','number'),renderFormField('Amount Due to RP','amountDueToRP','number')]}):/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[renderFormField(dynamicLabels.purchasePriceLabel,'purchasePrice','number',null,true,DollarSign),renderFormField('Kill Price','killPrice','number'),renderFormField('Wholesale Price','wholesalePrice','number'),renderFormField('List Price','listPrice','number'),['consign-a','consign-b','consign-c','consign-rdnc'].includes(formData.dealType2SubType)?renderFormField('Commission Rate (%)','commissionRate','number'):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[renderFormField('Brokerage Fee','brokerageFee','number'),renderFormField('Brokerage Fee Paid To','brokerageFeePaidTo','text'),renderFormField('Payoff Balance','payoffBalance','number'),renderFormField('Amount Due to Customer','amountDueToCustomer','number'),renderFormField('Amount Due to RP','amountDueToRP','number')]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-2\",children:\"Financial Information Not Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"This deal type does not require financial information.\"})]});case 4:// Seller/Dealer Info step\nif(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell'){return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10 space-y-10\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white\",children:\"Buyer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('buyerType','private'),className:`px-3 py-1 rounded-lg border transition-colors text-sm ${formData.buyerType==='private'?'bg-blue-600 border-blue-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Private Party\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('buyerType','dealer'),className:`px-3 py-1 rounded-lg border transition-colors text-sm ${formData.buyerType==='dealer'?'bg-green-600 border-green-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Dealer\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[renderFormField(formData.buyerType==='dealer'?'Dealer Name':'Buyer Name','buyerName','text',null,true,User),renderFormField('Phone','buyerPhone','tel',null,false,Phone),renderFormField('Email','buyerEmail','email',null,false,Mail),renderFormField('Address','buyerAddress','text',null,false,MapPin),formData.buyerType==='dealer'&&renderFormField('Dealer License Number','buyerLicenseNumber','text'),formData.buyerType==='dealer'&&!(formData.dealType==='wholesale-d2d'&&formData.dealType2SubType==='buy')&&renderFormField('Dealer Tier','buyerTier','select',[{value:'Tier 1',label:'Tier 1: Pay Upon Title'},{value:'Tier 2',label:'Tier 2: Pay Prior to Release'}])]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white\",children:\"Seller Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('sellerType','private'),className:`px-3 py-1 rounded-lg border transition-colors text-sm ${formData.sellerType==='private'?'bg-blue-600 border-blue-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Private Party\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('sellerType','dealer'),className:`px-3 py-1 rounded-lg border transition-colors text-sm ${formData.sellerType==='dealer'?'bg-green-600 border-green-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Dealer\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[renderFormField(formData.sellerType==='dealer'?'Dealer Name':'Seller Name','sellerName','text',null,true,User),renderFormField('Phone','sellerPhone','tel',null,false,Phone),renderFormField('Email','sellerEmail','email',null,false,Mail),renderFormField('Address','sellerAddress','text',null,false,MapPin),formData.sellerType==='dealer'&&renderFormField('Dealer License Number','sellerLicenseNumber','text'),formData.sellerType==='dealer'&&!(formData.dealType==='wholesale-flip'&&formData.dealType2SubType==='buy-sell')&&!(formData.dealType==='wholesale-d2d'&&formData.dealType2SubType==='buy')&&renderFormField('Dealer Tier','sellerTier','select',[{value:'Tier 1',label:'Tier 1: Pay Upon Title'},{value:'Tier 2',label:'Tier 2: Pay Prior to Release'}])]})]})]});}else{const isRetailPP=formData.dealType==='retail-pp';return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:dynamicLabels.sellerSectionTitle}),isRetailPP?/*#__PURE__*/// Retail PP - 2x2 grid layout\n_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:renderFormField(dynamicLabels.sellerLabel,'sellerName','text',null,true,User)}),renderFormField('Phone','sellerPhone','tel',null,false,Phone),renderFormField('Email','sellerEmail','email',null,false,Mail),renderFormField('Address','sellerAddress','text',null,false,MapPin)]}):/*#__PURE__*/// Other deal types - original layout\n_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:renderFormField(dynamicLabels.sellerLabel,'sellerName','text',null,true,User)}),!isRetailPP&&renderFormField(dynamicLabels.companyLabel,'sellerCompany','text'),renderFormField('Phone','sellerPhone','tel',null,false,Phone),renderFormField('Email','sellerEmail','email',null,false,Mail),renderFormField(dynamicLabels.addressLabel,'sellerAddress','text',null,false,MapPin),formData.dealType==='wholesale-d2d'&&formData.dealType2SubType!=='buy'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"seller-license-number\",className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Dealer License Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"seller-license-number\",value:formData.sellerLicenseNumber||'',onChange:e=>handleInputChange('sellerLicenseNumber',e.target.value),className:\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-white mb-2\",children:\"Dealer Tier\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('sellerTier','Tier 1'),className:`px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier==='Tier 1'?'bg-red-600 border-red-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Tier 1 - Pay Upon Title\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleInputChange('sellerTier','Tier 2'),className:`px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier==='Tier 2'?'bg-green-600 border-green-500 text-white':'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,children:\"Tier 2 - Pay Prior to Release\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-1\",children:\"Tier 1: Pay Upon Title. Tier 2: Pay Prior to Release.\"})]})]})]})]});}case 5:return dealTypeFields.showDocumentation?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 rounded-xl p-6 border border-white/10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-4\",children:\"Documentation & Notes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-medium text-white mb-4\",children:\"Documentation Status\"}),renderFormField('Contract Required','contractRequired','checkbox'),renderFormField('Title Present','titlePresent','checkbox'),renderFormField('Driver License Present','driverLicensePresent','checkbox'),renderFormField('Odometer Present','odometerPresent','checkbox'),renderFormField('Dealer License Present','dealerLicensePresent','checkbox')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[renderFormField('Vehicle Description','vehicleDescription','textarea',null,false,Info),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-white mb-2\",children:\"Upload Documents/Photos\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\"image/*,application/pdf\",onChange:handleDocumentUpload,className:\"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700\"}),formData.documents&&formData.documents.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 space-y-2\",children:formData.documents.map((file,i)=>{var _documentNotes$find;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 bg-white/10 rounded p-2\",children:[file.type&&file.type.startsWith('image')?/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:file.name,className:\"h-12 w-12 object-cover rounded\"}):/*#__PURE__*/_jsx(\"span\",{className:\"inline-block w-12 h-12 bg-gray-700 text-white flex items-center justify-center rounded\",children:\"PDF\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm truncate max-w-xs\",children:file.name}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:((_documentNotes$find=documentNotes.find(sel=>sel.fileIndex===i))===null||_documentNotes$find===void 0?void 0:_documentNotes$find.note)||'',onChange:e=>handleDocumentNoteChange(i,e.target.value),placeholder:\"Add a note (optional)\",className:\"bg-white/10 border rounded-lg px-2 py-1 text-white text-sm\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ml-auto text-red-400 hover:text-red-600 text-xs font-medium\",onClick:()=>handleRemoveDocument(i),children:\"Remove\"})]},i);})})]})]})]}),/*#__PURE__*/_jsx(\"div\",{children:renderFormField('General Notes','generalNotes','textarea',null,false,Info)})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(Info,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-2\",children:\"Documentation Not Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"This deal type does not require documentation tracking.\"})]});default:return null;}};// Calculate total steps based on deal type\nconst getTotalSteps=()=>{let steps=2;// Always have vehicle info and deal config\nif(dealTypeFields.showFinancials)steps++;if(dealTypeFields.showSellerInfo)steps++;if(dealTypeFields.showDocumentation)steps++;return steps;};const totalSteps=getTotalSteps();// Add a constant for the unified status options\nconst STATUS_OPTIONS=[{value:'contract-received',label:'Contract Received'},{value:'title-processing',label:'Title Processing'},{value:'payment-approved',label:'Payment Approved'},{value:'funds-disbursed',label:'Funds Disbursed'},{value:'title-received',label:'Title Received'},{value:'deal-complete',label:'Deal Complete'}];const statusCompatMap={'initial-contact':'contract-received','documentation':'title-processing','finance':'payment-approved','completion':'deal-complete'};// At the top, define the valid backend status values:\nconst VALID_STATUSES=['contract-received','title-processing','payment-approved','funds-disbursed','title-received','deal-complete'];return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 overflow-hidden pointer-events-none\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/5 rounded-full blur-3xl animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-1000\"})]}),/*#__PURE__*/_jsx(\"header\",{className:\"relative bg-black/20 backdrop-blur-md border-b border-white/10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.history.back(),className:\"mr-4 p-2 bg-white/10 hover:bg-white/20 rounded-lg border border-white/20 transition-colors\",children:/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-5 w-5 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl p-3 mr-4 shadow-lg shadow-blue-500/25\",children:/*#__PURE__*/_jsx(Plus,{className:\"h-6 w-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-white\",children:\"New Deal Entry\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300 text-sm\",children:\"Create a new vehicle deal\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSave(true),disabled:saving,className:\"flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/20 transition-colors disabled:opacity-50\",children:[saving?/*#__PURE__*/_jsx(Loader2,{className:\"h-4 w-4 mr-2 animate-spin\"}):/*#__PURE__*/_jsx(Save,{className:\"h-4 w-4 mr-2\"}),\"Save Draft\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSave(false),disabled:saving,className:\"flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50\",children:[saving?/*#__PURE__*/_jsx(Loader2,{className:\"h-4 w-4 mr-2 animate-spin\"}):/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 mr-2\"}),\"Create Deal\"]})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative max-w-6xl mx-auto px-6 py-8\",children:[renderStepIndicator(),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-2\",children:[currentStep===1&&'Vehicle Information & Deal Type',currentStep===2&&'Deal Configuration',currentStep===3&&dealTypeFields.showFinancials&&'Financial Information',currentStep===3&&!dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo&&'Seller Information',currentStep===3&&!dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation&&'Documentation & Notes',currentStep===4&&dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo&&'Seller Information',currentStep===4&&dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation&&'Documentation & Notes',currentStep===5&&'Documentation & Notes']}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-300\",children:[currentStep===1&&'Enter basic vehicle information and select the deal type',currentStep===2&&'Configure deal type, funding, and timeline',currentStep===3&&dealTypeFields.showFinancials&&'Set pricing and financial terms',currentStep===3&&!dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo&&'Add seller contact information',currentStep===3&&!dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation&&'Document status and additional notes',currentStep===4&&dealTypeFields.showFinancials&&dealTypeFields.showSellerInfo&&'Add seller contact information',currentStep===4&&dealTypeFields.showFinancials&&!dealTypeFields.showSellerInfo&&dealTypeFields.showDocumentation&&'Document status and additional notes',currentStep===5&&'Document status and additional notes']})]}),renderStep(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-8 pt-6 border-t border-white/10\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentStep(Math.max(1,currentStep-1)),disabled:currentStep===1,className:\"flex items-center px-4 py-2 text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-4 w-4 mr-2\"}),\"Previous\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[currentStep===totalSteps&&formData.vehicleDescription&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleEmailToListingTeam,className:\"flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(Send,{className:\"h-4 w-4 mr-2\"}),\"Email to Listing Team\"]}),currentStep<totalSteps?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentStep(Math.min(totalSteps,currentStep+1)),className:\"flex items-center px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-colors\",children:[\"Next\",/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-4 w-4 ml-2 rotate-180\"})]}):/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSave(false),disabled:saving,className:\"flex items-center px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-lg transition-colors disabled:opacity-50\",children:[saving?/*#__PURE__*/_jsx(Loader2,{className:\"h-4 w-4 mr-2 animate-spin\"}):/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 mr-2\"}),\"Submit Deal\"]})]})]})]}),vinDecoding&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 right-6 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"h-4 w-4 mr-2 animate-spin\"}),\"Decoding VIN...\"]}),vinDecoded&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 right-6 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 mr-2\"}),\"VIN decoded successfully!\"]})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default NewDealEntry;","map":{"version":3,"names":["React","useState","useEffect","Car","ArrowLeft","Save","Send","CheckCircle","Loader2","Calendar","DollarSign","User","MapPin","Phone","Mail","Hash","Palette","Gauge","Info","Plus","AlertCircle","useAuth","useNavigate","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NewDealEntry","user","currentUser","getAuthHeaders","navigate","API_BASE","process","env","REACT_APP_API_URL","buildHeaders","extra","arguments","length","undefined","headers","console","warn","log","todayStr","Date","toISOString","slice","formData","setFormData","vin","year","make","model","mileage","exteriorColor","interiorColor","dealType","dealType2SubType","fundingSource","purchaseDate","paymentMethod","currentStage","purchasePrice","listPrice","killPrice","wholesalePrice","commissionRate","brokerageFee","brokerageFeePaidTo","payoffBalance","amountDueToCustomer","amountDueToRP","sellerName","sellerAddress","sellerPhone","sellerEmail","sellerLicenseNumber","sellerTier","buyerName","buyerAddress","buyerPhone","buyerEmail","buyerLicenseNumber","buyerTier","buyerType","sellerType","rpStockNumber","vehicleDescription","generalNotes","contractRequired","titlePresent","driverLicensePresent","odometerPresent","dealerLicensePresent","documents","salesperson","vinDecoding","setVinDecoding","vinDecoded","setVinDecoded","dealerSuggestions","setDealerSuggestions","dealerBuyerSuggestions","setDealerBuyerSuggestions","dealerSearch","setDealerSearch","formErrors","setFormErrors","saving","setSaving","currentStep","setCurrentStep","documentNotes","setDocumentNotes","fetch","credentials","then","res","json","data","success","Array","isArray","catch","formatCurrency","value","numericValue","toString","replace","parts","split","join","joinAddress","address","street","city","state","zip","filter","Boolean","parseAddress","full","map","s","trim","getDynamicLabels","dealType2","isRetailPP","purchasePriceLabel","sellerLabel","sellerSectionTitle","companyLabel","licenseLabel","addressLabel","dynamicLabels","dealTypes","label","fundingSources","paymentMethods","dealType2SubOptions","salespersonOptions","getDealTypeFields","showFinancials","includes","showSellerInfo","showDocumentation","requiredFields","dealTypeFields","decodeVIN","response","method","body","JSON","stringify","status","prev","setTimeout","error","alert","searchDealers","query","encodeURIComponent","dealers","searchDealersBuyer","handleDealerSuggestionClick","dealer","updated","name","addressString","phone","email","licenseNumber","tier","handleInputChange","field","processedValue","handleDocumentUpload","e","files","from","target","_","i","fileIndex","note","handleRemoveDocument","index","sel","handleDocumentNoteChange","found","find","handleDealerSuggestionSelect","sellerCompany","company","handleBuyerDealerSuggestionSelect","validateForm","errors","forEach","charAt","toUpperCase","getFullYear","Object","keys","handleSave","isDraft","dealData","vehicle","parseInt","color","parseFloat","seller","type","contact","buyer","brokerFee","brokerFeePaidTo","dealResponse","dealResult","ok","Error","dealId","deal","_id","documentResponse","stockNumber","err","documentResult","file","noteObj","documentType","form","FormData","append","uploadRes","statusText","message","successMessage","handleEmailToListingTeam","emailBody","mailtoLink","window","open","renderStepIndicator","className","children","totalSteps","stepNumber","isActive","isCompleted","stepTitle","stepDescription","renderFormField","options","required","icon","isDealerBuyer","createElement","onChange","option","rows","placeholder","toLowerCase","checked","onClick","_dealer$contact","dealerName","dealerCompany","dealerPhone","dealerEmail","dealerAddress","location","id","renderStep","htmlFor","multiple","accept","_documentNotes$find","startsWith","src","URL","createObjectURL","alt","getTotalSteps","steps","STATUS_OPTIONS","statusCompatMap","VALID_STATUSES","history","back","disabled","Math","max","min"],"sources":["/Users/bsauer02/Desktop/Opis3.0/rp-exotics-unified/frontend/src/components/NewDealEntry.js"],"sourcesContent":["// NOTE: All backend API calls should use process.env.REACT_APP_API_URL (set in .env) for the base URL.\nimport React, { useState, useEffect } from 'react';\nimport { \n  Car, ArrowLeft, Save, Send, CheckCircle, Loader2, \n  Calendar, DollarSign, User, \n  MapPin, Phone, Mail, Hash, Palette, Gauge, \n  Info, Plus, AlertCircle \n} from 'lucide-react';\nimport { useAuth } from './AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nconst NewDealEntry = () => {\n  const { user: currentUser, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n    }\n  }, [currentUser, navigate]);\n\n  // Utility to get backend API URL\n  const API_BASE = process.env.REACT_APP_API_URL || '';\n\n  // Utility to merge auth headers\n  const buildHeaders = (extra = {}) => {\n    const headers = {\n      ...getAuthHeaders(),\n      'Content-Type': 'application/json',\n      ...extra\n    };\n    // Debug: log token presence\n    if (!headers['Authorization']) {\n      console.warn('[DEAL SUBMIT] No Authorization token in headers!');\n    } else {\n      console.log('[DEAL SUBMIT] Using Authorization header:', headers['Authorization']);\n    }\n    return headers;\n  };\n\n  const todayStr = new Date().toISOString().slice(0, 10);\n\n  const [formData, setFormData] = useState({\n    // Vehicle Information\n    vin: '',\n    year: '',\n    make: '',\n    model: '',\n    mileage: '',\n    exteriorColor: '',\n    interiorColor: '',\n    \n    // Deal Information\n    dealType: '',\n    dealType2SubType: '', // <-- Add this for Deal Type 2 sub-options\n    fundingSource: '',\n    purchaseDate: todayStr,\n    paymentMethod: 'check', // Default to 'check'\n    currentStage: 'contract-received',\n    \n    // Financial Information\n    purchasePrice: '',\n    listPrice: '',\n    killPrice: '',\n    wholesalePrice: '',\n    commissionRate: '',\n    brokerageFee: '',\n    brokerageFeePaidTo: '',\n    payoffBalance: '',\n    amountDueToCustomer: '',\n    amountDueToRP: '',\n    \n    // Seller Information\n    sellerName: '',\n    sellerAddress: '',\n    sellerPhone: '',\n    sellerEmail: '',\n    sellerLicenseNumber: '',\n    sellerTier: 'Tier 1',\n    \n    // Buyer Information (for buy/sell deals)\n    buyerName: '',\n    buyerAddress: '',\n    buyerPhone: '',\n    buyerEmail: '',\n    buyerLicenseNumber: '',\n    buyerTier: 'Tier 1',\n    \n    // Buy/Sell Configuration\n    buyerType: 'dealer', // 'private' or 'dealer' - default to dealer for buy/sell\n    sellerType: 'private', // 'private' or 'dealer'\n    \n    // RP Information\n    rpStockNumber: '',\n    vehicleDescription: '',\n    generalNotes: '',\n    \n    // Documentation\n    contractRequired: false,\n    titlePresent: false,\n    driverLicensePresent: false,\n    odometerPresent: false,\n    dealerLicensePresent: false,\n    documents: [], // For uploaded files\n    salesperson: ''\n  });\n\n  const [vinDecoding, setVinDecoding] = useState(false);\n  const [vinDecoded, setVinDecoded] = useState(false);\n  const [dealerSuggestions, setDealerSuggestions] = useState([]);\n  const [dealerBuyerSuggestions, setDealerBuyerSuggestions] = useState([]); // For Dealer Info (Buyer)\n  const [dealerSearch, setDealerSearch] = useState('');\n  const [formErrors, setFormErrors] = useState({});\n  const [saving, setSaving] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  // Remove documentTypes and documentTypeSelections state\n  // Add notes state for each file\n  const [documentNotes, setDocumentNotes] = useState([]); // Array of {fileIndex, note}\n\n  useEffect(() => {\n    // Fetch document types from backend\n    fetch(`/api/backoffice/document-types`, { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => {\n        if (data.success && Array.isArray(data.data)) {\n          // setDocumentTypes(data.data); // This line is removed\n        }\n      })\n      .catch(() => {\n        // setDocumentTypes([]); // This line is removed\n      });\n  }, []);\n\n  // Helper function to format currency input\n  const formatCurrency = (value) => {\n    if (!value) return '';\n    // Remove all non-numeric characters except decimal point\n    const numericValue = value.toString().replace(/[^\\d.]/g, '');\n    // Ensure only one decimal point\n    const parts = numericValue.split('.');\n    if (parts.length > 2) {\n      return parts[0] + '.' + parts.slice(1).join('');\n    }\n    return numericValue;\n  };\n\n  // Add a helper to join address parts into a single line\n  function joinAddress(address) {\n    if (!address) return '';\n    const { street, city, state, zip } = address;\n    return [street, city, state, zip].filter(Boolean).join(', ');\n  }\n  // Add a helper to parse a single line address into parts\n  function parseAddress(full) {\n    if (!full) return { street: '', city: '', state: '', zip: '' };\n    const parts = full.split(',').map(s => s.trim());\n    return {\n      street: parts[0] || '',\n      city: parts[1] || '',\n      state: parts[2] || '',\n      zip: parts[3] || ''\n    };\n  }\n\n\n  // Get dynamic labels based on deal type\n  const getDynamicLabels = () => {\n    const dealType2 = formData.dealType2SubType;\n    const isRetailPP = formData.dealType === 'retail-pp';\n    \n    return {\n      purchasePriceLabel: dealType2 === 'sale' ? 'Sale Price' : 'Purchase Price',\n      sellerLabel: dealType2 === 'sale' ? 'Sold To' : 'Purchased From',\n      sellerSectionTitle: dealType2 === 'sale' ? 'Buyer Information' : 'Seller Information',\n      // For retail PP deals, use more generic labels\n      companyLabel: isRetailPP ? 'Company (if applicable)' : 'Company/Dealer',\n      licenseLabel: isRetailPP ? 'License Number (if applicable)' : 'Dealer License Number',\n      addressLabel: isRetailPP ? 'Address' : 'Seller Address'\n    };\n  };\n\n  const dynamicLabels = getDynamicLabels();\n\n  // Remove Deal Type 2 from main dealTypes\n  const dealTypes = [\n    { value: 'wholesale-d2d', label: 'Wholesale - D2D' },\n    { value: 'wholesale-private', label: 'Wholesale - Private Party' },\n    { value: 'wholesale-flip', label: 'Wholesale - Flip' },\n    { value: 'retail-pp', label: 'Retail - PP' },\n    { value: 'retail-auction', label: 'Retail - Auction' },\n    { value: 'retail-dtod', label: 'Retail - DtoD' },\n    { value: 'auction', label: 'Auction' }\n  ];\n\n  const fundingSources = [\n    { value: 'flpn-retail', label: 'FLPN - Retail' },\n    { value: 'flpn-wholesale', label: 'FLPN - Wholesale' },\n    { value: 'cash', label: 'Cash' },\n    { value: 'flooring-line', label: 'Flooring Line' },\n    { value: 'consignment', label: 'Consignment' }\n  ];\n\n  const paymentMethods = [\n    { value: 'check', label: 'Check' },\n    { value: 'wire', label: 'Wire Transfer' },\n    { value: 'ach', label: 'ACH' },\n    { value: 'cash', label: 'Cash' },\n    { value: 'financed', label: 'Financed' }\n  ];\n\n  const dealType2SubOptions = [\n    { value: 'buy', label: 'Buy' },\n    { value: 'sale', label: 'Sale' },\n    { value: 'buy-sell', label: 'Buy/Sell' },\n    { value: 'consign-a', label: 'Consign-A' },\n    { value: 'consign-b', label: 'Consign-B' },\n    { value: 'consign-c', label: 'Consign-C' },\n    { value: 'consign-rdnc', label: 'Consign-RDNC' }\n  ];\n\n  // Add to formData initial state\n  // This block is removed as per the edit hint.\n\n  // Add salesperson options\n  const salespersonOptions = [\n    { value: 'Brennan S', label: 'Brennan S' },\n    { value: 'Parker G', label: 'Parker G' },\n    { value: 'Dan M', label: 'Dan M' },\n    { value: 'Adiana P', label: 'Adiana P' },\n    { value: 'Brett M', label: 'Brett M' },\n    { value: 'Other', label: 'Other' }\n  ];\n\n  // Get deal type specific fields\n  const getDealTypeFields = () => {\n    // Both dealType and dealType2SubType are always required\n    const dealType = formData.dealType;\n    return {\n      showFinancials: [\n        'wholesale-d2d', 'wholesale-private', 'wholesale-flip',\n        'retail-pp', 'retail-auction', 'retail-dtod', 'auction'\n      ].includes(dealType),\n      showSellerInfo: true,\n      showDocumentation: [\n        'wholesale-d2d', 'wholesale-private', 'wholesale-flip',\n        'retail-pp', 'retail-auction', 'retail-dtod', 'auction'\n      ].includes(dealType),\n      requiredFields: ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName']\n    };\n  };\n\n  const dealTypeFields = getDealTypeFields();\n\n  // Real VIN decode function using backend API\n  const decodeVIN = async (vin) => {\n    setVinDecoding(true);\n    try {\n      const headers = { ...getAuthHeaders(), 'Content-Type': 'application/json' };\n      console.log('[VIN DECODE] Sending request with headers:', headers);\n      const response = await fetch(`/api/deals/vin/decode`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ vin }),\n        credentials: 'include'\n      });\n      console.log('[VIN DECODE] Response status:', response.status);\n      const data = await response.json();\n      console.log('[VIN DECODE] Response data:', data);\n      if (data.success && data.data) {\n        setFormData(prev => ({\n          ...prev,\n          year: data.data.year || '',\n          make: data.data.make || '',\n          model: data.data.model || ''\n        }));\n        setVinDecoded(true);\n        setTimeout(() => setVinDecoded(false), 3000);\n      } else {\n        console.error('VIN decode failed:', data.error);\n        alert(data.error || 'Unable to decode VIN. Please check the VIN and try again.');\n      }\n    } catch (error) {\n      console.error('[VIN DECODE] Error:', error);\n      alert('Unable to decode VIN. Please check your connection and try again.');\n    } finally {\n      setVinDecoding(false);\n    }\n  };\n\n  // Real dealer search using backend API\n  const searchDealers = async (query) => {\n    if (query.length < 2) {\n      setDealerSuggestions([]);\n      return;\n    }\n    // setSearchingDealers(true); // Removed unused state\n    try {\n      const response = await fetch(`/api/dealers/search?q=${encodeURIComponent(query)}`, { credentials: 'include' });\n      const data = await response.json();\n      setDealerSuggestions(data.dealers || []);\n      console.log('[DEALER SEARCH] Suggestions:', data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerSuggestions([]);\n    }\n  };\n\n  // Dealer search for Dealer Info (Buyer)\n  const searchDealersBuyer = async (query) => {\n    if (query.length < 2) {\n      setDealerBuyerSuggestions([]);\n      return;\n    }\n    try {\n      const response = await fetch(`/api/dealers/search?q=${encodeURIComponent(query)}`, { credentials: 'include' });\n      const data = await response.json();\n      setDealerBuyerSuggestions(data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerBuyerSuggestions([]);\n    }\n  };\n\n  // Autofill dealer info when a suggestion is selected\n  const handleDealerSuggestionClick = (dealer) => {\n    setFormData(prev => {\n      const updated = {\n        ...prev,\n        sellerName: dealer.name || '',\n        sellerAddress: dealer.addressString || '',\n        sellerPhone: dealer.phone || '',\n        sellerEmail: dealer.email || '',\n        sellerLicenseNumber: dealer.licenseNumber || '',\n        sellerTier: dealer.tier || 'Tier 1',\n        sellerType: 'dealer', // Set sellerType to dealer when a dealer is selected\n      };\n      console.log('[DEBUG] handleDealerSuggestionClick - sellerType set to:', updated.sellerType);\n      return updated;\n    });\n    setDealerSuggestions([]);\n    setDealerSearch('');\n    console.log('[DEALER AUTOFILL] Selected dealer:', dealer);\n    console.log('[DEALER AUTOFILL] Autofilled address:', dealer.addressString);\n    console.log('[DEALER AUTOFILL] Autofilled license number:', dealer.licenseNumber);\n  };\n\n  // Auto-generate stock number\n  // useEffect(() => {\n  //   if (!formData.rpStockNumber && formData.year && formData.make) {\n  //     const year = new Date().getFullYear();\n  //     const stockNumber = `RP${year}${String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0')}`;\n  //     setFormData(prev => ({ ...prev, rpStockNumber: stockNumber }));\n  //   }\n  // }, [formData.year, formData.make, formData.rpStockNumber]);\n\n  const handleInputChange = (field, value) => {\n    let processedValue = value;\n    \n    // Handle currency formatting for financial fields\n    if (['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field)) {\n      processedValue = formatCurrency(value);\n    }\n    \n    // If changing dealType, reset dealType2SubType unless still deal-type-2\n    if (field === 'dealType') {\n      setFormData(prev => ({\n        ...prev,\n        dealType: processedValue,\n        dealType2SubType: processedValue === 'deal-type-2' ? prev.dealType2SubType : \n                         processedValue === 'wholesale-flip' ? 'buy-sell' : ''\n      }));\n      if (currentStep > 1) setCurrentStep(1);\n      return;\n    }\n    \n    setFormData(prev => ({ ...prev, [field]: processedValue }));\n    \n    // Clear error when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({ ...prev, [field]: null }));\n    }\n    \n    // Trigger VIN decode when VIN is 17 characters\n    if (field === 'vin' && processedValue.length === 17 && !vinDecoded) {\n      decodeVIN(processedValue);\n    }\n    \n    // Search dealers when typing in seller field (only if seller type is dealer)\n    if (field === 'sellerName') {\n      if (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') {\n        // For buy/sell deals, only search if seller type is dealer\n        if (formData.sellerType === 'dealer') {\n          searchDealers(processedValue);\n        } else {\n          setDealerSuggestions([]); // Clear suggestions for private party\n        }\n      } else {\n        // For other deals, always search\n        searchDealers(processedValue);\n      }\n    }\n\n    // Search dealers when typing in buyer field (only if buyer type is dealer)\n    if (field === 'buyerName') {\n      if (formData.buyerType === 'dealer') {\n        searchDealersBuyer(processedValue);\n      } else {\n        setDealerBuyerSuggestions([]); // Clear suggestions for private party\n      }\n    }\n\n    // Clear dealer suggestions when switching types\n    if (field === 'sellerType' || field === 'buyerType') {\n      if (field === 'sellerType' && processedValue === 'private') {\n        setDealerSuggestions([]);\n      }\n      if (field === 'buyerType' && processedValue === 'private') {\n        setDealerBuyerSuggestions([]);\n      }\n    }\n\n    // Reset to step 1 when deal type changes\n    if (field === 'dealType' && currentStep > 1) {\n      setCurrentStep(1);\n    }\n  };\n\n  // Handle file uploads for documentation\n  const handleDocumentUpload = (e) => {\n    const files = Array.from(e.target.files);\n    setFormData(prev => ({\n      ...prev,\n      documents: [...(prev.documents || []), ...files]\n    }));\n    setDocumentNotes(prev => ([\n      ...prev,\n      ...files.map((_, i) => ({ fileIndex: (prev.length + i), note: '' }))\n    ]));\n  };\n  const handleRemoveDocument = (index) => {\n    setFormData(prev => ({\n      ...prev,\n      documents: prev.documents.filter((_, i) => i !== index)\n    }));\n    setDocumentNotes(prev => prev.filter(sel => sel.fileIndex !== index).map(sel => ({ ...sel, fileIndex: sel.fileIndex > index ? sel.fileIndex - 1 : sel.fileIndex })));\n  };\n  const handleDocumentNoteChange = (fileIndex, note) => {\n    setDocumentNotes(prev => {\n      const found = prev.find(sel => sel.fileIndex === fileIndex);\n      if (found) {\n        return prev.map(sel => sel.fileIndex === fileIndex ? { ...sel, note } : sel);\n      } else {\n        return [...prev, { fileIndex, note }];\n      }\n    });\n  };\n\n  // When a dealer is selected for seller, autofill full address and license number\n  const handleDealerSuggestionSelect = (dealer) => {\n    setFormData(prev => {\n      const updated = {\n        ...prev,\n        sellerName: dealer.name || '',\n        sellerCompany: dealer.company || '',\n        sellerPhone: dealer.phone || '',\n        sellerEmail: dealer.email || '',\n        sellerAddress: dealer.addressString || '',\n        sellerLicenseNumber: dealer.licenseNumber || '',\n        sellerTier: dealer.tier || 'Tier 1',\n        sellerType: 'dealer', // Set sellerType to dealer when a dealer is selected\n      };\n      console.log('[DEBUG] handleDealerSuggestionSelect - sellerType set to:', updated.sellerType);\n      return updated;\n    });\n    setDealerSuggestions([]);\n    setDealerSearch('');\n  };\n\n  // When a dealer is selected for buyer, autofill full address and license number\n  const handleBuyerDealerSuggestionSelect = (dealer) => {\n    setFormData(prev => ({\n      ...prev,\n      buyerName: dealer.name || '',\n      buyerAddress: dealer.addressString || '',\n      buyerPhone: dealer.phone || '',\n      buyerEmail: dealer.email || '',\n      buyerLicenseNumber: dealer.licenseNumber || '',\n      buyerTier: dealer.tier || 'Tier 1'\n    }));\n    setDealerBuyerSuggestions([]);\n    console.log('[BUYER DEALER AUTOFILL] Selected dealer:', dealer);\n  };\n\n  const validateForm = () => {\n    const errors = {};\n    let requiredFields = dealTypeFields.requiredFields || ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName'];\n    \n    // Add buyer fields for buy/sell deals\n    if (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') {\n      requiredFields = [...requiredFields, 'buyerName'];\n    }\n    \n    requiredFields.forEach(field => {\n      if (!formData[field] || formData[field].toString().trim() === '') {\n        errors[field] = `${field.charAt(0).toUpperCase() + field.slice(1)} is required`;\n      }\n    });\n\n    // Additional validation for specific fields\n    // REMOVE strict VIN length check\n    // if (formData.vin && formData.vin.length !== 17) {\n    //   errors.vin = 'VIN must be exactly 17 characters';\n    // }\n\n    if (formData.year && (formData.year < 1900 || formData.year > new Date().getFullYear() + 1)) {\n      errors.year = 'Please enter a valid year';\n    }\n\n    if (formData.mileage && formData.mileage < 0) {\n      errors.mileage = 'Mileage cannot be negative';\n    }\n\n    if (dealTypeFields.showFinancials && formData.purchasePrice && formData.purchasePrice <= 0) {\n      errors.purchasePrice = 'Purchase price must be greater than 0';\n    }\n\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSave = async (isDraft = false) => {\n    if (!currentUser) {\n      alert('You must be logged in to submit a deal.');\n      navigate('/login');\n      return;\n    }\n    if (!isDraft && !validateForm()) {\n      console.log('[DEAL SUBMIT] Validation errors:', formErrors);\n      return;\n    }\n    \n    setSaving(true);\n    \n    try {\n      // Debug: log formData before building dealData\n      console.log('[DEAL SUBMIT] formData:', formData);\n      console.log('[DEBUG] handleSave - sellerType in formData:', formData.sellerType);\n      // Log all financial fields from formData\n      console.log('[DEAL SUBMIT] Financial fields:', {\n        brokerageFee: formData.brokerageFee,\n        brokerageFeePaidTo: formData.brokerageFeePaidTo,\n        payoffBalance: formData.payoffBalance,\n        amountDueToCustomer: formData.amountDueToCustomer,\n        amountDueToRP: formData.amountDueToRP,\n        commissionRate: formData.commissionRate\n      });\n      const currentStage = 'contract-received';\n      // First, create the deal in the backend\n      const dealData = {\n        vehicle: `${formData.year} ${formData.make} ${formData.model}`,\n        vin: formData.vin,\n        year: parseInt(formData.year),\n        make: formData.make,\n        model: formData.model,\n        rpStockNumber: formData.rpStockNumber,\n        color: formData.exteriorColor,\n        exteriorColor: formData.exteriorColor, // Add this field\n        interiorColor: formData.interiorColor, // Add this field\n        mileage: parseInt(formData.mileage) || 0,\n        purchasePrice: parseFloat(formData.purchasePrice) || 0,\n        listPrice: parseFloat(formData.listPrice) || 0,\n        killPrice: parseFloat(formData.killPrice) || 0,\n        wholesalePrice: parseFloat(formData.wholesalePrice) || 0,\n        dealType: formData.dealType,\n        dealType2SubType: formData.dealType2SubType, // <-- Ensure this is sent\n        dealType2: formData.dealType2SubType, // <-- Add this for backend compatibility\n        seller: {\n          name: formData.sellerName,\n          type: formData.sellerType || (formData.dealType === 'wholesale-flip' ? 'private' : formData.dealType.includes('private') ? 'private' : 'dealer'),\n          contact: {\n            address: parseAddress(formData.sellerAddress), // Use parsed address\n            phone: formData.sellerPhone,\n            email: formData.sellerEmail\n          },\n          licenseNumber: formData.sellerLicenseNumber,\n          tier: formData.sellerTier\n        },\n        // Always include buyer info if present\n        buyer: {\n          name: formData.buyerName,\n          type: formData.buyerType,\n          contact: {\n            address: parseAddress(formData.buyerAddress),\n            phone: formData.buyerPhone,\n            email: formData.buyerEmail\n          },\n          licenseNumber: formData.buyerLicenseNumber,\n          tier: formData.buyerTier\n        },\n        fundingSource: formData.fundingSource,\n        paymentMethod: formData.paymentMethod,\n        purchaseDate: formData.purchaseDate ? new Date(formData.purchaseDate) : new Date(),\n        currentStage: currentStage || 'contract-received',\n        salesperson: currentUser.name || 'Unknown', // Use current user's name as salesperson\n        // --- Add all financial fields below ---\n        brokerFee: parseFloat(formData.brokerageFee) || 0,\n        brokerFeePaidTo: formData.brokerageFeePaidTo || '',\n        payoffBalance: parseFloat(formData.payoffBalance) || 0,\n        amountDueToCustomer: parseFloat(formData.amountDueToCustomer) || 0,\n        amountDueToRP: parseFloat(formData.amountDueToRP) || 0,\n        commissionRate: parseFloat(formData.commissionRate) || 0,\n        generalNotes: formData.generalNotes // <-- Ensure this is sent\n      };\n      console.log('[DEBUG] handleSave - dealData.seller.type:', dealData.seller.type);\n      // Debug: log license numbers being sent\n      console.log('[DEAL SUBMIT] SENDING seller license number:', formData.sellerLicenseNumber);\n      console.log('[DEAL SUBMIT] SENDING buyer license number:', formData.buyerLicenseNumber);\n      // Debug: log dealData before sending\n      console.log('[DEAL SUBMIT] dealData to backend:', dealData);\n      // Force as last resort\n      dealData.currentStage = 'contract-received';\n      console.log('[DEBUG] dealData.currentStage (final):', dealData.currentStage);\n      console.log('[DEBUG] Full dealData:', dealData);\n      // Create deal (this would be your existing deal creation endpoint)\n      const dealResponse = await fetch(`/api/deals`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify(dealData),\n        credentials: 'include'\n      });\n      // Debug: log backend response status\n      console.log('[DEAL SUBMIT] Backend response status:', dealResponse.status);\n      const dealResult = await dealResponse.json().catch(() => ({}));\n      console.log('[DEAL SUBMIT] Backend response JSON:', dealResult);\n      if (!dealResponse.ok) {\n        console.log('[DEAL SUBMIT] Backend error response:', dealResult);\n        throw new Error('Failed to create deal');\n      }\n\n      const dealId = dealResult.deal._id;\n\n      // Debug: Log what we're sending for document generation\n      console.log('[DEAL SUBMIT] 🚀 Sending document generation request with:');\n      console.log('[DEAL SUBMIT] 🚀 - dealType2SubType from formData:', formData.dealType2SubType);\n      console.log('[DEAL SUBMIT] 🚀 - dealType2 from formData:', formData.dealType2SubType);\n\n      // Generate document and create vehicle record\n      const documentResponse = await fetch(`/api/documents/generate/${dealId}`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify({\n          dealType2: formData.dealType2SubType,\n          dealType2SubType: formData.dealType2SubType, // Explicitly send dealType2SubType\n          commissionRate: parseFloat(formData.commissionRate) || 0,\n          stockNumber: formData.rpStockNumber,\n          wholesalePrice: parseFloat(formData.wholesalePrice) || 0,\n          generalNotes: formData.generalNotes,\n          vehicleDescription: formData.vehicleDescription,\n          buyerName: formData.buyerName,\n          buyerType: formData.buyerType,\n          buyerAddress: formData.buyerAddress,\n          buyerPhone: formData.buyerPhone,\n          buyerEmail: formData.buyerEmail,\n          buyerLicenseNumber: formData.buyerLicenseNumber,\n          buyerTier: formData.buyerTier,\n          sellerType: formData.sellerType\n        }),\n        credentials: 'include' // Ensure cookies/session are sent for authentication\n      });\n\n      if (!documentResponse.ok) {\n        const err = await documentResponse.json().catch(() => ({}));\n        throw new Error(err.error || 'Failed to generate document');\n      }\n\n      const documentResult = await documentResponse.json();\n      \n      // --- UPLOAD USER DOCUMENTS ---\n      if (formData.documents && formData.documents.length > 0) {\n        for (let i = 0; i < formData.documents.length; i++) {\n          const file = formData.documents[i];\n          const noteObj = documentNotes.find(sel => sel.fileIndex === i);\n          const note = noteObj ? noteObj.note : '';\n          const documentType = 'extra_doc';\n          const form = new FormData();\n          form.append('document', file);\n          if (note) form.append('notes', note);\n          try {\n            const uploadRes = await fetch(`/api/backoffice/deals/${dealId}/documents/${documentType}/upload`, {\n              method: 'POST',\n              headers: {\n                'Authorization': getAuthHeaders()['Authorization']\n              },\n              body: form,\n              credentials: 'include'\n            });\n            if (!uploadRes.ok) {\n              const err = await uploadRes.json().catch(() => ({}));\n              toast.error(`Failed to upload ${file.name}: ${err.error || uploadRes.statusText}`);\n            } else {\n              toast.success(`Uploaded ${file.name}`);\n            }\n          } catch (err) {\n            toast.error(`Error uploading ${file.name}: ${err.message}`);\n          }\n        }\n      }\n      // --- END UPLOAD USER DOCUMENTS ---\n      \n      console.log('Deal created and document generated:', documentResult);\n      \n      // Show success message with document info\n      const successMessage = isDraft \n        ? 'Draft saved successfully!' \n        : `Deal submitted successfully!\\n\\nYour deal has been sent to the back office for processing. You will be notified when the deal is complete.`;\n      \n      toast.success(successMessage);\n      \n      // Optionally redirect to a success page or clear form\n      if (!isDraft) {\n        // Clear form or redirect\n        setFormData({\n          vin: '',\n          year: '',\n          make: '',\n          model: '',\n          mileage: '',\n          exteriorColor: '',\n          interiorColor: '',\n          dealType: '',\n          dealType2SubType: '',\n          fundingSource: '',\n          purchaseDate: todayStr,\n          paymentMethod: 'check',\n          currentStage: 'contract-received',\n          purchasePrice: '',\n          listPrice: '',\n          killPrice: '',\n          wholesalePrice: '',\n          commissionRate: '',\n          brokerageFee: '',\n          brokerageFeePaidTo: '',\n          payoffBalance: '',\n          amountDueToCustomer: '',\n          amountDueToRP: '',\n          sellerName: '',\n          sellerAddress: '',\n          sellerPhone: '',\n          sellerEmail: '',\n          sellerLicenseNumber: '',\n          sellerTier: 'Tier 1',\n          buyerName: '',\n          buyerAddress: '',\n          buyerPhone: '',\n          buyerEmail: '',\n          buyerLicenseNumber: '',\n          buyerTier: 'Tier 1',\n          buyerType: 'dealer',\n          sellerType: 'private',\n          rpStockNumber: '',\n          vehicleDescription: '',\n          generalNotes: '',\n          contractRequired: false,\n          titlePresent: false,\n          driverLicensePresent: false,\n          odometerPresent: false,\n          dealerLicensePresent: false,\n          documents: [],\n          salesperson: ''\n        });\n        setCurrentStep(1);\n      }\n      \n    } catch (error) {\n      if (error.message.includes('401') || error.message.includes('not authorized')) {\n        alert('Session expired or not authorized. Please log in again.');\n        navigate('/login');\n      } else {\n        alert(`Error saving deal: ${error.message}`);\n        console.log('[DEAL SUBMIT] Error:', error);\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleEmailToListingTeam = () => {\n    const emailBody = `New Vehicle Ready for Listing\n\nVehicle: ${formData.year} ${formData.make} ${formData.model}\nVIN: ${formData.vin}\nStock #: ${formData.rpStockNumber}\nMileage: ${formData.mileage}\nExterior: ${formData.exteriorColor}\nInterior: ${formData.interiorColor}\n\nDescription:\n${formData.vehicleDescription}\n\nPlease prepare listing materials for this vehicle.\n\nBest regards,\n${currentUser.name}`;\n\n    const mailtoLink = `mailto:listing@rpexotics.com?subject=New Vehicle for Listing - ${formData.year} ${formData.make} ${formData.model}&body=${encodeURIComponent(emailBody)}`;\n    window.open(mailtoLink);\n  };\n\n  // Remove handleCompleteDeal and use handleSave for final submission\n  // Update button text and alerts\n\n  const renderStepIndicator = () => (\n    <div className=\"mb-8\">\n      <div className=\"flex items-center justify-between\">\n        {Array.from({ length: totalSteps }, (_, index) => {\n          const stepNumber = index + 1;\n          const isActive = currentStep === stepNumber;\n          const isCompleted = currentStep > stepNumber;\n          \n          let stepTitle = '';\n          let stepDescription = '';\n          \n          if (stepNumber === 1) {\n            stepTitle = 'Vehicle & Deal Type';\n            stepDescription = 'Enter vehicle information and select deal type';\n          } else if (stepNumber === 2) {\n            stepTitle = 'Deal Configuration';\n            stepDescription = 'Configure funding, payment, and timeline';\n          } else if (stepNumber === 3 && dealTypeFields.showFinancials) {\n            stepTitle = 'Financial Information';\n            stepDescription = 'Set pricing and financial terms';\n          } else if ((stepNumber === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo) || \n                     (stepNumber === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo)) {\n            stepTitle = 'Seller Information';\n            stepDescription = 'Add seller contact information';\n          } else if ((stepNumber === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation) ||\n                     (stepNumber === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation) ||\n                     (stepNumber === 5 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation)) {\n            stepTitle = 'Documentation & Notes';\n            stepDescription = 'Document status and additional notes';\n          }\n          \n          return (\n            <div key={stepNumber} className=\"flex items-center\">\n              <div className={`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors ${\n                isActive \n                  ? 'bg-blue-600 border-blue-600 text-white' \n                  : isCompleted \n                    ? 'bg-green-600 border-green-600 text-white' \n                    : 'bg-white/10 border-white/20 text-gray-400'\n              }`}>\n                {isCompleted ? (\n                  <CheckCircle className=\"h-5 w-5\" />\n                ) : (\n                  <span className=\"text-sm font-medium\">{stepNumber}</span>\n                )}\n              </div>\n              <div className=\"ml-3\">\n                <p className={`text-sm font-medium ${isActive ? 'text-white' : 'text-gray-400'}`}>\n                  {stepTitle}\n                </p>\n                <p className=\"text-xs text-gray-500\">{stepDescription}</p>\n              </div>\n              {stepNumber < totalSteps && (\n                <div className={`w-16 h-0.5 mx-4 ${isCompleted ? 'bg-green-600' : 'bg-white/20'}`} />\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  const renderFormField = (label, field, type = 'text', options = null, required = false, icon = null, isDealerBuyer = false) => {\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"flex items-center text-sm font-medium text-gray-300\">\n          {icon && React.createElement(icon, { className: \"h-4 w-4 mr-2\" })}\n          {label}\n          {required && <span className=\"text-red-400 ml-1\">*</span>}\n        </label>\n        \n        {type === 'select' ? (\n          <select\n            value={formData[field]}\n            onChange={(e) => handleInputChange(field, e.target.value)}\n            className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${\n              formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n            }`}\n          >\n            <option value=\"\">Select {label}</option>\n            {options?.map(option => (\n              <option key={option.value} value={option.value} className=\"bg-gray-800\">\n                {option.label}\n              </option>\n            ))}\n          </select>\n        ) : type === 'textarea' ? (\n          <textarea\n            value={formData[field]}\n            onChange={(e) => handleInputChange(field, e.target.value)}\n            rows={4}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n            className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-none ${\n              formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n            }`}\n          />\n        ) : type === 'checkbox' ? (\n          <label className=\"flex items-center space-x-2 cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={!!formData[field]}\n              onChange={(e) => handleInputChange(field, e.target.checked)}\n              className=\"rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500\"\n            />\n            <span className=\"text-gray-300\">{label}</span>\n          </label>\n        ) : (\n          <div className=\"relative\">\n            {['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) && (\n              <div className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm\">$</div>\n            )}\n            <input\n              type={type}\n              value={formData[field] || ''}\n              onChange={(e) => {\n                handleInputChange(field, e.target.value);\n              }}\n              placeholder={`Enter ${label.toLowerCase()}...`}\n              className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${\n                formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n              } ${field === 'vin' ? 'pr-20' : ''} ${['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) ? 'pl-8' : ''}`}\n            />\n            \n            {field === 'vin' && formData.vin.length === 17 && (\n              <div className=\"absolute right-2 top-1/2 transform -translate-y-1/2\">\n                {vinDecoding ? (\n                  <Loader2 className=\"h-5 w-5 text-blue-400 animate-spin\" />\n                ) : vinDecoded ? (\n                  <CheckCircle className=\"h-5 w-5 text-green-400\" />\n                ) : (\n                  <button\n                    onClick={() => decodeVIN(formData.vin)}\n                    className=\"bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded transition-colors\"\n                  >\n                    Decode\n                  </button>\n                )}\n              </div>\n            )}\n            \n            {/* Dealer Buyer Autocomplete */}\n            {isDealerBuyer && field === 'dealerName' && dealerBuyerSuggestions.length > 0 && (\n              <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\">\n                {dealerBuyerSuggestions.map(dealer => (\n                  <div\n                    key={dealer.id}\n                    className=\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\"\n                    onClick={() => {\n                      setFormData(prev => ({\n                        ...prev,\n                        dealerName: dealer.name,\n                        dealerCompany: dealer.company,\n                        dealerPhone: dealer.phone,\n                        dealerEmail: dealer.contact?.email || dealer.email || '',\n                        dealerAddress: dealer.location || dealer.address || ''\n                      }));\n                      setDealerBuyerSuggestions([]);\n                    }}\n                  >\n                    <div className=\"font-medium text-white\">{dealer.name}</div>\n                    <div className=\"text-sm text-gray-400\">{dealer.company} • {dealer.location}</div>\n                  </div>\n                ))}\n              </div>\n            )}\n            \n            {/* Buyer Name Autocomplete for buy/sell deals */}\n            {field === 'buyerName' && formData.buyerType === 'dealer' && dealerBuyerSuggestions.length > 0 && (\n              <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\">\n                {dealerBuyerSuggestions.map(dealer => (\n                  <div\n                    key={dealer.id}\n                    className=\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\"\n                    onClick={() => {\n                      handleBuyerDealerSuggestionSelect(dealer);\n                    }}\n                  >\n                    <div className=\"font-medium text-white\">{dealer.name}</div>\n                    <div className=\"text-sm text-gray-400\">{dealer.company} • {dealer.location}</div>\n                  </div>\n                ))}\n              </div>\n            )}\n            \n            {/* Seller Autocomplete (only for non-retail deals and when seller type is dealer for buy/sell) */}\n            {field === 'sellerName' && dealerSuggestions.length > 0 && (\n              (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell' && formData.sellerType === 'dealer') ||\n              (!['retail-pp','retail-auction','retail-dtod'].includes(formData.dealType) && \n               !(formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell'))\n            ) && (\n              <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\">\n                {dealerSuggestions.map(dealer => (\n                  <div\n                    key={dealer.id}\n                    className=\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\"\n                    onClick={() => {\n                      handleDealerSuggestionSelect(dealer);\n                    }}\n                  >\n                    <div className=\"font-medium text-white\">{dealer.name}</div>\n                    <div className=\"text-sm text-gray-400\">{dealer.company} • {dealer.location}</div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n        \n        {formErrors[field] && (\n          <div className=\"flex items-center text-red-400 text-sm\">\n            <AlertCircle className=\"h-4 w-4 mr-1\" />\n            {formErrors[field]}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderStep = () => {\n    switch (currentStep) {\n      case 1:\n        return (\n          <div className=\"space-y-6\">\n            {/* Deal Type Selection */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Deal Type Selection</h3>\n              {renderFormField('Deal Type', 'dealType', 'select', dealTypes, true, Car)}\n              <div className=\"mt-4\">\n                {renderFormField('Deal Type 2', 'dealType2SubType', 'select', dealType2SubOptions, true)}\n              </div>\n            </div>\n            {/* Vehicle Information */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Vehicle Information</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"md:col-span-2\">\n                  {renderFormField('VIN', 'vin', 'text', null, true, Hash)}\n                </div>\n                {renderFormField('Year', 'year', 'number', null, true, Calendar)}\n                {renderFormField('Make', 'make', 'text', null, true)}\n                {renderFormField('Model', 'model', 'text', null, true)}\n                {renderFormField('Mileage', 'mileage', 'number', null, false, Gauge)}\n                {renderFormField('Exterior Color', 'exteriorColor', 'text', null, false, Palette)}\n                {renderFormField('Interior Color', 'interiorColor', 'text', null, false, Palette)}\n                {/* Stock Number field removed for all deal types */}\n              </div>\n            </div>\n          </div>\n        );\n      \n      case 2:\n        return (\n          <div className=\"space-y-6\">\n            {/* Deal Configuration */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Deal Configuration</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {renderFormField('Funding Source', 'fundingSource', 'select', fundingSources, true, DollarSign)}\n                {renderFormField('Purchase/Sale Date', 'purchaseDate', 'date', null, true, Calendar)}\n                {renderFormField('Payment Method', 'paymentMethod', 'select', paymentMethods, true)}\n                {renderFormField('RP Stock Number', 'rpStockNumber', 'text', null, false, Hash)}\n                {renderFormField('Salesperson', 'salesperson', 'select', salespersonOptions, true, User)}\n              </div>\n            </div>\n          </div>\n        );\n      case 3:\n        return dealTypeFields.showFinancials ? (\n          <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n            <h3 className=\"text-lg font-medium text-white mb-4\">Financial Information</h3>\n            {formData.dealType2SubType === 'sale' ? (\n              <div className=\"space-y-6\">\n                {renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign)}\n                {renderFormField('Brokerage Fee', 'brokerageFee', 'number')}\n                {renderFormField('Brokerage Fee Paid To', 'brokerageFeePaidTo', 'text')}\n                {renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number')}\n                {renderFormField('Amount Due to RP', 'amountDueToRP', 'number')}\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {/* Left column */}\n                <div className=\"space-y-6\">\n                  {renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign)}\n                  {renderFormField('Kill Price', 'killPrice', 'number')}\n                  {renderFormField('Wholesale Price', 'wholesalePrice', 'number')}\n                  {renderFormField('List Price', 'listPrice', 'number')}\n                  {/* Only show Commission Rate for consign deals, otherwise keep layout clean */}\n                  {['consign-a','consign-b','consign-c','consign-rdnc'].includes(formData.dealType2SubType)\n                    ? renderFormField('Commission Rate (%)', 'commissionRate', 'number')\n                    : null}\n                </div>\n                {/* Right column */}\n                <div className=\"space-y-6\">\n                  {renderFormField('Brokerage Fee', 'brokerageFee', 'number')}\n                  {renderFormField('Brokerage Fee Paid To', 'brokerageFeePaidTo', 'text')}\n                  {renderFormField('Payoff Balance', 'payoffBalance', 'number')}\n                  {renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number')}\n                  {renderFormField('Amount Due to RP', 'amountDueToRP', 'number')}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <DollarSign className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-white mb-2\">Financial Information Not Required</h3>\n            <p className=\"text-gray-400\">This deal type does not require financial information.</p>\n          </div>\n        );\n      \n      case 4:\n        // Seller/Dealer Info step\n        if (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') {\n          return (\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10 space-y-10\">\n              {/* Buyer Section */}\n              <div>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-medium text-white\">Buyer Information</h3>\n                  <div className=\"flex space-x-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => handleInputChange('buyerType', 'private')}\n                      className={`px-3 py-1 rounded-lg border transition-colors text-sm ${\n                        formData.buyerType === 'private'\n                          ? 'bg-blue-600 border-blue-500 text-white'\n                          : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                      }`}\n                    >\n                      Private Party\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleInputChange('buyerType', 'dealer')}\n                      className={`px-3 py-1 rounded-lg border transition-colors text-sm ${\n                        formData.buyerType === 'dealer'\n                          ? 'bg-green-600 border-green-500 text-white'\n                          : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                      }`}\n                    >\n                      Dealer\n                    </button>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {renderFormField(formData.buyerType === 'dealer' ? 'Dealer Name' : 'Buyer Name', 'buyerName', 'text', null, true, User)}\n                  {renderFormField('Phone', 'buyerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Email', 'buyerEmail', 'email', null, false, Mail)}\n                  {renderFormField('Address', 'buyerAddress', 'text', null, false, MapPin)}\n                  {formData.buyerType === 'dealer' && renderFormField('Dealer License Number', 'buyerLicenseNumber', 'text')}\n                  {formData.buyerType === 'dealer' && !(formData.dealType === 'wholesale-d2d' && formData.dealType2SubType === 'buy') && renderFormField('Dealer Tier', 'buyerTier', 'select', [\n                    { value: 'Tier 1', label: 'Tier 1: Pay Upon Title' },\n                    { value: 'Tier 2', label: 'Tier 2: Pay Prior to Release' }\n                  ])}\n                </div>\n              </div>\n              \n              {/* Seller Section */}\n              <div>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-medium text-white\">Seller Information</h3>\n                  <div className=\"flex space-x-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => handleInputChange('sellerType', 'private')}\n                      className={`px-3 py-1 rounded-lg border transition-colors text-sm ${\n                        formData.sellerType === 'private'\n                          ? 'bg-blue-600 border-blue-500 text-white'\n                          : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                      }`}\n                    >\n                      Private Party\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleInputChange('sellerType', 'dealer')}\n                      className={`px-3 py-1 rounded-lg border transition-colors text-sm ${\n                        formData.sellerType === 'dealer'\n                          ? 'bg-green-600 border-green-500 text-white'\n                          : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                      }`}\n                    >\n                      Dealer\n                    </button>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {renderFormField(formData.sellerType === 'dealer' ? 'Dealer Name' : 'Seller Name', 'sellerName', 'text', null, true, User)}\n                  {renderFormField('Phone', 'sellerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Email', 'sellerEmail', 'email', null, false, Mail)}\n                  {renderFormField('Address', 'sellerAddress', 'text', null, false, MapPin)}\n                  {formData.sellerType === 'dealer' && renderFormField('Dealer License Number', 'sellerLicenseNumber', 'text')}\n                  {formData.sellerType === 'dealer' && !(formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') && !(formData.dealType === 'wholesale-d2d' && formData.dealType2SubType === 'buy') && renderFormField('Dealer Tier', 'sellerTier', 'select', [\n                    { value: 'Tier 1', label: 'Tier 1: Pay Upon Title' },\n                    { value: 'Tier 2', label: 'Tier 2: Pay Prior to Release' }\n                  ])}\n                </div>\n              </div>\n            </div>\n          );\n        } else {\n          const isRetailPP = formData.dealType === 'retail-pp';\n          return (\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">{dynamicLabels.sellerSectionTitle}</h3>\n              {isRetailPP ? (\n                // Retail PP - 2x2 grid layout\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"md:col-span-2\">\n                    {renderFormField(dynamicLabels.sellerLabel, 'sellerName', 'text', null, true, User)}\n                  </div>\n                  {renderFormField('Phone', 'sellerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Email', 'sellerEmail', 'email', null, false, Mail)}\n                  {renderFormField('Address', 'sellerAddress', 'text', null, false, MapPin)}\n                </div>\n              ) : (\n                // Other deal types - original layout\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"md:col-span-2\">\n                    {renderFormField(dynamicLabels.sellerLabel, 'sellerName', 'text', null, true, User)}\n                  </div>\n                  {!isRetailPP && renderFormField(dynamicLabels.companyLabel, 'sellerCompany', 'text')}\n                  {renderFormField('Phone', 'sellerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Email', 'sellerEmail', 'email', null, false, Mail)}\n                  {renderFormField(dynamicLabels.addressLabel, 'sellerAddress', 'text', null, false, MapPin)}\n                  \n                  {/* Show license number and tier only for wholesale d2d deals (but not for buy deals) */}\n                  {formData.dealType === 'wholesale-d2d' && formData.dealType2SubType !== 'buy' && (\n                    <>\n                      <div>\n                        <label htmlFor=\"seller-license-number\" className=\"block text-sm font-medium text-gray-300 mb-1\">Dealer License Number</label>\n                        <input\n                          type=\"text\"\n                          id=\"seller-license-number\"\n                          value={formData.sellerLicenseNumber || ''}\n                          onChange={e => handleInputChange('sellerLicenseNumber', e.target.value)}\n                          className=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                        />\n                      </div>\n                      \n                      {/* Tier Selection */}\n                      <div className=\"md:col-span-2\">\n                        <label className=\"block text-sm font-medium text-white mb-2\">\n                          Dealer Tier\n                        </label>\n                        <div className=\"flex space-x-4\">\n                          <button\n                            type=\"button\"\n                            onClick={() => handleInputChange('sellerTier', 'Tier 1')}\n                            className={`px-4 py-2 rounded-lg border transition-colors ${\n                              formData.sellerTier === 'Tier 1'\n                                ? 'bg-red-600 border-red-500 text-white'\n                                : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                            }`}\n                          >\n                            Tier 1 - Pay Upon Title\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => handleInputChange('sellerTier', 'Tier 2')}\n                            className={`px-4 py-2 rounded-lg border transition-colors ${\n                              formData.sellerTier === 'Tier 2'\n                                ? 'bg-green-600 border-green-500 text-white'\n                                : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                            }`}\n                          >\n                            Tier 2 - Pay Prior to Release\n                          </button>\n                        </div>\n                        <p className=\"text-xs text-gray-400 mt-1\">\n                          Tier 1: Pay Upon Title. Tier 2: Pay Prior to Release.\n                        </p>\n                      </div>\n                    </>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        }\n      \n      case 5:\n        return dealTypeFields.showDocumentation ? (\n          <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n            <h3 className=\"text-lg font-medium text-white mb-4\">Documentation & Notes</h3>\n            <div className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-4\">\n                  <h4 className=\"text-md font-medium text-white mb-4\">Documentation Status</h4>\n                  {renderFormField('Contract Required', 'contractRequired', 'checkbox')}\n                  {renderFormField('Title Present', 'titlePresent', 'checkbox')}\n                  {renderFormField('Driver License Present', 'driverLicensePresent', 'checkbox')}\n                  {renderFormField('Odometer Present', 'odometerPresent', 'checkbox')}\n                  {renderFormField('Dealer License Present', 'dealerLicensePresent', 'checkbox')}\n                </div>\n                <div className=\"space-y-4\">\n                  {renderFormField('Vehicle Description', 'vehicleDescription', 'textarea', null, false, Info)}\n                  {/* File upload area */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-white mb-2\">Upload Documents/Photos</label>\n                    <input\n                      type=\"file\"\n                      multiple\n                      accept=\"image/*,application/pdf\"\n                      onChange={handleDocumentUpload}\n                      className=\"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700\"\n                    />\n                    {/* Preview uploaded files */}\n                    {formData.documents && formData.documents.length > 0 && (\n                      <div className=\"mt-3 space-y-2\">\n                        {formData.documents.map((file, i) => (\n                          <div key={i} className=\"flex items-center space-x-3 bg-white/10 rounded p-2\">\n                            {file.type && file.type.startsWith('image') ? (\n                              <img src={URL.createObjectURL(file)} alt={file.name} className=\"h-12 w-12 object-cover rounded\" />\n                            ) : (\n                              <span className=\"inline-block w-12 h-12 bg-gray-700 text-white flex items-center justify-center rounded\">PDF</span>\n                            )}\n                            <span className=\"text-white text-sm truncate max-w-xs\">{file.name}</span>\n                            <input\n                              type=\"text\"\n                              value={documentNotes.find(sel => sel.fileIndex === i)?.note || ''}\n                              onChange={e => handleDocumentNoteChange(i, e.target.value)}\n                              placeholder=\"Add a note (optional)\"\n                              className=\"bg-white/10 border rounded-lg px-2 py-1 text-white text-sm\"\n                            />\n                            <button\n                              type=\"button\"\n                              className=\"ml-auto text-red-400 hover:text-red-600 text-xs font-medium\"\n                              onClick={() => handleRemoveDocument(i)}\n                            >\n                              Remove\n                            </button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n              <div>\n                {renderFormField('General Notes', 'generalNotes', 'textarea', null, false, Info)}\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <Info className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-white mb-2\">Documentation Not Required</h3>\n            <p className=\"text-gray-400\">This deal type does not require documentation tracking.</p>\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  // Calculate total steps based on deal type\n  const getTotalSteps = () => {\n    let steps = 2; // Always have vehicle info and deal config\n    if (dealTypeFields.showFinancials) steps++;\n    if (dealTypeFields.showSellerInfo) steps++;\n    if (dealTypeFields.showDocumentation) steps++;\n    return steps;\n  };\n\n  const totalSteps = getTotalSteps();\n\n  // Add a constant for the unified status options\n  const STATUS_OPTIONS = [\n    { value: 'contract-received', label: 'Contract Received' },\n    { value: 'title-processing', label: 'Title Processing' },\n    { value: 'payment-approved', label: 'Payment Approved' },\n    { value: 'funds-disbursed', label: 'Funds Disbursed' },\n    { value: 'title-received', label: 'Title Received' },\n    { value: 'deal-complete', label: 'Deal Complete' }\n  ];\n\n  const statusCompatMap = {\n    'initial-contact': 'contract-received',\n    'documentation': 'title-processing',\n    'finance': 'payment-approved',\n    'completion': 'deal-complete'\n  };\n\n  // At the top, define the valid backend status values:\n  const VALID_STATUSES = [\n    'contract-received',\n    'title-processing',\n    'payment-approved',\n    'funds-disbursed',\n    'title-received',\n    'deal-complete'\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black\">\n      {/* Animated Background */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/5 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n      </div>\n\n      {/* Header */}\n      <header className=\"relative bg-black/20 backdrop-blur-md border-b border-white/10\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <button \n                onClick={() => window.history.back()}\n                className=\"mr-4 p-2 bg-white/10 hover:bg-white/20 rounded-lg border border-white/20 transition-colors\"\n              >\n                <ArrowLeft className=\"h-5 w-5 text-white\" />\n              </button>\n              <div className=\"flex items-center\">\n                <div className=\"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl p-3 mr-4 shadow-lg shadow-blue-500/25\">\n                  <Plus className=\"h-6 w-6 text-white\" />\n                </div>\n                <div>\n                  <h1 className=\"text-xl font-bold text-white\">New Deal Entry</h1>\n                  <p className=\"text-gray-300 text-sm\">Create a new vehicle deal</p>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"flex items-center space-x-3\">\n              <button\n                onClick={() => handleSave(true)}\n                disabled={saving}\n                className=\"flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/20 transition-colors disabled:opacity-50\"\n              >\n                {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <Save className=\"h-4 w-4 mr-2\" />}\n                Save Draft\n              </button>\n              \n              <button\n                onClick={() => handleSave(false)}\n                disabled={saving}\n                className=\"flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50\"\n              >\n                {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <CheckCircle className=\"h-4 w-4 mr-2\" />}\n                Create Deal\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"relative max-w-6xl mx-auto px-6 py-8\">\n        {/* Step Indicator */}\n        {renderStepIndicator()}\n\n        {/* Form Content */}\n        <div className=\"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 p-8\">\n          <div className=\"mb-6\">\n            <h2 className=\"text-2xl font-bold text-white mb-2\">\n              {currentStep === 1 && 'Vehicle Information & Deal Type'}\n              {currentStep === 2 && 'Deal Configuration'}\n              {currentStep === 3 && dealTypeFields.showFinancials && 'Financial Information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes'}\n              {currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information'}\n              {currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes'}\n              {currentStep === 5 && 'Documentation & Notes'}\n            </h2>\n            <p className=\"text-gray-300\">\n              {currentStep === 1 && 'Enter basic vehicle information and select the deal type'}\n              {currentStep === 2 && 'Configure deal type, funding, and timeline'}\n              {currentStep === 3 && dealTypeFields.showFinancials && 'Set pricing and financial terms'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes'}\n              {currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information'}\n              {currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes'}\n              {currentStep === 5 && 'Document status and additional notes'}\n            </p>\n          </div>\n\n          {renderStep()}\n\n          {/* Navigation Buttons */}\n          <div className=\"flex items-center justify-between mt-8 pt-6 border-t border-white/10\">\n            <button\n              onClick={() => setCurrentStep(Math.max(1, currentStep - 1))}\n              disabled={currentStep === 1}\n              className=\"flex items-center px-4 py-2 text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Previous\n            </button>\n\n            <div className=\"flex items-center space-x-3\">\n              {currentStep === totalSteps && formData.vehicleDescription && (\n                <button\n                  onClick={handleEmailToListingTeam}\n                  className=\"flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\n                >\n                  <Send className=\"h-4 w-4 mr-2\" />\n                  Email to Listing Team\n                </button>\n              )}\n              \n              {currentStep < totalSteps ? (\n                <button\n                  onClick={() => setCurrentStep(Math.min(totalSteps, currentStep + 1))}\n                  className=\"flex items-center px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-colors\"\n                >\n                  Next\n                  <ArrowLeft className=\"h-4 w-4 ml-2 rotate-180\" />\n                </button>\n              ) : (\n                <button\n                  onClick={() => handleSave(false)}\n                  disabled={saving}\n                  className=\"flex items-center px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-lg transition-colors disabled:opacity-50\"\n                >\n                  {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <CheckCircle className=\"h-4 w-4 mr-2\" />}\n                  Submit Deal\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* VIN Decode Status */}\n        {vinDecoding && (\n          <div className=\"fixed bottom-6 right-6 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\">\n            <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n            Decoding VIN...\n          </div>\n        )}\n        \n        {vinDecoded && (\n          <div className=\"fixed bottom-6 right-6 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\">\n            <CheckCircle className=\"h-4 w-4 mr-2\" />\n            VIN decoded successfully!\n          </div>\n        )}\n      </div>\n      <ToastContainer />\n    </div>\n  );\n};\n\nexport default NewDealEntry; "],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OACEC,GAAG,CAAEC,SAAS,CAAEC,IAAI,CAAEC,IAAI,CAAEC,WAAW,CAAEC,OAAO,CAChDC,QAAQ,CAAEC,UAAU,CAAEC,IAAI,CAC1BC,MAAM,CAAEC,KAAK,CAAEC,IAAI,CAAEC,IAAI,CAAEC,OAAO,CAAEC,KAAK,CACzCC,IAAI,CAAEC,IAAI,CAAEC,WAAW,KAClB,cAAc,CACrB,OAASC,OAAO,KAAQ,eAAe,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,cAAc,CAAEC,KAAK,KAAQ,gBAAgB,CACtD,MAAO,uCAAuC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE/C,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAEC,IAAI,CAAEC,WAAW,CAAEC,cAAe,CAAC,CAAGb,OAAO,CAAC,CAAC,CACvD,KAAM,CAAAc,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAE9B;AACApB,SAAS,CAAC,IAAM,CACd,GAAI,CAAC+B,WAAW,CAAE,CAChBE,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAAE,CAACF,WAAW,CAAEE,QAAQ,CAAC,CAAC,CAE3B;AACA,KAAM,CAAAC,QAAQ,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,EAAE,CAEpD;AACA,KAAM,CAAAC,YAAY,CAAG,QAAAA,CAAA,CAAgB,IAAf,CAAAC,KAAK,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAC9B,KAAM,CAAAG,OAAO,CAAG,CACd,GAAGX,cAAc,CAAC,CAAC,CACnB,cAAc,CAAE,kBAAkB,CAClC,GAAGO,KACL,CAAC,CACD;AACA,GAAI,CAACI,OAAO,CAAC,eAAe,CAAC,CAAE,CAC7BC,OAAO,CAACC,IAAI,CAAC,kDAAkD,CAAC,CAClE,CAAC,IAAM,CACLD,OAAO,CAACE,GAAG,CAAC,2CAA2C,CAAEH,OAAO,CAAC,eAAe,CAAC,CAAC,CACpF,CACA,MAAO,CAAAA,OAAO,CAChB,CAAC,CAED,KAAM,CAAAI,QAAQ,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAE,EAAE,CAAC,CAEtD,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGrD,QAAQ,CAAC,CACvC;AACAsD,GAAG,CAAE,EAAE,CACPC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,EAAE,CACTC,OAAO,CAAE,EAAE,CACXC,aAAa,CAAE,EAAE,CACjBC,aAAa,CAAE,EAAE,CAEjB;AACAC,QAAQ,CAAE,EAAE,CACZC,gBAAgB,CAAE,EAAE,CAAE;AACtBC,aAAa,CAAE,EAAE,CACjBC,YAAY,CAAEhB,QAAQ,CACtBiB,aAAa,CAAE,OAAO,CAAE;AACxBC,YAAY,CAAE,mBAAmB,CAEjC;AACAC,aAAa,CAAE,EAAE,CACjBC,SAAS,CAAE,EAAE,CACbC,SAAS,CAAE,EAAE,CACbC,cAAc,CAAE,EAAE,CAClBC,cAAc,CAAE,EAAE,CAClBC,YAAY,CAAE,EAAE,CAChBC,kBAAkB,CAAE,EAAE,CACtBC,aAAa,CAAE,EAAE,CACjBC,mBAAmB,CAAE,EAAE,CACvBC,aAAa,CAAE,EAAE,CAEjB;AACAC,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EAAE,CACjBC,WAAW,CAAE,EAAE,CACfC,WAAW,CAAE,EAAE,CACfC,mBAAmB,CAAE,EAAE,CACvBC,UAAU,CAAE,QAAQ,CAEpB;AACAC,SAAS,CAAE,EAAE,CACbC,YAAY,CAAE,EAAE,CAChBC,UAAU,CAAE,EAAE,CACdC,UAAU,CAAE,EAAE,CACdC,kBAAkB,CAAE,EAAE,CACtBC,SAAS,CAAE,QAAQ,CAEnB;AACAC,SAAS,CAAE,QAAQ,CAAE;AACrBC,UAAU,CAAE,SAAS,CAAE;AAEvB;AACAC,aAAa,CAAE,EAAE,CACjBC,kBAAkB,CAAE,EAAE,CACtBC,YAAY,CAAE,EAAE,CAEhB;AACAC,gBAAgB,CAAE,KAAK,CACvBC,YAAY,CAAE,KAAK,CACnBC,oBAAoB,CAAE,KAAK,CAC3BC,eAAe,CAAE,KAAK,CACtBC,oBAAoB,CAAE,KAAK,CAC3BC,SAAS,CAAE,EAAE,CAAE;AACfC,WAAW,CAAE,EACf,CAAC,CAAC,CAEF,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGtG,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACuG,UAAU,CAAEC,aAAa,CAAC,CAAGxG,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACyG,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG1G,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAAC2G,sBAAsB,CAAEC,yBAAyB,CAAC,CAAG5G,QAAQ,CAAC,EAAE,CAAC,CAAE;AAC1E,KAAM,CAAC6G,YAAY,CAAEC,eAAe,CAAC,CAAG9G,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAAC+G,UAAU,CAAEC,aAAa,CAAC,CAAGhH,QAAQ,CAAC,CAAC,CAAC,CAAC,CAChD,KAAM,CAACiH,MAAM,CAAEC,SAAS,CAAC,CAAGlH,QAAQ,CAAC,KAAK,CAAC,CAC3C,KAAM,CAACmH,WAAW,CAAEC,cAAc,CAAC,CAAGpH,QAAQ,CAAC,CAAC,CAAC,CACjD;AACA;AACA,KAAM,CAACqH,aAAa,CAAEC,gBAAgB,CAAC,CAAGtH,QAAQ,CAAC,EAAE,CAAC,CAAE;AAExDC,SAAS,CAAC,IAAM,CACd;AACAsH,KAAK,CAAC,gCAAgC,CAAE,CAAEC,WAAW,CAAE,SAAU,CAAC,CAAC,CAChEC,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAACG,IAAI,EAAI,CACZ,GAAIA,IAAI,CAACC,OAAO,EAAIC,KAAK,CAACC,OAAO,CAACH,IAAI,CAACA,IAAI,CAAC,CAAE,CAC5C;AAAA,CAEJ,CAAC,CAAC,CACDI,KAAK,CAAC,IAAM,CACX;AAAA,CACD,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAC,cAAc,CAAIC,KAAK,EAAK,CAChC,GAAI,CAACA,KAAK,CAAE,MAAO,EAAE,CACrB;AACA,KAAM,CAAAC,YAAY,CAAGD,KAAK,CAACE,QAAQ,CAAC,CAAC,CAACC,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CAC5D;AACA,KAAM,CAAAC,KAAK,CAAGH,YAAY,CAACI,KAAK,CAAC,GAAG,CAAC,CACrC,GAAID,KAAK,CAAC5F,MAAM,CAAG,CAAC,CAAE,CACpB,MAAO,CAAA4F,KAAK,CAAC,CAAC,CAAC,CAAG,GAAG,CAAGA,KAAK,CAACnF,KAAK,CAAC,CAAC,CAAC,CAACqF,IAAI,CAAC,EAAE,CAAC,CACjD,CACA,MAAO,CAAAL,YAAY,CACrB,CAAC,CAED;AACA,QAAS,CAAAM,WAAWA,CAACC,OAAO,CAAE,CAC5B,GAAI,CAACA,OAAO,CAAE,MAAO,EAAE,CACvB,KAAM,CAAEC,MAAM,CAAEC,IAAI,CAAEC,KAAK,CAAEC,GAAI,CAAC,CAAGJ,OAAO,CAC5C,MAAO,CAACC,MAAM,CAAEC,IAAI,CAAEC,KAAK,CAAEC,GAAG,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC,CAC9D,CACA;AACA,QAAS,CAAAS,YAAYA,CAACC,IAAI,CAAE,CAC1B,GAAI,CAACA,IAAI,CAAE,MAAO,CAAEP,MAAM,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAE,CAAEC,KAAK,CAAE,EAAE,CAAEC,GAAG,CAAE,EAAG,CAAC,CAC9D,KAAM,CAAAR,KAAK,CAAGY,IAAI,CAACX,KAAK,CAAC,GAAG,CAAC,CAACY,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAChD,MAAO,CACLV,MAAM,CAAEL,KAAK,CAAC,CAAC,CAAC,EAAI,EAAE,CACtBM,IAAI,CAAEN,KAAK,CAAC,CAAC,CAAC,EAAI,EAAE,CACpBO,KAAK,CAAEP,KAAK,CAAC,CAAC,CAAC,EAAI,EAAE,CACrBQ,GAAG,CAAER,KAAK,CAAC,CAAC,CAAC,EAAI,EACnB,CAAC,CACH,CAGA;AACA,KAAM,CAAAgB,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,KAAM,CAAAC,SAAS,CAAGnG,QAAQ,CAACU,gBAAgB,CAC3C,KAAM,CAAA0F,UAAU,CAAGpG,QAAQ,CAACS,QAAQ,GAAK,WAAW,CAEpD,MAAO,CACL4F,kBAAkB,CAAEF,SAAS,GAAK,MAAM,CAAG,YAAY,CAAG,gBAAgB,CAC1EG,WAAW,CAAEH,SAAS,GAAK,MAAM,CAAG,SAAS,CAAG,gBAAgB,CAChEI,kBAAkB,CAAEJ,SAAS,GAAK,MAAM,CAAG,mBAAmB,CAAG,oBAAoB,CACrF;AACAK,YAAY,CAAEJ,UAAU,CAAG,yBAAyB,CAAG,gBAAgB,CACvEK,YAAY,CAAEL,UAAU,CAAG,gCAAgC,CAAG,uBAAuB,CACrFM,YAAY,CAAEN,UAAU,CAAG,SAAS,CAAG,gBACzC,CAAC,CACH,CAAC,CAED,KAAM,CAAAO,aAAa,CAAGT,gBAAgB,CAAC,CAAC,CAExC;AACA,KAAM,CAAAU,SAAS,CAAG,CAChB,CAAE9B,KAAK,CAAE,eAAe,CAAE+B,KAAK,CAAE,iBAAkB,CAAC,CACpD,CAAE/B,KAAK,CAAE,mBAAmB,CAAE+B,KAAK,CAAE,2BAA4B,CAAC,CAClE,CAAE/B,KAAK,CAAE,gBAAgB,CAAE+B,KAAK,CAAE,kBAAmB,CAAC,CACtD,CAAE/B,KAAK,CAAE,WAAW,CAAE+B,KAAK,CAAE,aAAc,CAAC,CAC5C,CAAE/B,KAAK,CAAE,gBAAgB,CAAE+B,KAAK,CAAE,kBAAmB,CAAC,CACtD,CAAE/B,KAAK,CAAE,aAAa,CAAE+B,KAAK,CAAE,eAAgB,CAAC,CAChD,CAAE/B,KAAK,CAAE,SAAS,CAAE+B,KAAK,CAAE,SAAU,CAAC,CACvC,CAED,KAAM,CAAAC,cAAc,CAAG,CACrB,CAAEhC,KAAK,CAAE,aAAa,CAAE+B,KAAK,CAAE,eAAgB,CAAC,CAChD,CAAE/B,KAAK,CAAE,gBAAgB,CAAE+B,KAAK,CAAE,kBAAmB,CAAC,CACtD,CAAE/B,KAAK,CAAE,MAAM,CAAE+B,KAAK,CAAE,MAAO,CAAC,CAChC,CAAE/B,KAAK,CAAE,eAAe,CAAE+B,KAAK,CAAE,eAAgB,CAAC,CAClD,CAAE/B,KAAK,CAAE,aAAa,CAAE+B,KAAK,CAAE,aAAc,CAAC,CAC/C,CAED,KAAM,CAAAE,cAAc,CAAG,CACrB,CAAEjC,KAAK,CAAE,OAAO,CAAE+B,KAAK,CAAE,OAAQ,CAAC,CAClC,CAAE/B,KAAK,CAAE,MAAM,CAAE+B,KAAK,CAAE,eAAgB,CAAC,CACzC,CAAE/B,KAAK,CAAE,KAAK,CAAE+B,KAAK,CAAE,KAAM,CAAC,CAC9B,CAAE/B,KAAK,CAAE,MAAM,CAAE+B,KAAK,CAAE,MAAO,CAAC,CAChC,CAAE/B,KAAK,CAAE,UAAU,CAAE+B,KAAK,CAAE,UAAW,CAAC,CACzC,CAED,KAAM,CAAAG,mBAAmB,CAAG,CAC1B,CAAElC,KAAK,CAAE,KAAK,CAAE+B,KAAK,CAAE,KAAM,CAAC,CAC9B,CAAE/B,KAAK,CAAE,MAAM,CAAE+B,KAAK,CAAE,MAAO,CAAC,CAChC,CAAE/B,KAAK,CAAE,UAAU,CAAE+B,KAAK,CAAE,UAAW,CAAC,CACxC,CAAE/B,KAAK,CAAE,WAAW,CAAE+B,KAAK,CAAE,WAAY,CAAC,CAC1C,CAAE/B,KAAK,CAAE,WAAW,CAAE+B,KAAK,CAAE,WAAY,CAAC,CAC1C,CAAE/B,KAAK,CAAE,WAAW,CAAE+B,KAAK,CAAE,WAAY,CAAC,CAC1C,CAAE/B,KAAK,CAAE,cAAc,CAAE+B,KAAK,CAAE,cAAe,CAAC,CACjD,CAED;AACA;AAEA;AACA,KAAM,CAAAI,kBAAkB,CAAG,CACzB,CAAEnC,KAAK,CAAE,WAAW,CAAE+B,KAAK,CAAE,WAAY,CAAC,CAC1C,CAAE/B,KAAK,CAAE,UAAU,CAAE+B,KAAK,CAAE,UAAW,CAAC,CACxC,CAAE/B,KAAK,CAAE,OAAO,CAAE+B,KAAK,CAAE,OAAQ,CAAC,CAClC,CAAE/B,KAAK,CAAE,UAAU,CAAE+B,KAAK,CAAE,UAAW,CAAC,CACxC,CAAE/B,KAAK,CAAE,SAAS,CAAE+B,KAAK,CAAE,SAAU,CAAC,CACtC,CAAE/B,KAAK,CAAE,OAAO,CAAE+B,KAAK,CAAE,OAAQ,CAAC,CACnC,CAED;AACA,KAAM,CAAAK,iBAAiB,CAAGA,CAAA,GAAM,CAC9B;AACA,KAAM,CAAAzG,QAAQ,CAAGT,QAAQ,CAACS,QAAQ,CAClC,MAAO,CACL0G,cAAc,CAAE,CACd,eAAe,CAAE,mBAAmB,CAAE,gBAAgB,CACtD,WAAW,CAAE,gBAAgB,CAAE,aAAa,CAAE,SAAS,CACxD,CAACC,QAAQ,CAAC3G,QAAQ,CAAC,CACpB4G,cAAc,CAAE,IAAI,CACpBC,iBAAiB,CAAE,CACjB,eAAe,CAAE,mBAAmB,CAAE,gBAAgB,CACtD,WAAW,CAAE,gBAAgB,CAAE,aAAa,CAAE,SAAS,CACxD,CAACF,QAAQ,CAAC3G,QAAQ,CAAC,CACpB8G,cAAc,CAAE,CAAC,KAAK,CAAE,UAAU,CAAE,kBAAkB,CAAE,MAAM,CAAE,MAAM,CAAE,OAAO,CAAE,YAAY,CAC/F,CAAC,CACH,CAAC,CAED,KAAM,CAAAC,cAAc,CAAGN,iBAAiB,CAAC,CAAC,CAE1C;AACA,KAAM,CAAAO,SAAS,CAAG,KAAO,CAAAvH,GAAG,EAAK,CAC/BgD,cAAc,CAAC,IAAI,CAAC,CACpB,GAAI,CACF,KAAM,CAAA1D,OAAO,CAAG,CAAE,GAAGX,cAAc,CAAC,CAAC,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAC3EY,OAAO,CAACE,GAAG,CAAC,4CAA4C,CAAEH,OAAO,CAAC,CAClE,KAAM,CAAAkI,QAAQ,CAAG,KAAM,CAAAvD,KAAK,CAAC,uBAAuB,CAAE,CACpDwD,MAAM,CAAE,MAAM,CACdnI,OAAO,CACPoI,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAE5H,GAAI,CAAC,CAAC,CAC7BkE,WAAW,CAAE,SACf,CAAC,CAAC,CACF3E,OAAO,CAACE,GAAG,CAAC,+BAA+B,CAAE+H,QAAQ,CAACK,MAAM,CAAC,CAC7D,KAAM,CAAAvD,IAAI,CAAG,KAAM,CAAAkD,QAAQ,CAACnD,IAAI,CAAC,CAAC,CAClC9E,OAAO,CAACE,GAAG,CAAC,6BAA6B,CAAE6E,IAAI,CAAC,CAChD,GAAIA,IAAI,CAACC,OAAO,EAAID,IAAI,CAACA,IAAI,CAAE,CAC7BvE,WAAW,CAAC+H,IAAI,GAAK,CACnB,GAAGA,IAAI,CACP7H,IAAI,CAAEqE,IAAI,CAACA,IAAI,CAACrE,IAAI,EAAI,EAAE,CAC1BC,IAAI,CAAEoE,IAAI,CAACA,IAAI,CAACpE,IAAI,EAAI,EAAE,CAC1BC,KAAK,CAAEmE,IAAI,CAACA,IAAI,CAACnE,KAAK,EAAI,EAC5B,CAAC,CAAC,CAAC,CACH+C,aAAa,CAAC,IAAI,CAAC,CACnB6E,UAAU,CAAC,IAAM7E,aAAa,CAAC,KAAK,CAAC,CAAE,IAAI,CAAC,CAC9C,CAAC,IAAM,CACL3D,OAAO,CAACyI,KAAK,CAAC,oBAAoB,CAAE1D,IAAI,CAAC0D,KAAK,CAAC,CAC/CC,KAAK,CAAC3D,IAAI,CAAC0D,KAAK,EAAI,2DAA2D,CAAC,CAClF,CACF,CAAE,MAAOA,KAAK,CAAE,CACdzI,OAAO,CAACyI,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC3CC,KAAK,CAAC,mEAAmE,CAAC,CAC5E,CAAC,OAAS,CACRjF,cAAc,CAAC,KAAK,CAAC,CACvB,CACF,CAAC,CAED;AACA,KAAM,CAAAkF,aAAa,CAAG,KAAO,CAAAC,KAAK,EAAK,CACrC,GAAIA,KAAK,CAAC/I,MAAM,CAAG,CAAC,CAAE,CACpBgE,oBAAoB,CAAC,EAAE,CAAC,CACxB,OACF,CACA;AACA,GAAI,CACF,KAAM,CAAAoE,QAAQ,CAAG,KAAM,CAAAvD,KAAK,CAAC,yBAAyBmE,kBAAkB,CAACD,KAAK,CAAC,EAAE,CAAE,CAAEjE,WAAW,CAAE,SAAU,CAAC,CAAC,CAC9G,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAkD,QAAQ,CAACnD,IAAI,CAAC,CAAC,CAClCjB,oBAAoB,CAACkB,IAAI,CAAC+D,OAAO,EAAI,EAAE,CAAC,CACxC9I,OAAO,CAACE,GAAG,CAAC,8BAA8B,CAAE6E,IAAI,CAAC+D,OAAO,EAAI,EAAE,CAAC,CACjE,CAAE,MAAOL,KAAK,CAAE,CACdzI,OAAO,CAACyI,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5C5E,oBAAoB,CAAC,EAAE,CAAC,CAC1B,CACF,CAAC,CAED;AACA,KAAM,CAAAkF,kBAAkB,CAAG,KAAO,CAAAH,KAAK,EAAK,CAC1C,GAAIA,KAAK,CAAC/I,MAAM,CAAG,CAAC,CAAE,CACpBkE,yBAAyB,CAAC,EAAE,CAAC,CAC7B,OACF,CACA,GAAI,CACF,KAAM,CAAAkE,QAAQ,CAAG,KAAM,CAAAvD,KAAK,CAAC,yBAAyBmE,kBAAkB,CAACD,KAAK,CAAC,EAAE,CAAE,CAAEjE,WAAW,CAAE,SAAU,CAAC,CAAC,CAC9G,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAkD,QAAQ,CAACnD,IAAI,CAAC,CAAC,CAClCf,yBAAyB,CAACgB,IAAI,CAAC+D,OAAO,EAAI,EAAE,CAAC,CAC/C,CAAE,MAAOL,KAAK,CAAE,CACdzI,OAAO,CAACyI,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5C1E,yBAAyB,CAAC,EAAE,CAAC,CAC/B,CACF,CAAC,CAED;AACA,KAAM,CAAAiF,2BAA2B,CAAIC,MAAM,EAAK,CAC9CzI,WAAW,CAAC+H,IAAI,EAAI,CAClB,KAAM,CAAAW,OAAO,CAAG,CACd,GAAGX,IAAI,CACPvG,UAAU,CAAEiH,MAAM,CAACE,IAAI,EAAI,EAAE,CAC7BlH,aAAa,CAAEgH,MAAM,CAACG,aAAa,EAAI,EAAE,CACzClH,WAAW,CAAE+G,MAAM,CAACI,KAAK,EAAI,EAAE,CAC/BlH,WAAW,CAAE8G,MAAM,CAACK,KAAK,EAAI,EAAE,CAC/BlH,mBAAmB,CAAE6G,MAAM,CAACM,aAAa,EAAI,EAAE,CAC/ClH,UAAU,CAAE4G,MAAM,CAACO,IAAI,EAAI,QAAQ,CACnC3G,UAAU,CAAE,QAAU;AACxB,CAAC,CACD7C,OAAO,CAACE,GAAG,CAAC,0DAA0D,CAAEgJ,OAAO,CAACrG,UAAU,CAAC,CAC3F,MAAO,CAAAqG,OAAO,CAChB,CAAC,CAAC,CACFrF,oBAAoB,CAAC,EAAE,CAAC,CACxBI,eAAe,CAAC,EAAE,CAAC,CACnBjE,OAAO,CAACE,GAAG,CAAC,oCAAoC,CAAE+I,MAAM,CAAC,CACzDjJ,OAAO,CAACE,GAAG,CAAC,uCAAuC,CAAE+I,MAAM,CAACG,aAAa,CAAC,CAC1EpJ,OAAO,CAACE,GAAG,CAAC,8CAA8C,CAAE+I,MAAM,CAACM,aAAa,CAAC,CACnF,CAAC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,KAAM,CAAAE,iBAAiB,CAAGA,CAACC,KAAK,CAAErE,KAAK,GAAK,CAC1C,GAAI,CAAAsE,cAAc,CAAGtE,KAAK,CAE1B;AACA,GAAI,CAAC,eAAe,CAAE,WAAW,CAAE,WAAW,CAAE,gBAAgB,CAAE,cAAc,CAAE,eAAe,CAAE,qBAAqB,CAAE,eAAe,CAAC,CAACsC,QAAQ,CAAC+B,KAAK,CAAC,CAAE,CAC1JC,cAAc,CAAGvE,cAAc,CAACC,KAAK,CAAC,CACxC,CAEA;AACA,GAAIqE,KAAK,GAAK,UAAU,CAAE,CACxBlJ,WAAW,CAAC+H,IAAI,GAAK,CACnB,GAAGA,IAAI,CACPvH,QAAQ,CAAE2I,cAAc,CACxB1I,gBAAgB,CAAE0I,cAAc,GAAK,aAAa,CAAGpB,IAAI,CAACtH,gBAAgB,CACzD0I,cAAc,GAAK,gBAAgB,CAAG,UAAU,CAAG,EACtE,CAAC,CAAC,CAAC,CACH,GAAIrF,WAAW,CAAG,CAAC,CAAEC,cAAc,CAAC,CAAC,CAAC,CACtC,OACF,CAEA/D,WAAW,CAAC+H,IAAI,GAAK,CAAE,GAAGA,IAAI,CAAE,CAACmB,KAAK,EAAGC,cAAe,CAAC,CAAC,CAAC,CAE3D;AACA,GAAIzF,UAAU,CAACwF,KAAK,CAAC,CAAE,CACrBvF,aAAa,CAACoE,IAAI,GAAK,CAAE,GAAGA,IAAI,CAAE,CAACmB,KAAK,EAAG,IAAK,CAAC,CAAC,CAAC,CACrD,CAEA;AACA,GAAIA,KAAK,GAAK,KAAK,EAAIC,cAAc,CAAC9J,MAAM,GAAK,EAAE,EAAI,CAAC6D,UAAU,CAAE,CAClEsE,SAAS,CAAC2B,cAAc,CAAC,CAC3B,CAEA;AACA,GAAID,KAAK,GAAK,YAAY,CAAE,CAC1B,GAAInJ,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,CAAE,CACtF;AACA,GAAIV,QAAQ,CAACsC,UAAU,GAAK,QAAQ,CAAE,CACpC8F,aAAa,CAACgB,cAAc,CAAC,CAC/B,CAAC,IAAM,CACL9F,oBAAoB,CAAC,EAAE,CAAC,CAAE;AAC5B,CACF,CAAC,IAAM,CACL;AACA8E,aAAa,CAACgB,cAAc,CAAC,CAC/B,CACF,CAEA;AACA,GAAID,KAAK,GAAK,WAAW,CAAE,CACzB,GAAInJ,QAAQ,CAACqC,SAAS,GAAK,QAAQ,CAAE,CACnCmG,kBAAkB,CAACY,cAAc,CAAC,CACpC,CAAC,IAAM,CACL5F,yBAAyB,CAAC,EAAE,CAAC,CAAE;AACjC,CACF,CAEA;AACA,GAAI2F,KAAK,GAAK,YAAY,EAAIA,KAAK,GAAK,WAAW,CAAE,CACnD,GAAIA,KAAK,GAAK,YAAY,EAAIC,cAAc,GAAK,SAAS,CAAE,CAC1D9F,oBAAoB,CAAC,EAAE,CAAC,CAC1B,CACA,GAAI6F,KAAK,GAAK,WAAW,EAAIC,cAAc,GAAK,SAAS,CAAE,CACzD5F,yBAAyB,CAAC,EAAE,CAAC,CAC/B,CACF,CAEA;AACA,GAAI2F,KAAK,GAAK,UAAU,EAAIpF,WAAW,CAAG,CAAC,CAAE,CAC3CC,cAAc,CAAC,CAAC,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAqF,oBAAoB,CAAIC,CAAC,EAAK,CAClC,KAAM,CAAAC,KAAK,CAAG7E,KAAK,CAAC8E,IAAI,CAACF,CAAC,CAACG,MAAM,CAACF,KAAK,CAAC,CACxCtJ,WAAW,CAAC+H,IAAI,GAAK,CACnB,GAAGA,IAAI,CACPjF,SAAS,CAAE,CAAC,IAAIiF,IAAI,CAACjF,SAAS,EAAI,EAAE,CAAC,CAAE,GAAGwG,KAAK,CACjD,CAAC,CAAC,CAAC,CACHrF,gBAAgB,CAAC8D,IAAI,EAAK,CACxB,GAAGA,IAAI,CACP,GAAGuB,KAAK,CAACxD,GAAG,CAAC,CAAC2D,CAAC,CAAEC,CAAC,IAAM,CAAEC,SAAS,CAAG5B,IAAI,CAAC1I,MAAM,CAAGqK,CAAE,CAAEE,IAAI,CAAE,EAAG,CAAC,CAAC,CAAC,CACpE,CAAC,CACL,CAAC,CACD,KAAM,CAAAC,oBAAoB,CAAIC,KAAK,EAAK,CACtC9J,WAAW,CAAC+H,IAAI,GAAK,CACnB,GAAGA,IAAI,CACPjF,SAAS,CAAEiF,IAAI,CAACjF,SAAS,CAAC4C,MAAM,CAAC,CAAC+D,CAAC,CAAEC,CAAC,GAAKA,CAAC,GAAKI,KAAK,CACxD,CAAC,CAAC,CAAC,CACH7F,gBAAgB,CAAC8D,IAAI,EAAIA,IAAI,CAACrC,MAAM,CAACqE,GAAG,EAAIA,GAAG,CAACJ,SAAS,GAAKG,KAAK,CAAC,CAAChE,GAAG,CAACiE,GAAG,GAAK,CAAE,GAAGA,GAAG,CAAEJ,SAAS,CAAEI,GAAG,CAACJ,SAAS,CAAGG,KAAK,CAAGC,GAAG,CAACJ,SAAS,CAAG,CAAC,CAAGI,GAAG,CAACJ,SAAU,CAAC,CAAC,CAAC,CAAC,CACtK,CAAC,CACD,KAAM,CAAAK,wBAAwB,CAAGA,CAACL,SAAS,CAAEC,IAAI,GAAK,CACpD3F,gBAAgB,CAAC8D,IAAI,EAAI,CACvB,KAAM,CAAAkC,KAAK,CAAGlC,IAAI,CAACmC,IAAI,CAACH,GAAG,EAAIA,GAAG,CAACJ,SAAS,GAAKA,SAAS,CAAC,CAC3D,GAAIM,KAAK,CAAE,CACT,MAAO,CAAAlC,IAAI,CAACjC,GAAG,CAACiE,GAAG,EAAIA,GAAG,CAACJ,SAAS,GAAKA,SAAS,CAAG,CAAE,GAAGI,GAAG,CAAEH,IAAK,CAAC,CAAGG,GAAG,CAAC,CAC9E,CAAC,IAAM,CACL,MAAO,CAAC,GAAGhC,IAAI,CAAE,CAAE4B,SAAS,CAAEC,IAAK,CAAC,CAAC,CACvC,CACF,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAO,4BAA4B,CAAI1B,MAAM,EAAK,CAC/CzI,WAAW,CAAC+H,IAAI,EAAI,CAClB,KAAM,CAAAW,OAAO,CAAG,CACd,GAAGX,IAAI,CACPvG,UAAU,CAAEiH,MAAM,CAACE,IAAI,EAAI,EAAE,CAC7ByB,aAAa,CAAE3B,MAAM,CAAC4B,OAAO,EAAI,EAAE,CACnC3I,WAAW,CAAE+G,MAAM,CAACI,KAAK,EAAI,EAAE,CAC/BlH,WAAW,CAAE8G,MAAM,CAACK,KAAK,EAAI,EAAE,CAC/BrH,aAAa,CAAEgH,MAAM,CAACG,aAAa,EAAI,EAAE,CACzChH,mBAAmB,CAAE6G,MAAM,CAACM,aAAa,EAAI,EAAE,CAC/ClH,UAAU,CAAE4G,MAAM,CAACO,IAAI,EAAI,QAAQ,CACnC3G,UAAU,CAAE,QAAU;AACxB,CAAC,CACD7C,OAAO,CAACE,GAAG,CAAC,2DAA2D,CAAEgJ,OAAO,CAACrG,UAAU,CAAC,CAC5F,MAAO,CAAAqG,OAAO,CAChB,CAAC,CAAC,CACFrF,oBAAoB,CAAC,EAAE,CAAC,CACxBI,eAAe,CAAC,EAAE,CAAC,CACrB,CAAC,CAED;AACA,KAAM,CAAA6G,iCAAiC,CAAI7B,MAAM,EAAK,CACpDzI,WAAW,CAAC+H,IAAI,GAAK,CACnB,GAAGA,IAAI,CACPjG,SAAS,CAAE2G,MAAM,CAACE,IAAI,EAAI,EAAE,CAC5B5G,YAAY,CAAE0G,MAAM,CAACG,aAAa,EAAI,EAAE,CACxC5G,UAAU,CAAEyG,MAAM,CAACI,KAAK,EAAI,EAAE,CAC9B5G,UAAU,CAAEwG,MAAM,CAACK,KAAK,EAAI,EAAE,CAC9B5G,kBAAkB,CAAEuG,MAAM,CAACM,aAAa,EAAI,EAAE,CAC9C5G,SAAS,CAAEsG,MAAM,CAACO,IAAI,EAAI,QAC5B,CAAC,CAAC,CAAC,CACHzF,yBAAyB,CAAC,EAAE,CAAC,CAC7B/D,OAAO,CAACE,GAAG,CAAC,0CAA0C,CAAE+I,MAAM,CAAC,CACjE,CAAC,CAED,KAAM,CAAA8B,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAAC,MAAM,CAAG,CAAC,CAAC,CACjB,GAAI,CAAAlD,cAAc,CAAGC,cAAc,CAACD,cAAc,EAAI,CAAC,KAAK,CAAE,UAAU,CAAE,kBAAkB,CAAE,MAAM,CAAE,MAAM,CAAE,OAAO,CAAE,YAAY,CAAC,CAEpI;AACA,GAAIvH,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,CAAE,CACtF6G,cAAc,CAAG,CAAC,GAAGA,cAAc,CAAE,WAAW,CAAC,CACnD,CAEAA,cAAc,CAACmD,OAAO,CAACvB,KAAK,EAAI,CAC9B,GAAI,CAACnJ,QAAQ,CAACmJ,KAAK,CAAC,EAAInJ,QAAQ,CAACmJ,KAAK,CAAC,CAACnE,QAAQ,CAAC,CAAC,CAACiB,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAChEwE,MAAM,CAACtB,KAAK,CAAC,CAAG,GAAGA,KAAK,CAACwB,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAAGzB,KAAK,CAACpJ,KAAK,CAAC,CAAC,CAAC,cAAc,CACjF,CACF,CAAC,CAAC,CAEF;AACA;AACA;AACA;AACA;AAEA,GAAIC,QAAQ,CAACG,IAAI,GAAKH,QAAQ,CAACG,IAAI,CAAG,IAAI,EAAIH,QAAQ,CAACG,IAAI,CAAG,GAAI,CAAAN,IAAI,CAAC,CAAC,CAACgL,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CAAE,CAC3FJ,MAAM,CAACtK,IAAI,CAAG,2BAA2B,CAC3C,CAEA,GAAIH,QAAQ,CAACM,OAAO,EAAIN,QAAQ,CAACM,OAAO,CAAG,CAAC,CAAE,CAC5CmK,MAAM,CAACnK,OAAO,CAAG,4BAA4B,CAC/C,CAEA,GAAIkH,cAAc,CAACL,cAAc,EAAInH,QAAQ,CAACe,aAAa,EAAIf,QAAQ,CAACe,aAAa,EAAI,CAAC,CAAE,CAC1F0J,MAAM,CAAC1J,aAAa,CAAG,uCAAuC,CAChE,CAEA6C,aAAa,CAAC6G,MAAM,CAAC,CACrB,MAAO,CAAAK,MAAM,CAACC,IAAI,CAACN,MAAM,CAAC,CAACnL,MAAM,GAAK,CAAC,CACzC,CAAC,CAED,KAAM,CAAA0L,UAAU,CAAG,cAAAA,CAAA,CAA2B,IAApB,CAAAC,OAAO,CAAA5L,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CACvC,GAAI,CAACT,WAAW,CAAE,CAChBuJ,KAAK,CAAC,yCAAyC,CAAC,CAChDrJ,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CACA,GAAI,CAACmM,OAAO,EAAI,CAACT,YAAY,CAAC,CAAC,CAAE,CAC/B/K,OAAO,CAACE,GAAG,CAAC,kCAAkC,CAAEgE,UAAU,CAAC,CAC3D,OACF,CAEAG,SAAS,CAAC,IAAI,CAAC,CAEf,GAAI,CACF;AACArE,OAAO,CAACE,GAAG,CAAC,yBAAyB,CAAEK,QAAQ,CAAC,CAChDP,OAAO,CAACE,GAAG,CAAC,8CAA8C,CAAEK,QAAQ,CAACsC,UAAU,CAAC,CAChF;AACA7C,OAAO,CAACE,GAAG,CAAC,iCAAiC,CAAE,CAC7CyB,YAAY,CAAEpB,QAAQ,CAACoB,YAAY,CACnCC,kBAAkB,CAAErB,QAAQ,CAACqB,kBAAkB,CAC/CC,aAAa,CAAEtB,QAAQ,CAACsB,aAAa,CACrCC,mBAAmB,CAAEvB,QAAQ,CAACuB,mBAAmB,CACjDC,aAAa,CAAExB,QAAQ,CAACwB,aAAa,CACrCL,cAAc,CAAEnB,QAAQ,CAACmB,cAC3B,CAAC,CAAC,CACF,KAAM,CAAAL,YAAY,CAAG,mBAAmB,CACxC;AACA,KAAM,CAAAoK,QAAQ,CAAG,CACfC,OAAO,CAAE,GAAGnL,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK,EAAE,CAC9DH,GAAG,CAAEF,QAAQ,CAACE,GAAG,CACjBC,IAAI,CAAEiL,QAAQ,CAACpL,QAAQ,CAACG,IAAI,CAAC,CAC7BC,IAAI,CAAEJ,QAAQ,CAACI,IAAI,CACnBC,KAAK,CAAEL,QAAQ,CAACK,KAAK,CACrBkC,aAAa,CAAEvC,QAAQ,CAACuC,aAAa,CACrC8I,KAAK,CAAErL,QAAQ,CAACO,aAAa,CAC7BA,aAAa,CAAEP,QAAQ,CAACO,aAAa,CAAE;AACvCC,aAAa,CAAER,QAAQ,CAACQ,aAAa,CAAE;AACvCF,OAAO,CAAE8K,QAAQ,CAACpL,QAAQ,CAACM,OAAO,CAAC,EAAI,CAAC,CACxCS,aAAa,CAAEuK,UAAU,CAACtL,QAAQ,CAACe,aAAa,CAAC,EAAI,CAAC,CACtDC,SAAS,CAAEsK,UAAU,CAACtL,QAAQ,CAACgB,SAAS,CAAC,EAAI,CAAC,CAC9CC,SAAS,CAAEqK,UAAU,CAACtL,QAAQ,CAACiB,SAAS,CAAC,EAAI,CAAC,CAC9CC,cAAc,CAAEoK,UAAU,CAACtL,QAAQ,CAACkB,cAAc,CAAC,EAAI,CAAC,CACxDT,QAAQ,CAAET,QAAQ,CAACS,QAAQ,CAC3BC,gBAAgB,CAAEV,QAAQ,CAACU,gBAAgB,CAAE;AAC7CyF,SAAS,CAAEnG,QAAQ,CAACU,gBAAgB,CAAE;AACtC6K,MAAM,CAAE,CACN3C,IAAI,CAAE5I,QAAQ,CAACyB,UAAU,CACzB+J,IAAI,CAAExL,QAAQ,CAACsC,UAAU,GAAKtC,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,CAAG,SAAS,CAAGT,QAAQ,CAACS,QAAQ,CAAC2G,QAAQ,CAAC,SAAS,CAAC,CAAG,SAAS,CAAG,QAAQ,CAAC,CAChJqE,OAAO,CAAE,CACPnG,OAAO,CAAEO,YAAY,CAAC7F,QAAQ,CAAC0B,aAAa,CAAC,CAAE;AAC/CoH,KAAK,CAAE9I,QAAQ,CAAC2B,WAAW,CAC3BoH,KAAK,CAAE/I,QAAQ,CAAC4B,WAClB,CAAC,CACDoH,aAAa,CAAEhJ,QAAQ,CAAC6B,mBAAmB,CAC3CoH,IAAI,CAAEjJ,QAAQ,CAAC8B,UACjB,CAAC,CACD;AACA4J,KAAK,CAAE,CACL9C,IAAI,CAAE5I,QAAQ,CAAC+B,SAAS,CACxByJ,IAAI,CAAExL,QAAQ,CAACqC,SAAS,CACxBoJ,OAAO,CAAE,CACPnG,OAAO,CAAEO,YAAY,CAAC7F,QAAQ,CAACgC,YAAY,CAAC,CAC5C8G,KAAK,CAAE9I,QAAQ,CAACiC,UAAU,CAC1B8G,KAAK,CAAE/I,QAAQ,CAACkC,UAClB,CAAC,CACD8G,aAAa,CAAEhJ,QAAQ,CAACmC,kBAAkB,CAC1C8G,IAAI,CAAEjJ,QAAQ,CAACoC,SACjB,CAAC,CACDzB,aAAa,CAAEX,QAAQ,CAACW,aAAa,CACrCE,aAAa,CAAEb,QAAQ,CAACa,aAAa,CACrCD,YAAY,CAAEZ,QAAQ,CAACY,YAAY,CAAG,GAAI,CAAAf,IAAI,CAACG,QAAQ,CAACY,YAAY,CAAC,CAAG,GAAI,CAAAf,IAAI,CAAC,CAAC,CAClFiB,YAAY,CAAEA,YAAY,EAAI,mBAAmB,CACjDkC,WAAW,CAAEpE,WAAW,CAACgK,IAAI,EAAI,SAAS,CAAE;AAC5C;AACA+C,SAAS,CAAEL,UAAU,CAACtL,QAAQ,CAACoB,YAAY,CAAC,EAAI,CAAC,CACjDwK,eAAe,CAAE5L,QAAQ,CAACqB,kBAAkB,EAAI,EAAE,CAClDC,aAAa,CAAEgK,UAAU,CAACtL,QAAQ,CAACsB,aAAa,CAAC,EAAI,CAAC,CACtDC,mBAAmB,CAAE+J,UAAU,CAACtL,QAAQ,CAACuB,mBAAmB,CAAC,EAAI,CAAC,CAClEC,aAAa,CAAE8J,UAAU,CAACtL,QAAQ,CAACwB,aAAa,CAAC,EAAI,CAAC,CACtDL,cAAc,CAAEmK,UAAU,CAACtL,QAAQ,CAACmB,cAAc,CAAC,EAAI,CAAC,CACxDsB,YAAY,CAAEzC,QAAQ,CAACyC,YAAa;AACtC,CAAC,CACDhD,OAAO,CAACE,GAAG,CAAC,4CAA4C,CAAEuL,QAAQ,CAACK,MAAM,CAACC,IAAI,CAAC,CAC/E;AACA/L,OAAO,CAACE,GAAG,CAAC,8CAA8C,CAAEK,QAAQ,CAAC6B,mBAAmB,CAAC,CACzFpC,OAAO,CAACE,GAAG,CAAC,6CAA6C,CAAEK,QAAQ,CAACmC,kBAAkB,CAAC,CACvF;AACA1C,OAAO,CAACE,GAAG,CAAC,oCAAoC,CAAEuL,QAAQ,CAAC,CAC3D;AACAA,QAAQ,CAACpK,YAAY,CAAG,mBAAmB,CAC3CrB,OAAO,CAACE,GAAG,CAAC,wCAAwC,CAAEuL,QAAQ,CAACpK,YAAY,CAAC,CAC5ErB,OAAO,CAACE,GAAG,CAAC,wBAAwB,CAAEuL,QAAQ,CAAC,CAC/C;AACA,KAAM,CAAAW,YAAY,CAAG,KAAM,CAAA1H,KAAK,CAAC,YAAY,CAAE,CAC7CwD,MAAM,CAAE,MAAM,CACdnI,OAAO,CAAEL,YAAY,CAAC,CAAC,CACvByI,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACoD,QAAQ,CAAC,CAC9B9G,WAAW,CAAE,SACf,CAAC,CAAC,CACF;AACA3E,OAAO,CAACE,GAAG,CAAC,wCAAwC,CAAEkM,YAAY,CAAC9D,MAAM,CAAC,CAC1E,KAAM,CAAA+D,UAAU,CAAG,KAAM,CAAAD,YAAY,CAACtH,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,KAAO,CAAC,CAAC,CAAC,CAAC,CAC9DnF,OAAO,CAACE,GAAG,CAAC,sCAAsC,CAAEmM,UAAU,CAAC,CAC/D,GAAI,CAACD,YAAY,CAACE,EAAE,CAAE,CACpBtM,OAAO,CAACE,GAAG,CAAC,uCAAuC,CAAEmM,UAAU,CAAC,CAChE,KAAM,IAAI,CAAAE,KAAK,CAAC,uBAAuB,CAAC,CAC1C,CAEA,KAAM,CAAAC,MAAM,CAAGH,UAAU,CAACI,IAAI,CAACC,GAAG,CAElC;AACA1M,OAAO,CAACE,GAAG,CAAC,4DAA4D,CAAC,CACzEF,OAAO,CAACE,GAAG,CAAC,oDAAoD,CAAEK,QAAQ,CAACU,gBAAgB,CAAC,CAC5FjB,OAAO,CAACE,GAAG,CAAC,6CAA6C,CAAEK,QAAQ,CAACU,gBAAgB,CAAC,CAErF;AACA,KAAM,CAAA0L,gBAAgB,CAAG,KAAM,CAAAjI,KAAK,CAAC,2BAA2B8H,MAAM,EAAE,CAAE,CACxEtE,MAAM,CAAE,MAAM,CACdnI,OAAO,CAAEL,YAAY,CAAC,CAAC,CACvByI,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnB3B,SAAS,CAAEnG,QAAQ,CAACU,gBAAgB,CACpCA,gBAAgB,CAAEV,QAAQ,CAACU,gBAAgB,CAAE;AAC7CS,cAAc,CAAEmK,UAAU,CAACtL,QAAQ,CAACmB,cAAc,CAAC,EAAI,CAAC,CACxDkL,WAAW,CAAErM,QAAQ,CAACuC,aAAa,CACnCrB,cAAc,CAAEoK,UAAU,CAACtL,QAAQ,CAACkB,cAAc,CAAC,EAAI,CAAC,CACxDuB,YAAY,CAAEzC,QAAQ,CAACyC,YAAY,CACnCD,kBAAkB,CAAExC,QAAQ,CAACwC,kBAAkB,CAC/CT,SAAS,CAAE/B,QAAQ,CAAC+B,SAAS,CAC7BM,SAAS,CAAErC,QAAQ,CAACqC,SAAS,CAC7BL,YAAY,CAAEhC,QAAQ,CAACgC,YAAY,CACnCC,UAAU,CAAEjC,QAAQ,CAACiC,UAAU,CAC/BC,UAAU,CAAElC,QAAQ,CAACkC,UAAU,CAC/BC,kBAAkB,CAAEnC,QAAQ,CAACmC,kBAAkB,CAC/CC,SAAS,CAAEpC,QAAQ,CAACoC,SAAS,CAC7BE,UAAU,CAAEtC,QAAQ,CAACsC,UACvB,CAAC,CAAC,CACF8B,WAAW,CAAE,SAAU;AACzB,CAAC,CAAC,CAEF,GAAI,CAACgI,gBAAgB,CAACL,EAAE,CAAE,CACxB,KAAM,CAAAO,GAAG,CAAG,KAAM,CAAAF,gBAAgB,CAAC7H,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,KAAO,CAAC,CAAC,CAAC,CAAC,CAC3D,KAAM,IAAI,CAAAoH,KAAK,CAACM,GAAG,CAACpE,KAAK,EAAI,6BAA6B,CAAC,CAC7D,CAEA,KAAM,CAAAqE,cAAc,CAAG,KAAM,CAAAH,gBAAgB,CAAC7H,IAAI,CAAC,CAAC,CAEpD;AACA,GAAIvE,QAAQ,CAAC+C,SAAS,EAAI/C,QAAQ,CAAC+C,SAAS,CAACzD,MAAM,CAAG,CAAC,CAAE,CACvD,IAAK,GAAI,CAAAqK,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG3J,QAAQ,CAAC+C,SAAS,CAACzD,MAAM,CAAEqK,CAAC,EAAE,CAAE,CAClD,KAAM,CAAA6C,IAAI,CAAGxM,QAAQ,CAAC+C,SAAS,CAAC4G,CAAC,CAAC,CAClC,KAAM,CAAA8C,OAAO,CAAGxI,aAAa,CAACkG,IAAI,CAACH,GAAG,EAAIA,GAAG,CAACJ,SAAS,GAAKD,CAAC,CAAC,CAC9D,KAAM,CAAAE,IAAI,CAAG4C,OAAO,CAAGA,OAAO,CAAC5C,IAAI,CAAG,EAAE,CACxC,KAAM,CAAA6C,YAAY,CAAG,WAAW,CAChC,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC3BD,IAAI,CAACE,MAAM,CAAC,UAAU,CAAEL,IAAI,CAAC,CAC7B,GAAI3C,IAAI,CAAE8C,IAAI,CAACE,MAAM,CAAC,OAAO,CAAEhD,IAAI,CAAC,CACpC,GAAI,CACF,KAAM,CAAAiD,SAAS,CAAG,KAAM,CAAA3I,KAAK,CAAC,yBAAyB8H,MAAM,cAAcS,YAAY,SAAS,CAAE,CAChG/E,MAAM,CAAE,MAAM,CACdnI,OAAO,CAAE,CACP,eAAe,CAAEX,cAAc,CAAC,CAAC,CAAC,eAAe,CACnD,CAAC,CACD+I,IAAI,CAAE+E,IAAI,CACVvI,WAAW,CAAE,SACf,CAAC,CAAC,CACF,GAAI,CAAC0I,SAAS,CAACf,EAAE,CAAE,CACjB,KAAM,CAAAO,GAAG,CAAG,KAAM,CAAAQ,SAAS,CAACvI,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,KAAO,CAAC,CAAC,CAAC,CAAC,CACpDzG,KAAK,CAAC+J,KAAK,CAAC,oBAAoBsE,IAAI,CAAC5D,IAAI,KAAK0D,GAAG,CAACpE,KAAK,EAAI4E,SAAS,CAACC,UAAU,EAAE,CAAC,CACpF,CAAC,IAAM,CACL5O,KAAK,CAACsG,OAAO,CAAC,YAAY+H,IAAI,CAAC5D,IAAI,EAAE,CAAC,CACxC,CACF,CAAE,MAAO0D,GAAG,CAAE,CACZnO,KAAK,CAAC+J,KAAK,CAAC,mBAAmBsE,IAAI,CAAC5D,IAAI,KAAK0D,GAAG,CAACU,OAAO,EAAE,CAAC,CAC7D,CACF,CACF,CACA;AAEAvN,OAAO,CAACE,GAAG,CAAC,sCAAsC,CAAE4M,cAAc,CAAC,CAEnE;AACA,KAAM,CAAAU,cAAc,CAAGhC,OAAO,CAC1B,2BAA2B,CAC3B,4IAA4I,CAEhJ9M,KAAK,CAACsG,OAAO,CAACwI,cAAc,CAAC,CAE7B;AACA,GAAI,CAAChC,OAAO,CAAE,CACZ;AACAhL,WAAW,CAAC,CACVC,GAAG,CAAE,EAAE,CACPC,IAAI,CAAE,EAAE,CACRC,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,EAAE,CACTC,OAAO,CAAE,EAAE,CACXC,aAAa,CAAE,EAAE,CACjBC,aAAa,CAAE,EAAE,CACjBC,QAAQ,CAAE,EAAE,CACZC,gBAAgB,CAAE,EAAE,CACpBC,aAAa,CAAE,EAAE,CACjBC,YAAY,CAAEhB,QAAQ,CACtBiB,aAAa,CAAE,OAAO,CACtBC,YAAY,CAAE,mBAAmB,CACjCC,aAAa,CAAE,EAAE,CACjBC,SAAS,CAAE,EAAE,CACbC,SAAS,CAAE,EAAE,CACbC,cAAc,CAAE,EAAE,CAClBC,cAAc,CAAE,EAAE,CAClBC,YAAY,CAAE,EAAE,CAChBC,kBAAkB,CAAE,EAAE,CACtBC,aAAa,CAAE,EAAE,CACjBC,mBAAmB,CAAE,EAAE,CACvBC,aAAa,CAAE,EAAE,CACjBC,UAAU,CAAE,EAAE,CACdC,aAAa,CAAE,EAAE,CACjBC,WAAW,CAAE,EAAE,CACfC,WAAW,CAAE,EAAE,CACfC,mBAAmB,CAAE,EAAE,CACvBC,UAAU,CAAE,QAAQ,CACpBC,SAAS,CAAE,EAAE,CACbC,YAAY,CAAE,EAAE,CAChBC,UAAU,CAAE,EAAE,CACdC,UAAU,CAAE,EAAE,CACdC,kBAAkB,CAAE,EAAE,CACtBC,SAAS,CAAE,QAAQ,CACnBC,SAAS,CAAE,QAAQ,CACnBC,UAAU,CAAE,SAAS,CACrBC,aAAa,CAAE,EAAE,CACjBC,kBAAkB,CAAE,EAAE,CACtBC,YAAY,CAAE,EAAE,CAChBC,gBAAgB,CAAE,KAAK,CACvBC,YAAY,CAAE,KAAK,CACnBC,oBAAoB,CAAE,KAAK,CAC3BC,eAAe,CAAE,KAAK,CACtBC,oBAAoB,CAAE,KAAK,CAC3BC,SAAS,CAAE,EAAE,CACbC,WAAW,CAAE,EACf,CAAC,CAAC,CACFgB,cAAc,CAAC,CAAC,CAAC,CACnB,CAEF,CAAE,MAAOkE,KAAK,CAAE,CACd,GAAIA,KAAK,CAAC8E,OAAO,CAAC5F,QAAQ,CAAC,KAAK,CAAC,EAAIc,KAAK,CAAC8E,OAAO,CAAC5F,QAAQ,CAAC,gBAAgB,CAAC,CAAE,CAC7Ee,KAAK,CAAC,yDAAyD,CAAC,CAChErJ,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,IAAM,CACLqJ,KAAK,CAAC,sBAAsBD,KAAK,CAAC8E,OAAO,EAAE,CAAC,CAC5CvN,OAAO,CAACE,GAAG,CAAC,sBAAsB,CAAEuI,KAAK,CAAC,CAC5C,CACF,CAAC,OAAS,CACRpE,SAAS,CAAC,KAAK,CAAC,CAClB,CACF,CAAC,CAED,KAAM,CAAAoJ,wBAAwB,CAAGA,CAAA,GAAM,CACrC,KAAM,CAAAC,SAAS,CAAG;AACtB;AACA,WAAWnN,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK;AAC3D,OAAOL,QAAQ,CAACE,GAAG;AACnB,WAAWF,QAAQ,CAACuC,aAAa;AACjC,WAAWvC,QAAQ,CAACM,OAAO;AAC3B,YAAYN,QAAQ,CAACO,aAAa;AAClC,YAAYP,QAAQ,CAACQ,aAAa;AAClC;AACA;AACA,EAAER,QAAQ,CAACwC,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,EAAE5D,WAAW,CAACgK,IAAI,EAAE,CAEhB,KAAM,CAAAwE,UAAU,CAAG,kEAAkEpN,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK,SAASiI,kBAAkB,CAAC6E,SAAS,CAAC,EAAE,CAC7KE,MAAM,CAACC,IAAI,CAACF,UAAU,CAAC,CACzB,CAAC,CAED;AACA;AAEA,KAAM,CAAAG,mBAAmB,CAAGA,CAAA,gBAC1BlP,IAAA,QAAKmP,SAAS,CAAC,MAAM,CAAAC,QAAA,cACnBpP,IAAA,QAAKmP,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAC/C/I,KAAK,CAAC8E,IAAI,CAAC,CAAElK,MAAM,CAAEoO,UAAW,CAAC,CAAE,CAAChE,CAAC,CAAEK,KAAK,GAAK,CAChD,KAAM,CAAA4D,UAAU,CAAG5D,KAAK,CAAG,CAAC,CAC5B,KAAM,CAAA6D,QAAQ,CAAG7J,WAAW,GAAK4J,UAAU,CAC3C,KAAM,CAAAE,WAAW,CAAG9J,WAAW,CAAG4J,UAAU,CAE5C,GAAI,CAAAG,SAAS,CAAG,EAAE,CAClB,GAAI,CAAAC,eAAe,CAAG,EAAE,CAExB,GAAIJ,UAAU,GAAK,CAAC,CAAE,CACpBG,SAAS,CAAG,qBAAqB,CACjCC,eAAe,CAAG,gDAAgD,CACpE,CAAC,IAAM,IAAIJ,UAAU,GAAK,CAAC,CAAE,CAC3BG,SAAS,CAAG,oBAAoB,CAChCC,eAAe,CAAG,0CAA0C,CAC9D,CAAC,IAAM,IAAIJ,UAAU,GAAK,CAAC,EAAInG,cAAc,CAACL,cAAc,CAAE,CAC5D2G,SAAS,CAAG,uBAAuB,CACnCC,eAAe,CAAG,iCAAiC,CACrD,CAAC,IAAM,IAAKJ,UAAU,GAAK,CAAC,EAAI,CAACnG,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EACnFsG,UAAU,GAAK,CAAC,EAAInG,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAe,CAAE,CAC/FyG,SAAS,CAAG,oBAAoB,CAChCC,eAAe,CAAG,gCAAgC,CACpD,CAAC,IAAM,IAAKJ,UAAU,GAAK,CAAC,EAAI,CAACnG,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAiB,EACxHqG,UAAU,GAAK,CAAC,EAAInG,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAkB,EACxHqG,UAAU,GAAK,CAAC,EAAInG,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAkB,CAAE,CACnIwG,SAAS,CAAG,uBAAuB,CACnCC,eAAe,CAAG,sCAAsC,CAC1D,CAEA,mBACExP,KAAA,QAAsBiP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eACjDpP,IAAA,QAAKmP,SAAS,CAAE,sFACdI,QAAQ,CACJ,wCAAwC,CACxCC,WAAW,CACT,0CAA0C,CAC1C,2CAA2C,EAChD,CAAAJ,QAAA,CACAI,WAAW,cACVxP,IAAA,CAACnB,WAAW,EAACsQ,SAAS,CAAC,SAAS,CAAE,CAAC,cAEnCnP,IAAA,SAAMmP,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAEE,UAAU,CAAO,CACzD,CACE,CAAC,cACNpP,KAAA,QAAKiP,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBpP,IAAA,MAAGmP,SAAS,CAAE,uBAAuBI,QAAQ,CAAG,YAAY,CAAG,eAAe,EAAG,CAAAH,QAAA,CAC9EK,SAAS,CACT,CAAC,cACJzP,IAAA,MAAGmP,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAEM,eAAe,CAAI,CAAC,EACvD,CAAC,CACLJ,UAAU,CAAGD,UAAU,eACtBrP,IAAA,QAAKmP,SAAS,CAAE,mBAAmBK,WAAW,CAAG,cAAc,CAAG,aAAa,EAAG,CAAE,CACrF,GAtBOF,UAuBL,CAAC,CAEV,CAAC,CAAC,CACC,CAAC,CACH,CACN,CAED,KAAM,CAAAK,eAAe,CAAG,QAAAA,CAACnH,KAAK,CAAEsC,KAAK,CAA0F,IAAxF,CAAAqC,IAAI,CAAAnM,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,MAAM,IAAE,CAAA4O,OAAO,CAAA5O,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,IAAE,CAAA6O,QAAQ,CAAA7O,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,IAAE,CAAA8O,IAAI,CAAA9O,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,IAAE,CAAA+O,aAAa,CAAA/O,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CACxH,mBACEd,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBlP,KAAA,UAAOiP,SAAS,CAAC,qDAAqD,CAAAC,QAAA,EACnEU,IAAI,eAAIxR,KAAK,CAAC0R,aAAa,CAACF,IAAI,CAAE,CAAEX,SAAS,CAAE,cAAe,CAAC,CAAC,CAChE3G,KAAK,CACLqH,QAAQ,eAAI7P,IAAA,SAAMmP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,EACpD,CAAC,CAEPjC,IAAI,GAAK,QAAQ,cAChBjN,KAAA,WACEuG,KAAK,CAAE9E,QAAQ,CAACmJ,KAAK,CAAE,CACvBmF,QAAQ,CAAGhF,CAAC,EAAKJ,iBAAiB,CAACC,KAAK,CAAEG,CAAC,CAACG,MAAM,CAAC3E,KAAK,CAAE,CAC1D0I,SAAS,CAAE,wJACT7J,UAAU,CAACwF,KAAK,CAAC,CAAG,gBAAgB,CAAG,uCAAuC,EAC7E,CAAAsE,QAAA,eAEHlP,KAAA,WAAQuG,KAAK,CAAC,EAAE,CAAA2I,QAAA,EAAC,SAAO,CAAC5G,KAAK,EAAS,CAAC,CACvCoH,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAElI,GAAG,CAACwI,MAAM,eAClBlQ,IAAA,WAA2ByG,KAAK,CAAEyJ,MAAM,CAACzJ,KAAM,CAAC0I,SAAS,CAAC,aAAa,CAAAC,QAAA,CACpEc,MAAM,CAAC1H,KAAK,EADF0H,MAAM,CAACzJ,KAEZ,CACT,CAAC,EACI,CAAC,CACP0G,IAAI,GAAK,UAAU,cACrBnN,IAAA,aACEyG,KAAK,CAAE9E,QAAQ,CAACmJ,KAAK,CAAE,CACvBmF,QAAQ,CAAGhF,CAAC,EAAKJ,iBAAiB,CAACC,KAAK,CAAEG,CAAC,CAACG,MAAM,CAAC3E,KAAK,CAAE,CAC1D0J,IAAI,CAAE,CAAE,CACRC,WAAW,CAAE,SAAS5H,KAAK,CAAC6H,WAAW,CAAC,CAAC,KAAM,CAC/ClB,SAAS,CAAE,oKACT7J,UAAU,CAACwF,KAAK,CAAC,CAAG,gBAAgB,CAAG,uCAAuC,EAC7E,CACJ,CAAC,CACAqC,IAAI,GAAK,UAAU,cACrBjN,KAAA,UAAOiP,SAAS,CAAC,4CAA4C,CAAAC,QAAA,eAC3DpP,IAAA,UACEmN,IAAI,CAAC,UAAU,CACfmD,OAAO,CAAE,CAAC,CAAC3O,QAAQ,CAACmJ,KAAK,CAAE,CAC3BmF,QAAQ,CAAGhF,CAAC,EAAKJ,iBAAiB,CAACC,KAAK,CAAEG,CAAC,CAACG,MAAM,CAACkF,OAAO,CAAE,CAC5DnB,SAAS,CAAC,uEAAuE,CAClF,CAAC,cACFnP,IAAA,SAAMmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAE5G,KAAK,CAAO,CAAC,EACzC,CAAC,cAERtI,KAAA,QAAKiP,SAAS,CAAC,UAAU,CAAAC,QAAA,EACtB,CAAC,eAAe,CAAE,WAAW,CAAE,WAAW,CAAE,gBAAgB,CAAE,cAAc,CAAE,eAAe,CAAE,qBAAqB,CAAE,eAAe,CAAC,CAACrG,QAAQ,CAAC+B,KAAK,CAAC,eACrJ9K,IAAA,QAAKmP,SAAS,CAAC,0EAA0E,CAAAC,QAAA,CAAC,GAAC,CAAK,CACjG,cACDpP,IAAA,UACEmN,IAAI,CAAEA,IAAK,CACX1G,KAAK,CAAE9E,QAAQ,CAACmJ,KAAK,CAAC,EAAI,EAAG,CAC7BmF,QAAQ,CAAGhF,CAAC,EAAK,CACfJ,iBAAiB,CAACC,KAAK,CAAEG,CAAC,CAACG,MAAM,CAAC3E,KAAK,CAAC,CAC1C,CAAE,CACF2J,WAAW,CAAE,SAAS5H,KAAK,CAAC6H,WAAW,CAAC,CAAC,KAAM,CAC/ClB,SAAS,CAAE,wJACT7J,UAAU,CAACwF,KAAK,CAAC,CAAG,gBAAgB,CAAG,uCAAuC,IAC5EA,KAAK,GAAK,KAAK,CAAG,OAAO,CAAG,EAAE,IAAI,CAAC,eAAe,CAAE,WAAW,CAAE,WAAW,CAAE,gBAAgB,CAAE,cAAc,CAAE,eAAe,CAAE,qBAAqB,CAAE,eAAe,CAAC,CAAC/B,QAAQ,CAAC+B,KAAK,CAAC,CAAG,MAAM,CAAG,EAAE,EAAG,CAC9M,CAAC,CAEDA,KAAK,GAAK,KAAK,EAAInJ,QAAQ,CAACE,GAAG,CAACZ,MAAM,GAAK,EAAE,eAC5CjB,IAAA,QAAKmP,SAAS,CAAC,qDAAqD,CAAAC,QAAA,CACjExK,WAAW,cACV5E,IAAA,CAAClB,OAAO,EAACqQ,SAAS,CAAC,oCAAoC,CAAE,CAAC,CACxDrK,UAAU,cACZ9E,IAAA,CAACnB,WAAW,EAACsQ,SAAS,CAAC,wBAAwB,CAAE,CAAC,cAElDnP,IAAA,WACEuQ,OAAO,CAAEA,CAAA,GAAMnH,SAAS,CAACzH,QAAQ,CAACE,GAAG,CAAE,CACvCsN,SAAS,CAAC,sFAAsF,CAAAC,QAAA,CACjG,QAED,CAAQ,CACT,CACE,CACN,CAGAW,aAAa,EAAIjF,KAAK,GAAK,YAAY,EAAI5F,sBAAsB,CAACjE,MAAM,CAAG,CAAC,eAC3EjB,IAAA,QAAKmP,SAAS,CAAC,6HAA6H,CAAAC,QAAA,CACzIlK,sBAAsB,CAACwC,GAAG,CAAC2C,MAAM,eAChCnK,KAAA,QAEEiP,SAAS,CAAC,+EAA+E,CACzFoB,OAAO,CAAEA,CAAA,GAAM,CACb3O,WAAW,CAAC+H,IAAI,OAAA6G,eAAA,OAAK,CACnB,GAAG7G,IAAI,CACP8G,UAAU,CAAEpG,MAAM,CAACE,IAAI,CACvBmG,aAAa,CAAErG,MAAM,CAAC4B,OAAO,CAC7B0E,WAAW,CAAEtG,MAAM,CAACI,KAAK,CACzBmG,WAAW,CAAE,EAAAJ,eAAA,CAAAnG,MAAM,CAAC+C,OAAO,UAAAoD,eAAA,iBAAdA,eAAA,CAAgB9F,KAAK,GAAIL,MAAM,CAACK,KAAK,EAAI,EAAE,CACxDmG,aAAa,CAAExG,MAAM,CAACyG,QAAQ,EAAIzG,MAAM,CAACpD,OAAO,EAAI,EACtD,CAAC,EAAC,CAAC,CACH9B,yBAAyB,CAAC,EAAE,CAAC,CAC/B,CAAE,CAAAiK,QAAA,eAEFpP,IAAA,QAAKmP,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAE/E,MAAM,CAACE,IAAI,CAAM,CAAC,cAC3DrK,KAAA,QAAKiP,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAE/E,MAAM,CAAC4B,OAAO,CAAC,UAAG,CAAC5B,MAAM,CAACyG,QAAQ,EAAM,CAAC,GAf5EzG,MAAM,CAAC0G,EAgBT,CACN,CAAC,CACC,CACN,CAGAjG,KAAK,GAAK,WAAW,EAAInJ,QAAQ,CAACqC,SAAS,GAAK,QAAQ,EAAIkB,sBAAsB,CAACjE,MAAM,CAAG,CAAC,eAC5FjB,IAAA,QAAKmP,SAAS,CAAC,6HAA6H,CAAAC,QAAA,CACzIlK,sBAAsB,CAACwC,GAAG,CAAC2C,MAAM,eAChCnK,KAAA,QAEEiP,SAAS,CAAC,+EAA+E,CACzFoB,OAAO,CAAEA,CAAA,GAAM,CACbrE,iCAAiC,CAAC7B,MAAM,CAAC,CAC3C,CAAE,CAAA+E,QAAA,eAEFpP,IAAA,QAAKmP,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAE/E,MAAM,CAACE,IAAI,CAAM,CAAC,cAC3DrK,KAAA,QAAKiP,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAE/E,MAAM,CAAC4B,OAAO,CAAC,UAAG,CAAC5B,MAAM,CAACyG,QAAQ,EAAM,CAAC,GAP5EzG,MAAM,CAAC0G,EAQT,CACN,CAAC,CACC,CACN,CAGAjG,KAAK,GAAK,YAAY,EAAI9F,iBAAiB,CAAC/D,MAAM,CAAG,CAAC,GACpDU,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,EAAIV,QAAQ,CAACsC,UAAU,GAAK,QAAQ,EACtH,CAAC,CAAC,WAAW,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC8E,QAAQ,CAACpH,QAAQ,CAACS,QAAQ,CAAC,EACzE,EAAET,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,CAAE,CACxF,eACCrC,IAAA,QAAKmP,SAAS,CAAC,6HAA6H,CAAAC,QAAA,CACzIpK,iBAAiB,CAAC0C,GAAG,CAAC2C,MAAM,eAC3BnK,KAAA,QAEEiP,SAAS,CAAC,+EAA+E,CACzFoB,OAAO,CAAEA,CAAA,GAAM,CACbxE,4BAA4B,CAAC1B,MAAM,CAAC,CACtC,CAAE,CAAA+E,QAAA,eAEFpP,IAAA,QAAKmP,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAE/E,MAAM,CAACE,IAAI,CAAM,CAAC,cAC3DrK,KAAA,QAAKiP,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAE/E,MAAM,CAAC4B,OAAO,CAAC,UAAG,CAAC5B,MAAM,CAACyG,QAAQ,EAAM,CAAC,GAP5EzG,MAAM,CAAC0G,EAQT,CACN,CAAC,CACC,CACN,EACE,CACN,CAEAzL,UAAU,CAACwF,KAAK,CAAC,eAChB5K,KAAA,QAAKiP,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrDpP,IAAA,CAACN,WAAW,EAACyP,SAAS,CAAC,cAAc,CAAE,CAAC,CACvC7J,UAAU,CAACwF,KAAK,CAAC,EACf,CACN,EACE,CAAC,CAEV,CAAC,CAED,KAAM,CAAAkG,UAAU,CAAGA,CAAA,GAAM,CACvB,OAAQtL,WAAW,EACjB,IAAK,EAAC,CACJ,mBACExF,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExBlP,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,qBAAmB,CAAI,CAAC,CAC3EO,eAAe,CAAC,WAAW,CAAE,UAAU,CAAE,QAAQ,CAAEpH,SAAS,CAAE,IAAI,CAAE9J,GAAG,CAAC,cACzEuB,IAAA,QAAKmP,SAAS,CAAC,MAAM,CAAAC,QAAA,CAClBO,eAAe,CAAC,aAAa,CAAE,kBAAkB,CAAE,QAAQ,CAAEhH,mBAAmB,CAAE,IAAI,CAAC,CACrF,CAAC,EACH,CAAC,cAENzI,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,qBAAmB,CAAI,CAAC,cAC5ElP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDpP,IAAA,QAAKmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3BO,eAAe,CAAC,KAAK,CAAE,KAAK,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAEtQ,IAAI,CAAC,CACrD,CAAC,CACLsQ,eAAe,CAAC,MAAM,CAAE,MAAM,CAAE,QAAQ,CAAE,IAAI,CAAE,IAAI,CAAE5Q,QAAQ,CAAC,CAC/D4Q,eAAe,CAAC,MAAM,CAAE,MAAM,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAC,CACnDA,eAAe,CAAC,OAAO,CAAE,OAAO,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAC,CACrDA,eAAe,CAAC,SAAS,CAAE,SAAS,CAAE,QAAQ,CAAE,IAAI,CAAE,KAAK,CAAEpQ,KAAK,CAAC,CACnEoQ,eAAe,CAAC,gBAAgB,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAErQ,OAAO,CAAC,CAChFqQ,eAAe,CAAC,gBAAgB,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAErQ,OAAO,CAAC,EAE9E,CAAC,EACH,CAAC,EACH,CAAC,CAGV,IAAK,EAAC,CACJ,mBACEU,IAAA,QAAKmP,SAAS,CAAC,WAAW,CAAAC,QAAA,cAExBlP,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,cAC3ElP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,EACnDO,eAAe,CAAC,gBAAgB,CAAE,eAAe,CAAE,QAAQ,CAAElH,cAAc,CAAE,IAAI,CAAEzJ,UAAU,CAAC,CAC9F2Q,eAAe,CAAC,oBAAoB,CAAE,cAAc,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAE5Q,QAAQ,CAAC,CACnF4Q,eAAe,CAAC,gBAAgB,CAAE,eAAe,CAAE,QAAQ,CAAEjH,cAAc,CAAE,IAAI,CAAC,CAClFiH,eAAe,CAAC,iBAAiB,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAEtQ,IAAI,CAAC,CAC9EsQ,eAAe,CAAC,aAAa,CAAE,aAAa,CAAE,QAAQ,CAAE/G,kBAAkB,CAAE,IAAI,CAAE3J,IAAI,CAAC,EACrF,CAAC,EACH,CAAC,CACH,CAAC,CAEV,IAAK,EAAC,CACJ,MAAO,CAAAkK,cAAc,CAACL,cAAc,cAClC5I,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,uBAAqB,CAAI,CAAC,CAC7EzN,QAAQ,CAACU,gBAAgB,GAAK,MAAM,cACnCnC,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvBO,eAAe,CAACrH,aAAa,CAACN,kBAAkB,CAAE,eAAe,CAAE,QAAQ,CAAE,IAAI,CAAE,IAAI,CAAEhJ,UAAU,CAAC,CACpG2Q,eAAe,CAAC,eAAe,CAAE,cAAc,CAAE,QAAQ,CAAC,CAC1DA,eAAe,CAAC,uBAAuB,CAAE,oBAAoB,CAAE,MAAM,CAAC,CACtEA,eAAe,CAAC,wBAAwB,CAAE,qBAAqB,CAAE,QAAQ,CAAC,CAC1EA,eAAe,CAAC,kBAAkB,CAAE,eAAe,CAAE,QAAQ,CAAC,EAC5D,CAAC,cAENzP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eAEpDlP,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvBO,eAAe,CAACrH,aAAa,CAACN,kBAAkB,CAAE,eAAe,CAAE,QAAQ,CAAE,IAAI,CAAE,IAAI,CAAEhJ,UAAU,CAAC,CACpG2Q,eAAe,CAAC,YAAY,CAAE,WAAW,CAAE,QAAQ,CAAC,CACpDA,eAAe,CAAC,iBAAiB,CAAE,gBAAgB,CAAE,QAAQ,CAAC,CAC9DA,eAAe,CAAC,YAAY,CAAE,WAAW,CAAE,QAAQ,CAAC,CAEpD,CAAC,WAAW,CAAC,WAAW,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC5G,QAAQ,CAACpH,QAAQ,CAACU,gBAAgB,CAAC,CACrFsN,eAAe,CAAC,qBAAqB,CAAE,gBAAgB,CAAE,QAAQ,CAAC,CAClE,IAAI,EACL,CAAC,cAENzP,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvBO,eAAe,CAAC,eAAe,CAAE,cAAc,CAAE,QAAQ,CAAC,CAC1DA,eAAe,CAAC,uBAAuB,CAAE,oBAAoB,CAAE,MAAM,CAAC,CACtEA,eAAe,CAAC,gBAAgB,CAAE,eAAe,CAAE,QAAQ,CAAC,CAC5DA,eAAe,CAAC,wBAAwB,CAAE,qBAAqB,CAAE,QAAQ,CAAC,CAC1EA,eAAe,CAAC,kBAAkB,CAAE,eAAe,CAAE,QAAQ,CAAC,EAC5D,CAAC,EACH,CACN,EACE,CAAC,cAENzP,KAAA,QAAKiP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCpP,IAAA,CAAChB,UAAU,EAACmQ,SAAS,CAAC,sCAAsC,CAAE,CAAC,cAC/DnP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,oCAAkC,CAAI,CAAC,cAC3FpP,IAAA,MAAGmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,wDAAsD,CAAG,CAAC,EACpF,CACN,CAEH,IAAK,EAAC,CACJ;AACA,GAAIzN,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,CAAE,CACtF,mBACEnC,KAAA,QAAKiP,SAAS,CAAC,6DAA6D,CAAAC,QAAA,eAE1ElP,KAAA,QAAAkP,QAAA,eACElP,KAAA,QAAKiP,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrDpP,IAAA,OAAImP,SAAS,CAAC,gCAAgC,CAAAC,QAAA,CAAC,mBAAiB,CAAI,CAAC,cACrElP,KAAA,QAAKiP,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,WAAW,CAAE,SAAS,CAAE,CACzDsE,SAAS,CAAE,yDACTxN,QAAQ,CAACqC,SAAS,GAAK,SAAS,CAC5B,wCAAwC,CACxC,0DAA0D,EAC7D,CAAAoL,QAAA,CACJ,eAED,CAAQ,CAAC,cACTpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,WAAW,CAAE,QAAQ,CAAE,CACxDsE,SAAS,CAAE,yDACTxN,QAAQ,CAACqC,SAAS,GAAK,QAAQ,CAC3B,0CAA0C,CAC1C,0DAA0D,EAC7D,CAAAoL,QAAA,CACJ,QAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cACNlP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,EACnDO,eAAe,CAAChO,QAAQ,CAACqC,SAAS,GAAK,QAAQ,CAAG,aAAa,CAAG,YAAY,CAAE,WAAW,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAE/E,IAAI,CAAC,CACtH0Q,eAAe,CAAC,OAAO,CAAE,YAAY,CAAE,KAAK,CAAE,IAAI,CAAE,KAAK,CAAExQ,KAAK,CAAC,CACjEwQ,eAAe,CAAC,OAAO,CAAE,YAAY,CAAE,OAAO,CAAE,IAAI,CAAE,KAAK,CAAEvQ,IAAI,CAAC,CAClEuQ,eAAe,CAAC,SAAS,CAAE,cAAc,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAEzQ,MAAM,CAAC,CACvEyC,QAAQ,CAACqC,SAAS,GAAK,QAAQ,EAAI2L,eAAe,CAAC,uBAAuB,CAAE,oBAAoB,CAAE,MAAM,CAAC,CACzGhO,QAAQ,CAACqC,SAAS,GAAK,QAAQ,EAAI,EAAErC,QAAQ,CAACS,QAAQ,GAAK,eAAe,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,KAAK,CAAC,EAAIsN,eAAe,CAAC,aAAa,CAAE,WAAW,CAAE,QAAQ,CAAE,CAC3K,CAAElJ,KAAK,CAAE,QAAQ,CAAE+B,KAAK,CAAE,wBAAyB,CAAC,CACpD,CAAE/B,KAAK,CAAE,QAAQ,CAAE+B,KAAK,CAAE,8BAA+B,CAAC,CAC3D,CAAC,EACC,CAAC,EACH,CAAC,cAGNtI,KAAA,QAAAkP,QAAA,eACElP,KAAA,QAAKiP,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrDpP,IAAA,OAAImP,SAAS,CAAC,gCAAgC,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,cACtElP,KAAA,QAAKiP,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,YAAY,CAAE,SAAS,CAAE,CAC1DsE,SAAS,CAAE,yDACTxN,QAAQ,CAACsC,UAAU,GAAK,SAAS,CAC7B,wCAAwC,CACxC,0DAA0D,EAC7D,CAAAmL,QAAA,CACJ,eAED,CAAQ,CAAC,cACTpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,YAAY,CAAE,QAAQ,CAAE,CACzDsE,SAAS,CAAE,yDACTxN,QAAQ,CAACsC,UAAU,GAAK,QAAQ,CAC5B,0CAA0C,CAC1C,0DAA0D,EAC7D,CAAAmL,QAAA,CACJ,QAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cACNlP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,EACnDO,eAAe,CAAChO,QAAQ,CAACsC,UAAU,GAAK,QAAQ,CAAG,aAAa,CAAG,aAAa,CAAE,YAAY,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAEhF,IAAI,CAAC,CACzH0Q,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,KAAK,CAAE,IAAI,CAAE,KAAK,CAAExQ,KAAK,CAAC,CAClEwQ,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,OAAO,CAAE,IAAI,CAAE,KAAK,CAAEvQ,IAAI,CAAC,CACnEuQ,eAAe,CAAC,SAAS,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAEzQ,MAAM,CAAC,CACxEyC,QAAQ,CAACsC,UAAU,GAAK,QAAQ,EAAI0L,eAAe,CAAC,uBAAuB,CAAE,qBAAqB,CAAE,MAAM,CAAC,CAC3GhO,QAAQ,CAACsC,UAAU,GAAK,QAAQ,EAAI,EAAEtC,QAAQ,CAACS,QAAQ,GAAK,gBAAgB,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,UAAU,CAAC,EAAI,EAAEV,QAAQ,CAACS,QAAQ,GAAK,eAAe,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,KAAK,CAAC,EAAIsN,eAAe,CAAC,aAAa,CAAE,YAAY,CAAE,QAAQ,CAAE,CACtQ,CAAElJ,KAAK,CAAE,QAAQ,CAAE+B,KAAK,CAAE,wBAAyB,CAAC,CACpD,CAAE/B,KAAK,CAAE,QAAQ,CAAE+B,KAAK,CAAE,8BAA+B,CAAC,CAC3D,CAAC,EACC,CAAC,EACH,CAAC,EACH,CAAC,CAEV,CAAC,IAAM,CACL,KAAM,CAAAT,UAAU,CAAGpG,QAAQ,CAACS,QAAQ,GAAK,WAAW,CACpD,mBACElC,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAE9G,aAAa,CAACJ,kBAAkB,CAAK,CAAC,CAC1FH,UAAU,cACT;AACA7H,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDpP,IAAA,QAAKmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3BO,eAAe,CAACrH,aAAa,CAACL,WAAW,CAAE,YAAY,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAEhJ,IAAI,CAAC,CAChF,CAAC,CACL0Q,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,KAAK,CAAE,IAAI,CAAE,KAAK,CAAExQ,KAAK,CAAC,CAClEwQ,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,OAAO,CAAE,IAAI,CAAE,KAAK,CAAEvQ,IAAI,CAAC,CACnEuQ,eAAe,CAAC,SAAS,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAEzQ,MAAM,CAAC,EACtE,CAAC,cAEN;AACAgB,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDpP,IAAA,QAAKmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3BO,eAAe,CAACrH,aAAa,CAACL,WAAW,CAAE,YAAY,CAAE,MAAM,CAAE,IAAI,CAAE,IAAI,CAAEhJ,IAAI,CAAC,CAChF,CAAC,CACL,CAAC8I,UAAU,EAAI4H,eAAe,CAACrH,aAAa,CAACH,YAAY,CAAE,eAAe,CAAE,MAAM,CAAC,CACnFwH,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,KAAK,CAAE,IAAI,CAAE,KAAK,CAAExQ,KAAK,CAAC,CAClEwQ,eAAe,CAAC,OAAO,CAAE,aAAa,CAAE,OAAO,CAAE,IAAI,CAAE,KAAK,CAAEvQ,IAAI,CAAC,CACnEuQ,eAAe,CAACrH,aAAa,CAACD,YAAY,CAAE,eAAe,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAEnJ,MAAM,CAAC,CAGzFyC,QAAQ,CAACS,QAAQ,GAAK,eAAe,EAAIT,QAAQ,CAACU,gBAAgB,GAAK,KAAK,eAC3EnC,KAAA,CAAAE,SAAA,EAAAgP,QAAA,eACElP,KAAA,QAAAkP,QAAA,eACEpP,IAAA,UAAOiR,OAAO,CAAC,uBAAuB,CAAC9B,SAAS,CAAC,8CAA8C,CAAAC,QAAA,CAAC,uBAAqB,CAAO,CAAC,cAC7HpP,IAAA,UACEmN,IAAI,CAAC,MAAM,CACX4D,EAAE,CAAC,uBAAuB,CAC1BtK,KAAK,CAAE9E,QAAQ,CAAC6B,mBAAmB,EAAI,EAAG,CAC1CyM,QAAQ,CAAEhF,CAAC,EAAIJ,iBAAiB,CAAC,qBAAqB,CAAEI,CAAC,CAACG,MAAM,CAAC3E,KAAK,CAAE,CACxE0I,SAAS,CAAC,wJAAwJ,CACnK,CAAC,EACC,CAAC,cAGNjP,KAAA,QAAKiP,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BpP,IAAA,UAAOmP,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,aAE7D,CAAO,CAAC,cACRlP,KAAA,QAAKiP,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,YAAY,CAAE,QAAQ,CAAE,CACzDsE,SAAS,CAAE,iDACTxN,QAAQ,CAAC8B,UAAU,GAAK,QAAQ,CAC5B,sCAAsC,CACtC,0DAA0D,EAC7D,CAAA2L,QAAA,CACJ,yBAED,CAAQ,CAAC,cACTpP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACboD,OAAO,CAAEA,CAAA,GAAM1F,iBAAiB,CAAC,YAAY,CAAE,QAAQ,CAAE,CACzDsE,SAAS,CAAE,iDACTxN,QAAQ,CAAC8B,UAAU,GAAK,QAAQ,CAC5B,0CAA0C,CAC1C,0DAA0D,EAC7D,CAAA2L,QAAA,CACJ,+BAED,CAAQ,CAAC,EACN,CAAC,cACNpP,IAAA,MAAGmP,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,uDAE1C,CAAG,CAAC,EACD,CAAC,EACN,CACH,EACE,CACN,EACE,CAAC,CAEV,CAEF,IAAK,EAAC,CACJ,MAAO,CAAAjG,cAAc,CAACF,iBAAiB,cACrC/I,KAAA,QAAKiP,SAAS,CAAC,kDAAkD,CAAAC,QAAA,eAC/DpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,uBAAqB,CAAI,CAAC,cAC9ElP,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBlP,KAAA,QAAKiP,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpDlP,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBpP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,sBAAoB,CAAI,CAAC,CAC5EO,eAAe,CAAC,mBAAmB,CAAE,kBAAkB,CAAE,UAAU,CAAC,CACpEA,eAAe,CAAC,eAAe,CAAE,cAAc,CAAE,UAAU,CAAC,CAC5DA,eAAe,CAAC,wBAAwB,CAAE,sBAAsB,CAAE,UAAU,CAAC,CAC7EA,eAAe,CAAC,kBAAkB,CAAE,iBAAiB,CAAE,UAAU,CAAC,CAClEA,eAAe,CAAC,wBAAwB,CAAE,sBAAsB,CAAE,UAAU,CAAC,EAC3E,CAAC,cACNzP,KAAA,QAAKiP,SAAS,CAAC,WAAW,CAAAC,QAAA,EACvBO,eAAe,CAAC,qBAAqB,CAAE,oBAAoB,CAAE,UAAU,CAAE,IAAI,CAAE,KAAK,CAAEnQ,IAAI,CAAC,cAE5FU,KAAA,QAAAkP,QAAA,eACEpP,IAAA,UAAOmP,SAAS,CAAC,2CAA2C,CAAAC,QAAA,CAAC,yBAAuB,CAAO,CAAC,cAC5FpP,IAAA,UACEmN,IAAI,CAAC,MAAM,CACX+D,QAAQ,MACRC,MAAM,CAAC,yBAAyB,CAChClB,QAAQ,CAAEjF,oBAAqB,CAC/BmE,SAAS,CAAC,wLAAwL,CACnM,CAAC,CAEDxN,QAAQ,CAAC+C,SAAS,EAAI/C,QAAQ,CAAC+C,SAAS,CAACzD,MAAM,CAAG,CAAC,eAClDjB,IAAA,QAAKmP,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC5BzN,QAAQ,CAAC+C,SAAS,CAACgD,GAAG,CAAC,CAACyG,IAAI,CAAE7C,CAAC,QAAA8F,mBAAA,oBAC9BlR,KAAA,QAAaiP,SAAS,CAAC,qDAAqD,CAAAC,QAAA,EACzEjB,IAAI,CAAChB,IAAI,EAAIgB,IAAI,CAAChB,IAAI,CAACkE,UAAU,CAAC,OAAO,CAAC,cACzCrR,IAAA,QAAKsR,GAAG,CAAEC,GAAG,CAACC,eAAe,CAACrD,IAAI,CAAE,CAACsD,GAAG,CAAEtD,IAAI,CAAC5D,IAAK,CAAC4E,SAAS,CAAC,gCAAgC,CAAE,CAAC,cAElGnP,IAAA,SAAMmP,SAAS,CAAC,wFAAwF,CAAAC,QAAA,CAAC,KAAG,CAAM,CACnH,cACDpP,IAAA,SAAMmP,SAAS,CAAC,sCAAsC,CAAAC,QAAA,CAAEjB,IAAI,CAAC5D,IAAI,CAAO,CAAC,cACzEvK,IAAA,UACEmN,IAAI,CAAC,MAAM,CACX1G,KAAK,CAAE,EAAA2K,mBAAA,CAAAxL,aAAa,CAACkG,IAAI,CAACH,GAAG,EAAIA,GAAG,CAACJ,SAAS,GAAKD,CAAC,CAAC,UAAA8F,mBAAA,iBAA9CA,mBAAA,CAAgD5F,IAAI,GAAI,EAAG,CAClEyE,QAAQ,CAAEhF,CAAC,EAAIW,wBAAwB,CAACN,CAAC,CAAEL,CAAC,CAACG,MAAM,CAAC3E,KAAK,CAAE,CAC3D2J,WAAW,CAAC,uBAAuB,CACnCjB,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACFnP,IAAA,WACEmN,IAAI,CAAC,QAAQ,CACbgC,SAAS,CAAC,6DAA6D,CACvEoB,OAAO,CAAEA,CAAA,GAAM9E,oBAAoB,CAACH,CAAC,CAAE,CAAA8D,QAAA,CACxC,QAED,CAAQ,CAAC,GApBD9D,CAqBL,CAAC,EACP,CAAC,CACC,CACN,EACE,CAAC,EACH,CAAC,EACH,CAAC,cACNtL,IAAA,QAAAoP,QAAA,CACGO,eAAe,CAAC,eAAe,CAAE,cAAc,CAAE,UAAU,CAAE,IAAI,CAAE,KAAK,CAAEnQ,IAAI,CAAC,CAC7E,CAAC,EACH,CAAC,EACH,CAAC,cAENU,KAAA,QAAKiP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCpP,IAAA,CAACR,IAAI,EAAC2P,SAAS,CAAC,sCAAsC,CAAE,CAAC,cACzDnP,IAAA,OAAImP,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,4BAA0B,CAAI,CAAC,cACnFpP,IAAA,MAAGmP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,yDAAuD,CAAG,CAAC,EACrF,CACN,CAEH,QACE,MAAO,KAAI,CACf,CACF,CAAC,CAED;AACA,KAAM,CAAAsC,aAAa,CAAGA,CAAA,GAAM,CAC1B,GAAI,CAAAC,KAAK,CAAG,CAAC,CAAE;AACf,GAAIxI,cAAc,CAACL,cAAc,CAAE6I,KAAK,EAAE,CAC1C,GAAIxI,cAAc,CAACH,cAAc,CAAE2I,KAAK,EAAE,CAC1C,GAAIxI,cAAc,CAACF,iBAAiB,CAAE0I,KAAK,EAAE,CAC7C,MAAO,CAAAA,KAAK,CACd,CAAC,CAED,KAAM,CAAAtC,UAAU,CAAGqC,aAAa,CAAC,CAAC,CAElC;AACA,KAAM,CAAAE,cAAc,CAAG,CACrB,CAAEnL,KAAK,CAAE,mBAAmB,CAAE+B,KAAK,CAAE,mBAAoB,CAAC,CAC1D,CAAE/B,KAAK,CAAE,kBAAkB,CAAE+B,KAAK,CAAE,kBAAmB,CAAC,CACxD,CAAE/B,KAAK,CAAE,kBAAkB,CAAE+B,KAAK,CAAE,kBAAmB,CAAC,CACxD,CAAE/B,KAAK,CAAE,iBAAiB,CAAE+B,KAAK,CAAE,iBAAkB,CAAC,CACtD,CAAE/B,KAAK,CAAE,gBAAgB,CAAE+B,KAAK,CAAE,gBAAiB,CAAC,CACpD,CAAE/B,KAAK,CAAE,eAAe,CAAE+B,KAAK,CAAE,eAAgB,CAAC,CACnD,CAED,KAAM,CAAAqJ,eAAe,CAAG,CACtB,iBAAiB,CAAE,mBAAmB,CACtC,eAAe,CAAE,kBAAkB,CACnC,SAAS,CAAE,kBAAkB,CAC7B,YAAY,CAAE,eAChB,CAAC,CAED;AACA,KAAM,CAAAC,cAAc,CAAG,CACrB,mBAAmB,CACnB,kBAAkB,CAClB,kBAAkB,CAClB,iBAAiB,CACjB,gBAAgB,CAChB,eAAe,CAChB,CAED,mBACE5R,KAAA,QAAKiP,SAAS,CAAC,oEAAoE,CAAAC,QAAA,eAEjFlP,KAAA,QAAKiP,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAChEpP,IAAA,QAAKmP,SAAS,CAAC,wFAAwF,CAAM,CAAC,cAC9GnP,IAAA,QAAKmP,SAAS,CAAC,uGAAuG,CAAM,CAAC,EAC1H,CAAC,cAGNnP,IAAA,WAAQmP,SAAS,CAAC,gEAAgE,CAAAC,QAAA,cAChFpP,IAAA,QAAKmP,SAAS,CAAC,6BAA6B,CAAAC,QAAA,cAC1ClP,KAAA,QAAKiP,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAChDlP,KAAA,QAAKiP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCpP,IAAA,WACEuQ,OAAO,CAAEA,CAAA,GAAMvB,MAAM,CAAC+C,OAAO,CAACC,IAAI,CAAC,CAAE,CACrC7C,SAAS,CAAC,4FAA4F,CAAAC,QAAA,cAEtGpP,IAAA,CAACtB,SAAS,EAACyQ,SAAS,CAAC,oBAAoB,CAAE,CAAC,CACtC,CAAC,cACTjP,KAAA,QAAKiP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCpP,IAAA,QAAKmP,SAAS,CAAC,6FAA6F,CAAAC,QAAA,cAC1GpP,IAAA,CAACP,IAAI,EAAC0P,SAAS,CAAC,oBAAoB,CAAE,CAAC,CACpC,CAAC,cACNjP,KAAA,QAAAkP,QAAA,eACEpP,IAAA,OAAImP,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAC,gBAAc,CAAI,CAAC,cAChEpP,IAAA,MAAGmP,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,2BAAyB,CAAG,CAAC,EAC/D,CAAC,EACH,CAAC,EACH,CAAC,cAENlP,KAAA,QAAKiP,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1ClP,KAAA,WACEqQ,OAAO,CAAEA,CAAA,GAAM5D,UAAU,CAAC,IAAI,CAAE,CAChCsF,QAAQ,CAAEzM,MAAO,CACjB2J,SAAS,CAAC,8IAA8I,CAAAC,QAAA,EAEvJ5J,MAAM,cAAGxF,IAAA,CAAClB,OAAO,EAACqQ,SAAS,CAAC,2BAA2B,CAAE,CAAC,cAAGnP,IAAA,CAACrB,IAAI,EAACwQ,SAAS,CAAC,cAAc,CAAE,CAAC,CAAC,YAElG,EAAQ,CAAC,cAETjP,KAAA,WACEqQ,OAAO,CAAEA,CAAA,GAAM5D,UAAU,CAAC,KAAK,CAAE,CACjCsF,QAAQ,CAAEzM,MAAO,CACjB2J,SAAS,CAAC,oLAAoL,CAAAC,QAAA,EAE7L5J,MAAM,cAAGxF,IAAA,CAAClB,OAAO,EAACqQ,SAAS,CAAC,2BAA2B,CAAE,CAAC,cAAGnP,IAAA,CAACnB,WAAW,EAACsQ,SAAS,CAAC,cAAc,CAAE,CAAC,CAAC,aAEzG,EAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CAAC,CACA,CAAC,cAETjP,KAAA,QAAKiP,SAAS,CAAC,sCAAsC,CAAAC,QAAA,EAElDF,mBAAmB,CAAC,CAAC,cAGtBhP,KAAA,QAAKiP,SAAS,CAAC,oEAAoE,CAAAC,QAAA,eACjFlP,KAAA,QAAKiP,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBlP,KAAA,OAAIiP,SAAS,CAAC,oCAAoC,CAAAC,QAAA,EAC/C1J,WAAW,GAAK,CAAC,EAAI,iCAAiC,CACtDA,WAAW,GAAK,CAAC,EAAI,oBAAoB,CACzCA,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAI,uBAAuB,CAC7EpD,WAAW,GAAK,CAAC,EAAI,CAACyD,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EAAI,oBAAoB,CAC5GtD,WAAW,GAAK,CAAC,EAAI,CAACyD,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAiB,EAAI,uBAAuB,CACpJvD,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EAAI,oBAAoB,CAC3GtD,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAiB,EAAI,uBAAuB,CACnJvD,WAAW,GAAK,CAAC,EAAI,uBAAuB,EAC3C,CAAC,cACLxF,KAAA,MAAGiP,SAAS,CAAC,eAAe,CAAAC,QAAA,EACzB1J,WAAW,GAAK,CAAC,EAAI,0DAA0D,CAC/EA,WAAW,GAAK,CAAC,EAAI,4CAA4C,CACjEA,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAI,iCAAiC,CACvFpD,WAAW,GAAK,CAAC,EAAI,CAACyD,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EAAI,gCAAgC,CACxHtD,WAAW,GAAK,CAAC,EAAI,CAACyD,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAiB,EAAI,sCAAsC,CACnKvD,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAIK,cAAc,CAACH,cAAc,EAAI,gCAAgC,CACvHtD,WAAW,GAAK,CAAC,EAAIyD,cAAc,CAACL,cAAc,EAAI,CAACK,cAAc,CAACH,cAAc,EAAIG,cAAc,CAACF,iBAAiB,EAAI,sCAAsC,CAClKvD,WAAW,GAAK,CAAC,EAAI,sCAAsC,EAC3D,CAAC,EACD,CAAC,CAELsL,UAAU,CAAC,CAAC,cAGb9Q,KAAA,QAAKiP,SAAS,CAAC,sEAAsE,CAAAC,QAAA,eACnFlP,KAAA,WACEqQ,OAAO,CAAEA,CAAA,GAAM5K,cAAc,CAACuM,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEzM,WAAW,CAAG,CAAC,CAAC,CAAE,CAC5DuM,QAAQ,CAAEvM,WAAW,GAAK,CAAE,CAC5ByJ,SAAS,CAAC,8HAA8H,CAAAC,QAAA,eAExIpP,IAAA,CAACtB,SAAS,EAACyQ,SAAS,CAAC,cAAc,CAAE,CAAC,WAExC,EAAQ,CAAC,cAETjP,KAAA,QAAKiP,SAAS,CAAC,6BAA6B,CAAAC,QAAA,EACzC1J,WAAW,GAAK2J,UAAU,EAAI1N,QAAQ,CAACwC,kBAAkB,eACxDjE,KAAA,WACEqQ,OAAO,CAAE1B,wBAAyB,CAClCM,SAAS,CAAC,uGAAuG,CAAAC,QAAA,eAEjHpP,IAAA,CAACpB,IAAI,EAACuQ,SAAS,CAAC,cAAc,CAAE,CAAC,wBAEnC,EAAQ,CACT,CAEAzJ,WAAW,CAAG2J,UAAU,cACvBnP,KAAA,WACEqQ,OAAO,CAAEA,CAAA,GAAM5K,cAAc,CAACuM,IAAI,CAACE,GAAG,CAAC/C,UAAU,CAAE3J,WAAW,CAAG,CAAC,CAAC,CAAE,CACrEyJ,SAAS,CAAC,sJAAsJ,CAAAC,QAAA,EACjK,MAEC,cAAApP,IAAA,CAACtB,SAAS,EAACyQ,SAAS,CAAC,yBAAyB,CAAE,CAAC,EAC3C,CAAC,cAETjP,KAAA,WACEqQ,OAAO,CAAEA,CAAA,GAAM5D,UAAU,CAAC,KAAK,CAAE,CACjCsF,QAAQ,CAAEzM,MAAO,CACjB2J,SAAS,CAAC,kLAAkL,CAAAC,QAAA,EAE3L5J,MAAM,cAAGxF,IAAA,CAAClB,OAAO,EAACqQ,SAAS,CAAC,2BAA2B,CAAE,CAAC,cAAGnP,IAAA,CAACnB,WAAW,EAACsQ,SAAS,CAAC,cAAc,CAAE,CAAC,CAAC,aAEzG,EAAQ,CACT,EACE,CAAC,EACH,CAAC,EACH,CAAC,CAGLvK,WAAW,eACV1E,KAAA,QAAKiP,SAAS,CAAC,gGAAgG,CAAAC,QAAA,eAC7GpP,IAAA,CAAClB,OAAO,EAACqQ,SAAS,CAAC,2BAA2B,CAAE,CAAC,kBAEnD,EAAK,CACN,CAEArK,UAAU,eACT5E,KAAA,QAAKiP,SAAS,CAAC,iGAAiG,CAAAC,QAAA,eAC9GpP,IAAA,CAACnB,WAAW,EAACsQ,SAAS,CAAC,cAAc,CAAE,CAAC,4BAE1C,EAAK,CACN,EACE,CAAC,cACNnP,IAAA,CAACH,cAAc,GAAE,CAAC,EACf,CAAC,CAEV,CAAC,CAED,cAAe,CAAAQ,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}