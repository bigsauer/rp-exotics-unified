{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate,useLocation}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PDFViewer=()=>{var _location$state;const{fileName}=useParams();const navigate=useNavigate();const location=useLocation();const[pdfUrl,setPdfUrl]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Use the viewUrl from navigation state if available, otherwise fallback to the old method\nconst viewUrl=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.viewUrl)||`/api/documents/download/${encodeURIComponent(fileName||'document')}`;const documentTitle=fileName||'Document';useEffect(()=>{console.log('[PDFViewer] Component mounted');console.log('[PDFViewer] fileName:',fileName);console.log('[PDFViewer] location.state:',location.state);console.log('[PDFViewer] viewUrl:',viewUrl);const loadPDF=async()=>{try{setLoading(true);console.log('[PDFViewer] Fetching PDF from:',viewUrl);const response=await fetch(viewUrl,{credentials:'include',headers:{'Authorization':`Bearer ${localStorage.getItem('token')||''}`}});if(!response.ok){throw new Error(`Failed to load PDF: ${response.status} ${response.statusText}`);}const blob=await response.blob();const dataUrl=URL.createObjectURL(blob);console.log('[PDFViewer] PDF loaded successfully, data URL created');setPdfUrl(dataUrl);setError(null);}catch(err){console.error('[PDFViewer] Error loading PDF:',err);setError(err.message);}finally{setLoading(false);}};loadPDF();},[viewUrl]);const handleIframeError=()=>{console.error('[PDFViewer] Iframe failed to load:',pdfUrl);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-white text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading PDF...\"})]})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-red-400 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Error loading PDF: \",error]}),/*#__PURE__*/_jsx(\"button\",{className:\"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\",onClick:()=>navigate(-1),children:\"Go Back\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"mb-6 flex items-center text-blue-400 hover:text-blue-300 font-medium self-start\",onClick:()=>navigate(-1),children:[/*#__PURE__*/_jsx(\"svg\",{className:\"h-5 w-5 mr-2\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",d:\"M15 19l-7-7 7-7\"})}),\"Back\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full max-w-5xl h-[80vh] bg-white rounded-2xl shadow-2xl overflow-hidden flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"iframe\",{src:pdfUrl,title:documentTitle,className:\"w-full h-full border-0\",onError:handleIframeError})})]});};export default PDFViewer;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","PDFViewer","_location$state","fileName","navigate","location","pdfUrl","setPdfUrl","loading","setLoading","error","setError","viewUrl","state","encodeURIComponent","documentTitle","console","log","loadPDF","response","fetch","credentials","headers","localStorage","getItem","ok","Error","status","statusText","blob","dataUrl","URL","createObjectURL","err","message","handleIframeError","className","children","onClick","fill","stroke","strokeWidth","viewBox","strokeLinecap","strokeLinejoin","d","src","title","onError"],"sources":["/Users/bsauer02/Desktop/Opis3.0/rp-exotics-unified/frontend/src/components/PDFViewer.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate, useLocation } from 'react-router-dom';\n\nconst PDFViewer = () => {\n  const { fileName } = useParams();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [pdfUrl, setPdfUrl] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  // Use the viewUrl from navigation state if available, otherwise fallback to the old method\n  const viewUrl = location.state?.viewUrl || `/api/documents/download/${encodeURIComponent(fileName || 'document')}`;\n  const documentTitle = fileName || 'Document';\n\n  useEffect(() => {\n    console.log('[PDFViewer] Component mounted');\n    console.log('[PDFViewer] fileName:', fileName);\n    console.log('[PDFViewer] location.state:', location.state);\n    console.log('[PDFViewer] viewUrl:', viewUrl);\n\n    const loadPDF = async () => {\n      try {\n        setLoading(true);\n        console.log('[PDFViewer] Fetching PDF from:', viewUrl);\n        \n        const response = await fetch(viewUrl, { \n          credentials: 'include',\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token') || ''}`\n          }\n        });\n        \n        if (!response.ok) {\n          throw new Error(`Failed to load PDF: ${response.status} ${response.statusText}`);\n        }\n        \n        const blob = await response.blob();\n        const dataUrl = URL.createObjectURL(blob);\n        console.log('[PDFViewer] PDF loaded successfully, data URL created');\n        setPdfUrl(dataUrl);\n        setError(null);\n      } catch (err) {\n        console.error('[PDFViewer] Error loading PDF:', err);\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadPDF();\n  }, [viewUrl]);\n\n  const handleIframeError = () => {\n    console.error('[PDFViewer] Iframe failed to load:', pdfUrl);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"></div>\n          <p>Loading PDF...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\">\n        <div className=\"text-red-400 text-center\">\n          <p>Error loading PDF: {error}</p>\n          <button \n            className=\"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\"\n            onClick={() => navigate(-1)}\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex flex-col items-center justify-center p-8\">\n      <button\n        className=\"mb-6 flex items-center text-blue-400 hover:text-blue-300 font-medium self-start\"\n        onClick={() => navigate(-1)}\n      >\n        <svg className=\"h-5 w-5 mr-2\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" /></svg>\n        Back\n      </button>\n      <div className=\"w-full max-w-5xl h-[80vh] bg-white rounded-2xl shadow-2xl overflow-hidden flex items-center justify-center\">\n        <iframe\n          src={pdfUrl}\n          title={documentTitle}\n          className=\"w-full h-full border-0\"\n          onError={handleIframeError}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default PDFViewer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}