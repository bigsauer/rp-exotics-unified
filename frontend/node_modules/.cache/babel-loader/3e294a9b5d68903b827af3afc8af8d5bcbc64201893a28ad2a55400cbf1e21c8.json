{"ast":null,"code":"var _jsxFileName = \"/Users/bsauer02/Desktop/Opis3.0/rp-exotics-unified/frontend/src/components/NewDealEntry.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Car, ArrowLeft, Save, Send, CheckCircle, Loader2, Calendar, DollarSign, User, MapPin, Phone, Mail, Hash, Palette, Gauge, Info, Plus, AlertCircle } from 'lucide-react';\nimport { useAuth } from './AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst NewDealEntry = () => {\n  _s();\n  const {\n    user: currentUser,\n    getAuthHeaders\n  } = useAuth();\n  const navigate = useNavigate();\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n    }\n  }, [currentUser, navigate]);\n\n  // Utility to get backend API URL\n  const API_BASE = 'http://localhost:5001';\n\n  // Utility to merge auth headers\n  const buildHeaders = (extra = {}) => {\n    const headers = {\n      ...getAuthHeaders(),\n      'Content-Type': 'application/json',\n      ...extra\n    };\n    // Debug: log token presence\n    if (!headers['Authorization']) {\n      console.warn('[DEAL SUBMIT] No Authorization token in headers!');\n    } else {\n      console.log('[DEAL SUBMIT] Using Authorization header:', headers['Authorization']);\n    }\n    return headers;\n  };\n  const [formData, setFormData] = useState({\n    // Vehicle Information\n    vin: '',\n    year: '',\n    make: '',\n    model: '',\n    mileage: '',\n    exteriorColor: '',\n    interiorColor: '',\n    // Deal Information\n    dealType: '',\n    dealType2SubType: '',\n    // <-- Add this for Deal Type 2 sub-options\n    fundingSource: '',\n    purchaseDate: '',\n    paymentMethod: 'check',\n    // Default to 'check'\n    currentStage: 'initial-contact',\n    // Financial Information\n    purchasePrice: '',\n    listPrice: '',\n    killPrice: '',\n    wholesalePrice: '',\n    commissionRate: '',\n    brokerageFee: '',\n    brokeerageFeePaidTo: '',\n    payoffBalance: '',\n    amountDueToCustomer: '',\n    amountDueToRP: '',\n    // Seller Information\n    sellerName: '',\n    sellerCompany: '',\n    sellerAddress: '',\n    sellerPhone: '',\n    sellerEmail: '',\n    sellerLicenseNumber: '',\n    sellerTier: 'Tier 1',\n    // RP Information\n    rpStockNumber: '',\n    vehicleDescription: '',\n    generalNotes: '',\n    // Documentation\n    contractRequired: false,\n    titlePresent: false,\n    driverLicensePresent: false,\n    odometerPresent: false,\n    dealerLicensePresent: false,\n    documents: [],\n    // For uploaded files\n    salesperson: ''\n  });\n  const [vinDecoding, setVinDecoding] = useState(false);\n  const [vinDecoded, setVinDecoded] = useState(false);\n  const [dealerSuggestions, setDealerSuggestions] = useState([]);\n  const [dealerBuyerSuggestions, setDealerBuyerSuggestions] = useState([]); // For Dealer Info (Buyer)\n  const [dealerSearch, setDealerSearch] = useState('');\n  const [formErrors, setFormErrors] = useState({});\n  const [saving, setSaving] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  // Remove documentTypes and documentTypeSelections state\n  // Add notes state for each file\n  const [documentNotes, setDocumentNotes] = useState([]); // Array of {fileIndex, note}\n\n  useEffect(() => {\n    // Fetch document types from backend\n    fetch(`${API_BASE}/api/backoffice/document-types`, {\n      credentials: 'include'\n    }).then(res => res.json()).then(data => {\n      if (data.success && Array.isArray(data.data)) {\n        // setDocumentTypes(data.data); // This line is removed\n      }\n    }).catch(() => {\n      // setDocumentTypes([]); // This line is removed\n    });\n  }, []);\n\n  // Helper function to format currency input\n  const formatCurrency = value => {\n    if (!value) return '';\n    // Remove all non-numeric characters except decimal point\n    const numericValue = value.toString().replace(/[^\\d.]/g, '');\n    // Ensure only one decimal point\n    const parts = numericValue.split('.');\n    if (parts.length > 2) {\n      return parts[0] + '.' + parts.slice(1).join('');\n    }\n    return numericValue;\n  };\n\n  // Add a helper to join address parts into a single line\n  function joinAddress(address) {\n    if (!address) return '';\n    const {\n      street,\n      city,\n      state,\n      zip\n    } = address;\n    return [street, city, state, zip].filter(Boolean).join(', ');\n  }\n  // Add a helper to parse a single line address into parts\n  function parseAddress(full) {\n    if (!full) return {\n      street: '',\n      city: '',\n      state: '',\n      zip: ''\n    };\n    const parts = full.split(',').map(s => s.trim());\n    return {\n      street: parts[0] || '',\n      city: parts[1] || '',\n      state: parts[2] || '',\n      zip: parts[3] || ''\n    };\n  }\n\n  // Get dynamic labels based on deal type\n  const getDynamicLabels = () => {\n    const dealType2 = formData.dealType2SubType;\n    const isRetailPP = formData.dealType === 'retail-pp';\n    return {\n      purchasePriceLabel: dealType2 === 'sale' ? 'Sale Price' : 'Purchase Price',\n      sellerLabel: dealType2 === 'sale' ? 'Sold To' : 'Purchased From',\n      sellerSectionTitle: dealType2 === 'sale' ? 'Buyer Information' : 'Seller Information',\n      // For retail PP deals, use more generic labels\n      companyLabel: isRetailPP ? 'Company (if applicable)' : 'Company/Dealer',\n      licenseLabel: isRetailPP ? 'License Number (if applicable)' : 'Dealer License Number',\n      addressLabel: isRetailPP ? 'Address' : 'Seller Address'\n    };\n  };\n  const dynamicLabels = getDynamicLabels();\n\n  // Remove Deal Type 2 from main dealTypes\n  const dealTypes = [{\n    value: 'wholesale-d2d',\n    label: 'Wholesale - D2D'\n  }, {\n    value: 'wholesale-private',\n    label: 'Wholesale - Private Party'\n  }, {\n    value: 'wholesale-flip',\n    label: 'Wholesale - Flip'\n  }, {\n    value: 'retail-pp',\n    label: 'Retail - PP'\n  }, {\n    value: 'retail-auction',\n    label: 'Retail - Auction'\n  }, {\n    value: 'retail-dtod',\n    label: 'Retail - DtoD'\n  }, {\n    value: 'auction',\n    label: 'Auction'\n  }];\n  const fundingSources = [{\n    value: 'flpn-retail',\n    label: 'FLPN - Retail'\n  }, {\n    value: 'flpn-wholesale',\n    label: 'FLPN - Wholesale'\n  }, {\n    value: 'cash',\n    label: 'Cash'\n  }, {\n    value: 'flooring-line',\n    label: 'Flooring Line'\n  }, {\n    value: 'consignment',\n    label: 'Consignment'\n  }];\n  const paymentMethods = [{\n    value: 'check',\n    label: 'Check'\n  }, {\n    value: 'wire',\n    label: 'Wire Transfer'\n  }, {\n    value: 'ach',\n    label: 'ACH'\n  }, {\n    value: 'cash',\n    label: 'Cash'\n  }, {\n    value: 'financed',\n    label: 'Financed'\n  }];\n  const dealType2SubOptions = [{\n    value: 'buy',\n    label: 'Buy'\n  }, {\n    value: 'sale',\n    label: 'Sale'\n  }, {\n    value: 'buy-sell',\n    label: 'Buy/Sell'\n  }, {\n    value: 'consign-a',\n    label: 'Consign-A'\n  }, {\n    value: 'consign-b',\n    label: 'Consign-B'\n  }, {\n    value: 'consign-c',\n    label: 'Consign-C'\n  }, {\n    value: 'consign-rdnc',\n    label: 'Consign-RDNC'\n  }];\n\n  // Add to formData initial state\n  // This block is removed as per the edit hint.\n\n  // Add salesperson options\n  const salespersonOptions = [{\n    value: 'Brennan S',\n    label: 'Brennan S'\n  }, {\n    value: 'Parker G',\n    label: 'Parker G'\n  }, {\n    value: 'Dan M',\n    label: 'Dan M'\n  }, {\n    value: 'Adiana P',\n    label: 'Adiana P'\n  }, {\n    value: 'Brett M',\n    label: 'Brett M'\n  }, {\n    value: 'Other',\n    label: 'Other'\n  }];\n\n  // Get deal type specific fields\n  const getDealTypeFields = () => {\n    // Both dealType and dealType2SubType are always required\n    const dealType = formData.dealType;\n    return {\n      showFinancials: ['wholesale-d2d', 'wholesale-private', 'wholesale-flip', 'retail-pp', 'retail-auction', 'retail-dtod', 'auction'].includes(dealType),\n      showSellerInfo: true,\n      showDocumentation: ['wholesale-d2d', 'wholesale-private', 'wholesale-flip', 'retail-pp', 'retail-auction', 'retail-dtod', 'auction'].includes(dealType),\n      requiredFields: ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName']\n    };\n  };\n  const dealTypeFields = getDealTypeFields();\n\n  // Real VIN decode function using backend API\n  const decodeVIN = async vin => {\n    setVinDecoding(true);\n    try {\n      const response = await fetch(`${API_BASE}/api/deals/vin/decode`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          vin\n        }),\n        credentials: 'include'\n      });\n      const data = await response.json();\n      if (data.success && data.data) {\n        setFormData(prev => ({\n          ...prev,\n          year: data.data.year || '',\n          make: data.data.make || '',\n          model: data.data.model || ''\n        }));\n        setVinDecoded(true);\n        setTimeout(() => setVinDecoded(false), 3000);\n      } else {\n        console.error('VIN decode failed:', data.error);\n        alert(data.error || 'Unable to decode VIN. Please check the VIN and try again.');\n      }\n    } catch (error) {\n      console.error('VIN decode error:', error);\n      alert('VIN decode service temporarily unavailable. Please try again later.');\n    } finally {\n      setVinDecoding(false);\n    }\n  };\n\n  // Real dealer search using backend API\n  const searchDealers = async query => {\n    if (query.length < 2) {\n      setDealerSuggestions([]);\n      return;\n    }\n    // setSearchingDealers(true); // Removed unused state\n    try {\n      const response = await fetch(`${API_BASE}/api/dealers/search?q=${encodeURIComponent(query)}`, {\n        credentials: 'include'\n      });\n      const data = await response.json();\n      setDealerSuggestions(data.dealers || []);\n      console.log('[DEALER SEARCH] Suggestions:', data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerSuggestions([]);\n    }\n  };\n\n  // Dealer search for Dealer Info (Buyer)\n  const searchDealersBuyer = async query => {\n    if (query.length < 2) {\n      setDealerBuyerSuggestions([]);\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/api/dealers/search?q=${encodeURIComponent(query)}`, {\n        credentials: 'include'\n      });\n      const data = await response.json();\n      setDealerBuyerSuggestions(data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerBuyerSuggestions([]);\n    }\n  };\n\n  // Autofill dealer info when a suggestion is selected\n  const handleDealerSuggestionClick = dealer => {\n    setFormData(prev => ({\n      ...prev,\n      sellerName: dealer.name || '',\n      sellerCompany: dealer.company || '',\n      sellerAddress: dealer.addressString || '',\n      sellerPhone: dealer.phone || '',\n      sellerEmail: dealer.email || '',\n      sellerLicenseNumber: dealer.licenseNumber || '',\n      sellerTier: dealer.tier || 'Tier 1'\n    }));\n    setDealerSuggestions([]);\n    setDealerSearch('');\n    console.log('[DEALER AUTOFILL] Selected dealer:', dealer);\n    console.log('[DEALER AUTOFILL] Autofilled address:', dealer.addressString);\n    console.log('[DEALER AUTOFILL] Autofilled license number:', dealer.licenseNumber);\n  };\n\n  // Auto-generate stock number\n  // useEffect(() => {\n  //   if (!formData.rpStockNumber && formData.year && formData.make) {\n  //     const year = new Date().getFullYear();\n  //     const stockNumber = `RP${year}${String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0')}`;\n  //     setFormData(prev => ({ ...prev, rpStockNumber: stockNumber }));\n  //   }\n  // }, [formData.year, formData.make, formData.rpStockNumber]);\n\n  const handleInputChange = (field, value) => {\n    let processedValue = value;\n\n    // Handle currency formatting for financial fields\n    if (['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field)) {\n      processedValue = formatCurrency(value);\n    }\n\n    // If changing dealType, reset dealType2SubType unless still deal-type-2\n    if (field === 'dealType') {\n      setFormData(prev => ({\n        ...prev,\n        dealType: processedValue,\n        dealType2SubType: processedValue === 'deal-type-2' ? prev.dealType2SubType : ''\n      }));\n      if (currentStep > 1) setCurrentStep(1);\n      return;\n    }\n    setFormData(prev => ({\n      ...prev,\n      [field]: processedValue\n    }));\n\n    // Clear error when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({\n        ...prev,\n        [field]: null\n      }));\n    }\n\n    // Trigger VIN decode when VIN is 17 characters\n    if (field === 'vin' && processedValue.length === 17 && !vinDecoded) {\n      decodeVIN(processedValue);\n    }\n\n    // Search dealers when typing in seller field\n    if (field === 'sellerName') {\n      searchDealers(processedValue);\n    }\n\n    // Reset to step 1 when deal type changes\n    if (field === 'dealType' && currentStep > 1) {\n      setCurrentStep(1);\n    }\n  };\n\n  // Handle file uploads for documentation\n  const handleDocumentUpload = e => {\n    const files = Array.from(e.target.files);\n    setFormData(prev => ({\n      ...prev,\n      documents: [...(prev.documents || []), ...files]\n    }));\n    setDocumentNotes(prev => [...prev, ...files.map((_, i) => ({\n      fileIndex: prev.length + i,\n      note: ''\n    }))]);\n  };\n  const handleRemoveDocument = index => {\n    setFormData(prev => ({\n      ...prev,\n      documents: prev.documents.filter((_, i) => i !== index)\n    }));\n    setDocumentNotes(prev => prev.filter(sel => sel.fileIndex !== index).map(sel => ({\n      ...sel,\n      fileIndex: sel.fileIndex > index ? sel.fileIndex - 1 : sel.fileIndex\n    })));\n  };\n  const handleDocumentNoteChange = (fileIndex, note) => {\n    setDocumentNotes(prev => {\n      const found = prev.find(sel => sel.fileIndex === fileIndex);\n      if (found) {\n        return prev.map(sel => sel.fileIndex === fileIndex ? {\n          ...sel,\n          note\n        } : sel);\n      } else {\n        return [...prev, {\n          fileIndex,\n          note\n        }];\n      }\n    });\n  };\n\n  // When a dealer is selected, autofill full address and license number\n  const handleDealerSuggestionSelect = dealer => {\n    setFormData(prev => {\n      const updated = {\n        ...prev,\n        sellerName: dealer.name || '',\n        sellerCompany: dealer.company || '',\n        sellerPhone: dealer.phone || '',\n        sellerEmail: dealer.email || '',\n        sellerAddress: dealer.addressString || '',\n        sellerLicenseNumber: dealer.licenseNumber || '',\n        sellerTier: dealer.tier || 'Tier 1'\n      };\n      return updated;\n    });\n  };\n  const validateForm = () => {\n    const errors = {};\n    const requiredFields = dealTypeFields.requiredFields || ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName'];\n    requiredFields.forEach(field => {\n      if (!formData[field] || formData[field].toString().trim() === '') {\n        errors[field] = `${field.charAt(0).toUpperCase() + field.slice(1)} is required`;\n      }\n    });\n\n    // Additional validation for specific fields\n    if (formData.vin && formData.vin.length !== 17) {\n      errors.vin = 'VIN must be exactly 17 characters';\n    }\n    if (formData.year && (formData.year < 1900 || formData.year > new Date().getFullYear() + 1)) {\n      errors.year = 'Please enter a valid year';\n    }\n    if (formData.mileage && formData.mileage < 0) {\n      errors.mileage = 'Mileage cannot be negative';\n    }\n    if (dealTypeFields.showFinancials && formData.purchasePrice && formData.purchasePrice <= 0) {\n      errors.purchasePrice = 'Purchase price must be greater than 0';\n    }\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n  const handleSave = async (isDraft = false) => {\n    if (!currentUser) {\n      alert('You must be logged in to submit a deal.');\n      navigate('/login');\n      return;\n    }\n    if (!isDraft && !validateForm()) {\n      console.log('[DEAL SUBMIT] Validation errors:', formErrors);\n      return;\n    }\n    setSaving(true);\n    try {\n      // Debug: log formData before building dealData\n      console.log('[DEAL SUBMIT] formData:', formData);\n      // First, create the deal in the backend\n      const dealData = {\n        vehicle: `${formData.year} ${formData.make} ${formData.model}`,\n        vin: formData.vin,\n        year: parseInt(formData.year),\n        make: formData.make,\n        model: formData.model,\n        rpStockNumber: formData.rpStockNumber,\n        color: formData.exteriorColor,\n        exteriorColor: formData.exteriorColor,\n        // Add this field\n        interiorColor: formData.interiorColor,\n        // Add this field\n        mileage: parseInt(formData.mileage) || 0,\n        purchasePrice: parseFloat(formData.purchasePrice) || 0,\n        listPrice: parseFloat(formData.listPrice) || 0,\n        killPrice: parseFloat(formData.killPrice) || 0,\n        dealType: formData.dealType.includes('retail') ? 'retail' : 'wholesale',\n        dealType2SubType: formData.dealType2SubType,\n        // <-- Ensure this is sent\n        seller: {\n          name: formData.sellerName,\n          type: formData.dealType.includes('private') ? 'private' : 'dealer',\n          contact: {\n            address: parseAddress(formData.sellerAddress),\n            // Use parsed address\n            phone: formData.sellerPhone,\n            email: formData.sellerEmail\n          },\n          licenseNumber: formData.sellerLicenseNumber,\n          tier: formData.sellerTier\n        },\n        fundingSource: formData.fundingSource,\n        paymentMethod: formData.paymentMethod,\n        purchaseDate: formData.purchaseDate ? new Date(formData.purchaseDate) : new Date(),\n        currentStage: 'documentation',\n        salesperson: currentUser.name || 'Unknown' // Use current user's name as salesperson\n      };\n      // Debug: log dealData before sending\n      console.log('[DEAL SUBMIT] dealData to backend:', dealData);\n      // Create deal (this would be your existing deal creation endpoint)\n      const dealResponse = await fetch(`${API_BASE}/api/deals`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify(dealData),\n        credentials: 'include'\n      });\n      // Debug: log backend response status\n      console.log('[DEAL SUBMIT] Backend response status:', dealResponse.status);\n      if (!dealResponse.ok) {\n        const err = await dealResponse.json().catch(() => ({}));\n        console.log('[DEAL SUBMIT] Backend error response:', err);\n        throw new Error('Failed to create deal');\n      }\n      const dealResult = await dealResponse.json();\n      const dealId = dealResult.deal._id;\n\n      // Generate document and create vehicle record\n      const documentResponse = await fetch(`${API_BASE}/api/documents/generate/${dealId}`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify({\n          dealType2: formData.dealType2SubType,\n          commissionRate: parseFloat(formData.commissionRate) || 0,\n          stockNumber: formData.rpStockNumber // <-- Add this line\n        }),\n        credentials: 'include' // Ensure cookies/session are sent for authentication\n      });\n      if (!documentResponse.ok) {\n        const err = await documentResponse.json().catch(() => ({}));\n        throw new Error(err.error || 'Failed to generate document');\n      }\n      const documentResult = await documentResponse.json();\n\n      // --- UPLOAD USER DOCUMENTS ---\n      if (formData.documents && formData.documents.length > 0) {\n        for (let i = 0; i < formData.documents.length; i++) {\n          const file = formData.documents[i];\n          const noteObj = documentNotes.find(sel => sel.fileIndex === i);\n          const note = noteObj ? noteObj.note : '';\n          const documentType = 'extra_doc';\n          const form = new FormData();\n          form.append('document', file);\n          if (note) form.append('notes', note);\n          try {\n            const uploadRes = await fetch(`${API_BASE}/api/backoffice/deals/${dealId}/documents/${documentType}/upload`, {\n              method: 'POST',\n              headers: {\n                'Authorization': getAuthHeaders()['Authorization']\n              },\n              body: form,\n              credentials: 'include'\n            });\n            if (!uploadRes.ok) {\n              const err = await uploadRes.json().catch(() => ({}));\n              toast.error(`Failed to upload ${file.name}: ${err.error || uploadRes.statusText}`);\n            } else {\n              toast.success(`Uploaded ${file.name}`);\n            }\n          } catch (err) {\n            toast.error(`Error uploading ${file.name}: ${err.message}`);\n          }\n        }\n      }\n      // --- END UPLOAD USER DOCUMENTS ---\n\n      console.log('Deal created and document generated:', documentResult);\n\n      // Show success message with document info\n      const successMessage = isDraft ? 'Draft saved successfully!' : `Deal submitted successfully!\\n\\nYour deal has been sent to the back office for processing. You will be notified when the deal is complete.`;\n      toast.success(successMessage);\n\n      // Optionally redirect to a success page or clear form\n      if (!isDraft) {\n        // Clear form or redirect\n        setFormData({\n          vin: '',\n          year: '',\n          make: '',\n          model: '',\n          mileage: '',\n          exteriorColor: '',\n          interiorColor: '',\n          dealType: '',\n          dealType2SubType: '',\n          fundingSource: '',\n          purchaseDate: '',\n          paymentMethod: 'check',\n          currentStage: 'initial-contact',\n          purchasePrice: '',\n          listPrice: '',\n          killPrice: '',\n          wholesalePrice: '',\n          commissionRate: '',\n          brokerageFee: '',\n          brokeerageFeePaidTo: '',\n          payoffBalance: '',\n          amountDueToCustomer: '',\n          amountDueToRP: '',\n          sellerName: '',\n          sellerCompany: '',\n          sellerAddress: '',\n          sellerPhone: '',\n          sellerEmail: '',\n          sellerLicenseNumber: '',\n          sellerTier: 'Tier 1',\n          rpStockNumber: '',\n          vehicleDescription: '',\n          generalNotes: '',\n          contractRequired: false,\n          titlePresent: false,\n          driverLicensePresent: false,\n          odometerPresent: false,\n          dealerLicensePresent: false,\n          documents: [],\n          salesperson: ''\n        });\n        setCurrentStep(1);\n      }\n    } catch (error) {\n      if (error.message.includes('401') || error.message.includes('not authorized')) {\n        alert('Session expired or not authorized. Please log in again.');\n        navigate('/login');\n      } else {\n        alert(`Error saving deal: ${error.message}`);\n        console.log('[DEAL SUBMIT] Error:', error);\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n  const handleEmailToListingTeam = () => {\n    const emailBody = `New Vehicle Ready for Listing\n\nVehicle: ${formData.year} ${formData.make} ${formData.model}\nVIN: ${formData.vin}\nStock #: ${formData.rpStockNumber}\nMileage: ${formData.mileage}\nExterior: ${formData.exteriorColor}\nInterior: ${formData.interiorColor}\n\nDescription:\n${formData.vehicleDescription}\n\nPlease prepare listing materials for this vehicle.\n\nBest regards,\n${currentUser.name}`;\n    const mailtoLink = `mailto:listing@rpexotics.com?subject=New Vehicle for Listing - ${formData.year} ${formData.make} ${formData.model}&body=${encodeURIComponent(emailBody)}`;\n    window.open(mailtoLink);\n  };\n\n  // Remove handleCompleteDeal and use handleSave for final submission\n  // Update button text and alerts\n\n  const renderStepIndicator = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mb-8\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: Array.from({\n        length: totalSteps\n      }, (_, index) => {\n        const stepNumber = index + 1;\n        const isActive = currentStep === stepNumber;\n        const isCompleted = currentStep > stepNumber;\n        let stepTitle = '';\n        let stepDescription = '';\n        if (stepNumber === 1) {\n          stepTitle = 'Vehicle & Deal Type';\n          stepDescription = 'Enter vehicle information and select deal type';\n        } else if (stepNumber === 2) {\n          stepTitle = 'Deal Configuration';\n          stepDescription = 'Configure funding, payment, and timeline';\n        } else if (stepNumber === 3 && dealTypeFields.showFinancials) {\n          stepTitle = 'Financial Information';\n          stepDescription = 'Set pricing and financial terms';\n        } else if (stepNumber === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo || stepNumber === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo) {\n          stepTitle = 'Seller Information';\n          stepDescription = 'Add seller contact information';\n        } else if (stepNumber === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation || stepNumber === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation || stepNumber === 5 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation) {\n          stepTitle = 'Documentation & Notes';\n          stepDescription = 'Document status and additional notes';\n        }\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors ${isActive ? 'bg-blue-600 border-blue-600 text-white' : isCompleted ? 'bg-green-600 border-green-600 text-white' : 'bg-white/10 border-white/20 text-gray-400'}`,\n            children: isCompleted ? /*#__PURE__*/_jsxDEV(CheckCircle, {\n              className: \"h-5 w-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 717,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium\",\n              children: stepNumber\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 719,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 709,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ml-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: `text-sm font-medium ${isActive ? 'text-white' : 'text-gray-400'}`,\n              children: stepTitle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 723,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: stepDescription\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 726,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 722,\n            columnNumber: 15\n          }, this), stepNumber < totalSteps && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `w-16 h-0.5 mx-4 ${isCompleted ? 'bg-green-600' : 'bg-white/20'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 729,\n            columnNumber: 17\n          }, this)]\n        }, stepNumber, true, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 678,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 677,\n    columnNumber: 5\n  }, this);\n  const renderFormField = (label, field, type = 'text', options = null, required = false, icon = null, isDealerBuyer = false) => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"flex items-center text-sm font-medium text-gray-300\",\n        children: [icon && /*#__PURE__*/React.createElement(icon, {\n          className: \"h-4 w-4 mr-2\"\n        }), label, required && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-red-400 ml-1\",\n          children: \"*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 744,\n          columnNumber: 24\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 741,\n        columnNumber: 9\n      }, this), type === 'select' ? /*#__PURE__*/_jsxDEV(\"select\", {\n        value: formData[field],\n        onChange: e => handleInputChange(field, e.target.value),\n        className: `w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: [\"Select \", label]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 755,\n          columnNumber: 13\n        }, this), options === null || options === void 0 ? void 0 : options.map(option => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: option.value,\n          className: \"bg-gray-800\",\n          children: option.label\n        }, option.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 757,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 748,\n        columnNumber: 11\n      }, this) : type === 'textarea' ? /*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: formData[field],\n        onChange: e => handleInputChange(field, e.target.value),\n        rows: 4,\n        placeholder: `Enter ${label.toLowerCase()}...`,\n        className: `w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-none ${formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 763,\n        columnNumber: 11\n      }, this) : type === 'checkbox' ? /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"flex items-center space-x-2 cursor-pointer\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: !!formData[field],\n          onChange: e => handleInputChange(field, e.target.checked),\n          className: \"rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 774,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-300\",\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 780,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 773,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm\",\n          children: \"$\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 785,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: type,\n          value: formData[field] || '',\n          onChange: e => {\n            handleInputChange(field, e.target.value);\n            if (isDealerBuyer && field === 'dealerName') searchDealersBuyer(e.target.value);\n            // Only search for sellerName if not a retail deal\n            if (!isDealerBuyer && field === 'sellerName' && !['retail-pp', 'retail-auction', 'retail-dtod'].includes(formData.dealType)) searchDealers(e.target.value);\n          },\n          placeholder: `Enter ${label.toLowerCase()}...`,\n          className: `w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'} ${field === 'vin' ? 'pr-20' : ''} ${['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) ? 'pl-8' : ''}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 13\n        }, this), field === 'vin' && formData.vin.length === 17 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute right-2 top-1/2 transform -translate-y-1/2\",\n          children: vinDecoding ? /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"h-5 w-5 text-blue-400 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 805,\n            columnNumber: 19\n          }, this) : vinDecoded ? /*#__PURE__*/_jsxDEV(CheckCircle, {\n            className: \"h-5 w-5 text-green-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 807,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => decodeVIN(formData.vin),\n            className: \"bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded transition-colors\",\n            children: \"Decode\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 809,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 15\n        }, this), isDealerBuyer && field === 'dealerName' && dealerBuyerSuggestions.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\",\n          children: dealerBuyerSuggestions.map(dealer => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\",\n            onClick: () => {\n              setFormData(prev => {\n                var _dealer$contact;\n                return {\n                  ...prev,\n                  dealerName: dealer.name,\n                  dealerCompany: dealer.company,\n                  dealerPhone: dealer.phone,\n                  dealerEmail: ((_dealer$contact = dealer.contact) === null || _dealer$contact === void 0 ? void 0 : _dealer$contact.email) || dealer.email || '',\n                  dealerAddress: dealer.location || dealer.address || ''\n                };\n              });\n              setDealerBuyerSuggestions([]);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium text-white\",\n              children: dealer.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 838,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-400\",\n              children: [dealer.company, \" \\u2022 \", dealer.location]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 839,\n              columnNumber: 21\n            }, this)]\n          }, dealer.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 823,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 821,\n          columnNumber: 15\n        }, this), !isDealerBuyer && field === 'sellerName' && !['retail-pp', 'retail-auction', 'retail-dtod'].includes(formData.dealType) && dealerSuggestions.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\",\n          children: dealerSuggestions.map(dealer => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\",\n            onClick: () => {\n              handleDealerSuggestionSelect(dealer);\n              setDealerSuggestions([]);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium text-white\",\n              children: dealer.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 856,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-400\",\n              children: [dealer.company, \" \\u2022 \", dealer.location]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 857,\n              columnNumber: 21\n            }, this)]\n          }, dealer.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 848,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 846,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 783,\n        columnNumber: 11\n      }, this), formErrors[field] && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center text-red-400 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"h-4 w-4 mr-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 867,\n          columnNumber: 13\n        }, this), formErrors[field]]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 866,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 740,\n      columnNumber: 7\n    }, this);\n  };\n  const renderStep = () => {\n    switch (currentStep) {\n      case 1:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-medium text-white mb-4\",\n              children: \"Deal Type Selection\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 882,\n              columnNumber: 15\n            }, this), renderFormField('Deal Type', 'dealType', 'select', dealTypes, true, Car), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-4\",\n              children: renderFormField('Deal Type 2', 'dealType2SubType', 'select', dealType2SubOptions, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 884,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 881,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-medium text-white mb-4\",\n              children: \"Vehicle Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 890,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"md:col-span-2\",\n                children: renderFormField('VIN', 'vin', 'text', null, true, Hash)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 892,\n                columnNumber: 17\n              }, this), renderFormField('Year', 'year', 'number', null, true, Calendar), renderFormField('Make', 'make', 'text', null, true), renderFormField('Model', 'model', 'text', null, true), renderFormField('Mileage', 'mileage', 'number', null, false, Gauge), renderFormField('Exterior Color', 'exteriorColor', 'text', null, false, Palette), renderFormField('Interior Color', 'interiorColor', 'text', null, false, Palette)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 891,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 889,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 11\n        }, this);\n      case 2:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-medium text-white mb-4\",\n              children: \"Deal Configuration\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 911,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n              children: [renderFormField('Funding Source', 'fundingSource', 'select', fundingSources, true, DollarSign), renderFormField('Purchase/Sale Date', 'purchaseDate', 'date', null, true, Calendar), renderFormField('Payment Method', 'paymentMethod', 'select', paymentMethods, true), renderFormField('RP Stock Number', 'rpStockNumber', 'text', null, false, Hash), renderFormField('Salesperson', 'salesperson', 'select', salespersonOptions, true, User)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 912,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 910,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 908,\n          columnNumber: 11\n        }, this);\n      case 3:\n        return dealTypeFields.showFinancials ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-white mb-4\",\n            children: \"Financial Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 925,\n            columnNumber: 13\n          }, this), formData.dealType2SubType === 'sale' ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-6\",\n            children: [renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign), renderFormField('Brokerage Fee', 'brokerageFee', 'number'), renderFormField('Brokerage Fee Paid To', 'brokeerageFeePaidTo', 'text'), renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number'), renderFormField('Amount Due to RP', 'amountDueToRP', 'number')]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 927,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-6\",\n              children: [renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign), renderFormField('Kill Price', 'killPrice', 'number'), renderFormField('Wholesale Price', 'wholesalePrice', 'number'), renderFormField('List Price', 'listPrice', 'number'), ['consign-a', 'consign-b', 'consign-c', 'consign-rdnc'].includes(formData.dealType2SubType) ? renderFormField('Commission Rate (%)', 'commissionRate', 'number') : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 937,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-6\",\n              children: [renderFormField('Brokerage Fee', 'brokerageFee', 'number'), renderFormField('Brokerage Fee Paid To', 'brokeerageFeePaidTo', 'text'), renderFormField('Payoff Balance', 'payoffBalance', 'number'), renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number'), renderFormField('Amount Due to RP', 'amountDueToRP', 'number')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 948,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 935,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 11\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center py-12\",\n          children: [/*#__PURE__*/_jsxDEV(DollarSign, {\n            className: \"h-12 w-12 text-gray-400 mx-auto mb-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 960,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-white mb-2\",\n            children: \"Financial Information Not Required\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 961,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-400\",\n            children: \"This deal type does not require financial information.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 962,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 959,\n          columnNumber: 11\n        }, this);\n      case 4:\n        // Seller/Dealer Info step\n        if (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/5 rounded-xl p-6 border border-white/10 space-y-10\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-medium text-white mb-4\",\n                children: \"Dealer Info (Buyer)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 972,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n                children: [renderFormField('Dealer Name', 'dealerName', 'text', null, true, User, true), renderFormField('Dealer Company', 'dealerCompany', 'text'), renderFormField('Dealer Phone', 'dealerPhone', 'tel', null, false, Phone), renderFormField('Dealer Email', 'dealerEmail', 'email', null, false, Mail), renderFormField('Dealer Address', 'dealerAddress', 'text', null, false, MapPin)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 973,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 971,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-medium text-white mb-4\",\n                children: \"Seller Info (Seller)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 982,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n                children: [renderFormField('Seller Name', 'sellerName', 'text', null, true, User), renderFormField('Seller Company', 'sellerCompany', 'text'), renderFormField('Seller Phone', 'sellerPhone', 'tel', null, false, Phone), renderFormField('Seller Email', 'sellerEmail', 'email', null, false, Mail), renderFormField('Seller Address', 'sellerAddress', 'text', null, false, MapPin), renderFormField('Dealer License #', 'sellerLicenseNumber', 'text', null, false, Hash), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium text-white mb-2\",\n                    children: \"Dealer Tier\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 993,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex space-x-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => handleInputChange('sellerTier', 'Tier 1'),\n                      className: `px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier === 'Tier 1' ? 'bg-red-600 border-red-500 text-white' : 'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,\n                      children: \"Tier 1 - Pay Upon Release\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 997,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => handleInputChange('sellerTier', 'Tier 2'),\n                      className: `px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier === 'Tier 2' ? 'bg-green-600 border-green-500 text-white' : 'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,\n                      children: \"Tier 2 - Pay Upon Title\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1008,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 996,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-400 mt-1\",\n                    children: \"Tier 2 dealers are in our dealer network and get extended payment terms\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1020,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 992,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 983,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 981,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 970,\n            columnNumber: 13\n          }, this);\n        } else {\n          const isRetailPP = formData.dealType === 'retail-pp';\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-medium text-white mb-4\",\n              children: dynamicLabels.sellerSectionTitle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1032,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"md:col-span-2\",\n                children: renderFormField(dynamicLabels.sellerLabel, 'sellerName', 'text', null, true, User)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1034,\n                columnNumber: 17\n              }, this), renderFormField(dynamicLabels.companyLabel, 'sellerCompany', 'text'), renderFormField('Phone', 'sellerPhone', 'tel', null, false, Phone), renderFormField('Email', 'sellerEmail', 'email', null, false, Mail), renderFormField(dynamicLabels.addressLabel, 'sellerAddress', 'text', null, false, MapPin), !isRetailPP && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"seller-license-number\",\n                    className: \"block text-sm font-medium text-gray-300 mb-1\",\n                    children: \"Dealer License Number\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1046,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    id: \"seller-license-number\",\n                    value: formData.sellerLicenseNumber || '',\n                    onChange: e => handleInputChange('sellerLicenseNumber', e.target.value),\n                    className: \"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1047,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1045,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"md:col-span-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium text-white mb-2\",\n                    children: \"Dealer Tier\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1058,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex space-x-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => handleInputChange('sellerTier', 'Tier 1'),\n                      className: `px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier === 'Tier 1' ? 'bg-red-600 border-red-500 text-white' : 'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,\n                      children: \"Tier 1 - Pay Upon Release\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1062,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => handleInputChange('sellerTier', 'Tier 2'),\n                      className: `px-4 py-2 rounded-lg border transition-colors ${formData.sellerTier === 'Tier 2' ? 'bg-green-600 border-green-500 text-white' : 'bg-white/10 border-white/20 text-white hover:bg-white/20'}`,\n                      children: \"Tier 2 - Pay Upon Title\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1073,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1061,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-400 mt-1\",\n                    children: \"Tier 2 dealers are in our dealer network and get extended payment terms\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1085,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1057,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true), isRetailPP && /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"seller-license-number\",\n                  className: \"block text-sm font-medium text-gray-300 mb-1\",\n                  children: \"License Number (if applicable)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1095,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  id: \"seller-license-number\",\n                  value: formData.sellerLicenseNumber || '',\n                  onChange: e => handleInputChange('sellerLicenseNumber', e.target.value),\n                  placeholder: \"Enter license number if applicable...\",\n                  className: \"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1096,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1094,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1033,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1031,\n            columnNumber: 13\n          }, this);\n        }\n      case 5:\n        return dealTypeFields.showDocumentation ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white/5 rounded-xl p-6 border border-white/10\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-white mb-4\",\n            children: \"Documentation & Notes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: \"text-md font-medium text-white mb-4\",\n                  children: \"Documentation Status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1118,\n                  columnNumber: 19\n                }, this), renderFormField('Contract Required', 'contractRequired', 'checkbox'), renderFormField('Title Present', 'titlePresent', 'checkbox'), renderFormField('Driver License Present', 'driverLicensePresent', 'checkbox'), renderFormField('Odometer Present', 'odometerPresent', 'checkbox'), renderFormField('Dealer License Present', 'dealerLicensePresent', 'checkbox')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1117,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-4\",\n                children: [renderFormField('Vehicle Description', 'vehicleDescription', 'textarea', null, false, Info), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium text-white mb-2\",\n                    children: \"Upload Documents/Photos\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1129,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    multiple: true,\n                    accept: \"image/*,application/pdf\",\n                    onChange: handleDocumentUpload,\n                    className: \"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1130,\n                    columnNumber: 21\n                  }, this), formData.documents && formData.documents.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-3 space-y-2\",\n                    children: formData.documents.map((file, i) => {\n                      var _documentNotes$find;\n                      return /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center space-x-3 bg-white/10 rounded p-2\",\n                        children: [file.type && file.type.startsWith('image') ? /*#__PURE__*/_jsxDEV(\"img\", {\n                          src: URL.createObjectURL(file),\n                          alt: file.name,\n                          className: \"h-12 w-12 object-cover rounded\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1143,\n                          columnNumber: 31\n                        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"inline-block w-12 h-12 bg-gray-700 text-white flex items-center justify-center rounded\",\n                          children: \"PDF\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1145,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-white text-sm truncate max-w-xs\",\n                          children: file.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1147,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                          type: \"text\",\n                          value: ((_documentNotes$find = documentNotes.find(sel => sel.fileIndex === i)) === null || _documentNotes$find === void 0 ? void 0 : _documentNotes$find.note) || '',\n                          onChange: e => handleDocumentNoteChange(i, e.target.value),\n                          placeholder: \"Add a note (optional)\",\n                          className: \"bg-white/10 border rounded-lg px-2 py-1 text-white text-sm\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1148,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                          type: \"button\",\n                          className: \"ml-auto text-red-400 hover:text-red-600 text-xs font-medium\",\n                          onClick: () => handleRemoveDocument(i),\n                          children: \"Remove\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1155,\n                          columnNumber: 29\n                        }, this)]\n                      }, i, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1141,\n                        columnNumber: 27\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1139,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1128,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1125,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1116,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: renderFormField('General Notes', 'generalNotes', 'textarea', null, false, Info)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1169,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1115,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1113,\n          columnNumber: 11\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center py-12\",\n          children: [/*#__PURE__*/_jsxDEV(Info, {\n            className: \"h-12 w-12 text-gray-400 mx-auto mb-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1176,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-white mb-2\",\n            children: \"Documentation Not Required\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1177,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-400\",\n            children: \"This deal type does not require documentation tracking.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1178,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1175,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n\n  // Calculate total steps based on deal type\n  const getTotalSteps = () => {\n    let steps = 2; // Always have vehicle info and deal config\n    if (dealTypeFields.showFinancials) steps++;\n    if (dealTypeFields.showSellerInfo) steps++;\n    if (dealTypeFields.showDocumentation) steps++;\n    return steps;\n  };\n  const totalSteps = getTotalSteps();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 overflow-hidden pointer-events-none\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/5 rounded-full blur-3xl animate-pulse\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-1000\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1203,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"relative bg-black/20 backdrop-blur-md border-b border-white/10\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-7xl mx-auto px-6 py-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => window.history.back(),\n              className: \"mr-4 p-2 bg-white/10 hover:bg-white/20 rounded-lg border border-white/20 transition-colors\",\n              children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n                className: \"h-5 w-5 text-white\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1215,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1211,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl p-3 mr-4 shadow-lg shadow-blue-500/25\",\n                children: /*#__PURE__*/_jsxDEV(Plus, {\n                  className: \"h-6 w-6 text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1219,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1218,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"text-xl font-bold text-white\",\n                  children: \"New Deal Entry\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1222,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-300 text-sm\",\n                  children: \"Create a new vehicle deal\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1223,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1221,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1217,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1210,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSave(true),\n              disabled: saving,\n              className: \"flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/20 transition-colors disabled:opacity-50\",\n              children: [saving ? /*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"h-4 w-4 mr-2 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1234,\n                columnNumber: 27\n              }, this) : /*#__PURE__*/_jsxDEV(Save, {\n                className: \"h-4 w-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1234,\n                columnNumber: 79\n              }, this), \"Save Draft\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1229,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSave(false),\n              disabled: saving,\n              className: \"flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50\",\n              children: [saving ? /*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"h-4 w-4 mr-2 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1243,\n                columnNumber: 27\n              }, this) : /*#__PURE__*/_jsxDEV(CheckCircle, {\n                className: \"h-4 w-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1243,\n                columnNumber: 79\n              }, this), \"Create Deal\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1238,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1228,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1209,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1208,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative max-w-6xl mx-auto px-6 py-8\",\n      children: [renderStepIndicator(), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 p-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-2xl font-bold text-white mb-2\",\n            children: [currentStep === 1 && 'Vehicle Information & Deal Type', currentStep === 2 && 'Deal Configuration', currentStep === 3 && dealTypeFields.showFinancials && 'Financial Information', currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information', currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes', currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information', currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes', currentStep === 5 && 'Documentation & Notes']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1258,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-300\",\n            children: [currentStep === 1 && 'Enter basic vehicle information and select the deal type', currentStep === 2 && 'Configure deal type, funding, and timeline', currentStep === 3 && dealTypeFields.showFinancials && 'Set pricing and financial terms', currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information', currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes', currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information', currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes', currentStep === 5 && 'Document status and additional notes']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1268,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1257,\n          columnNumber: 11\n        }, this), renderStep(), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mt-8 pt-6 border-t border-white/10\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCurrentStep(Math.max(1, currentStep - 1)),\n            disabled: currentStep === 1,\n            className: \"flex items-center px-4 py-2 text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n            children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n              className: \"h-4 w-4 mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1289,\n              columnNumber: 15\n            }, this), \"Previous\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1284,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [currentStep === totalSteps && formData.vehicleDescription && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleEmailToListingTeam,\n              className: \"flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\",\n              children: [/*#__PURE__*/_jsxDEV(Send, {\n                className: \"h-4 w-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1299,\n                columnNumber: 19\n              }, this), \"Email to Listing Team\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1295,\n              columnNumber: 17\n            }, this), currentStep < totalSteps ? /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setCurrentStep(Math.min(totalSteps, currentStep + 1)),\n              className: \"flex items-center px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-colors\",\n              children: [\"Next\", /*#__PURE__*/_jsxDEV(ArrowLeft, {\n                className: \"h-4 w-4 ml-2 rotate-180\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1310,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1305,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSave(false),\n              disabled: saving,\n              className: \"flex items-center px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-lg transition-colors disabled:opacity-50\",\n              children: [saving ? /*#__PURE__*/_jsxDEV(Loader2, {\n                className: \"h-4 w-4 mr-2 animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1318,\n                columnNumber: 29\n              }, this) : /*#__PURE__*/_jsxDEV(CheckCircle, {\n                className: \"h-4 w-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1318,\n                columnNumber: 81\n              }, this), \"Submit Deal\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1313,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1293,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1283,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1256,\n        columnNumber: 9\n      }, this), vinDecoding && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed bottom-6 right-6 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Loader2, {\n          className: \"h-4 w-4 mr-2 animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1329,\n          columnNumber: 13\n        }, this), \"Decoding VIN...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1328,\n        columnNumber: 11\n      }, this), vinDecoded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed bottom-6 right-6 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n          className: \"h-4 w-4 mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1336,\n          columnNumber: 13\n        }, this), \"VIN decoded successfully!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1335,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1251,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1341,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1199,\n    columnNumber: 5\n  }, this);\n};\n_s(NewDealEntry, \"IgRBf7lWGrKhdmvmX105tHo9CIQ=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = NewDealEntry;\nexport default NewDealEntry;\nvar _c;\n$RefreshReg$(_c, \"NewDealEntry\");","map":{"version":3,"names":["React","useState","useEffect","Car","ArrowLeft","Save","Send","CheckCircle","Loader2","Calendar","DollarSign","User","MapPin","Phone","Mail","Hash","Palette","Gauge","Info","Plus","AlertCircle","useAuth","useNavigate","ToastContainer","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","NewDealEntry","_s","user","currentUser","getAuthHeaders","navigate","API_BASE","buildHeaders","extra","headers","console","warn","log","formData","setFormData","vin","year","make","model","mileage","exteriorColor","interiorColor","dealType","dealType2SubType","fundingSource","purchaseDate","paymentMethod","currentStage","purchasePrice","listPrice","killPrice","wholesalePrice","commissionRate","brokerageFee","brokeerageFeePaidTo","payoffBalance","amountDueToCustomer","amountDueToRP","sellerName","sellerCompany","sellerAddress","sellerPhone","sellerEmail","sellerLicenseNumber","sellerTier","rpStockNumber","vehicleDescription","generalNotes","contractRequired","titlePresent","driverLicensePresent","odometerPresent","dealerLicensePresent","documents","salesperson","vinDecoding","setVinDecoding","vinDecoded","setVinDecoded","dealerSuggestions","setDealerSuggestions","dealerBuyerSuggestions","setDealerBuyerSuggestions","dealerSearch","setDealerSearch","formErrors","setFormErrors","saving","setSaving","currentStep","setCurrentStep","documentNotes","setDocumentNotes","fetch","credentials","then","res","json","data","success","Array","isArray","catch","formatCurrency","value","numericValue","toString","replace","parts","split","length","slice","join","joinAddress","address","street","city","state","zip","filter","Boolean","parseAddress","full","map","s","trim","getDynamicLabels","dealType2","isRetailPP","purchasePriceLabel","sellerLabel","sellerSectionTitle","companyLabel","licenseLabel","addressLabel","dynamicLabels","dealTypes","label","fundingSources","paymentMethods","dealType2SubOptions","salespersonOptions","getDealTypeFields","showFinancials","includes","showSellerInfo","showDocumentation","requiredFields","dealTypeFields","decodeVIN","response","method","body","JSON","stringify","prev","setTimeout","error","alert","searchDealers","query","encodeURIComponent","dealers","searchDealersBuyer","handleDealerSuggestionClick","dealer","name","company","addressString","phone","email","licenseNumber","tier","handleInputChange","field","processedValue","handleDocumentUpload","e","files","from","target","_","i","fileIndex","note","handleRemoveDocument","index","sel","handleDocumentNoteChange","found","find","handleDealerSuggestionSelect","updated","validateForm","errors","forEach","charAt","toUpperCase","Date","getFullYear","Object","keys","handleSave","isDraft","dealData","vehicle","parseInt","color","parseFloat","seller","type","contact","dealResponse","status","ok","err","Error","dealResult","dealId","deal","_id","documentResponse","stockNumber","documentResult","file","noteObj","documentType","form","FormData","append","uploadRes","statusText","message","successMessage","handleEmailToListingTeam","emailBody","mailtoLink","window","open","renderStepIndicator","className","children","totalSteps","stepNumber","isActive","isCompleted","stepTitle","stepDescription","fileName","_jsxFileName","lineNumber","columnNumber","renderFormField","options","required","icon","isDealerBuyer","createElement","onChange","option","rows","placeholder","toLowerCase","checked","onClick","_dealer$contact","dealerName","dealerCompany","dealerPhone","dealerEmail","dealerAddress","location","id","renderStep","htmlFor","multiple","accept","_documentNotes$find","startsWith","src","URL","createObjectURL","alt","getTotalSteps","steps","history","back","disabled","Math","max","min","_c","$RefreshReg$"],"sources":["/Users/bsauer02/Desktop/Opis3.0/rp-exotics-unified/frontend/src/components/NewDealEntry.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n  Car, ArrowLeft, Save, Send, CheckCircle, Loader2, \n  Calendar, DollarSign, User, \n  MapPin, Phone, Mail, Hash, Palette, Gauge, \n  Info, Plus, AlertCircle \n} from 'lucide-react';\nimport { useAuth } from './AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nconst NewDealEntry = () => {\n  const { user: currentUser, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n    }\n  }, [currentUser, navigate]);\n\n  // Utility to get backend API URL\n  const API_BASE = 'http://localhost:5001';\n\n  // Utility to merge auth headers\n  const buildHeaders = (extra = {}) => {\n    const headers = {\n      ...getAuthHeaders(),\n      'Content-Type': 'application/json',\n      ...extra\n    };\n    // Debug: log token presence\n    if (!headers['Authorization']) {\n      console.warn('[DEAL SUBMIT] No Authorization token in headers!');\n    } else {\n      console.log('[DEAL SUBMIT] Using Authorization header:', headers['Authorization']);\n    }\n    return headers;\n  };\n\n  const [formData, setFormData] = useState({\n    // Vehicle Information\n    vin: '',\n    year: '',\n    make: '',\n    model: '',\n    mileage: '',\n    exteriorColor: '',\n    interiorColor: '',\n    \n    // Deal Information\n    dealType: '',\n    dealType2SubType: '', // <-- Add this for Deal Type 2 sub-options\n    fundingSource: '',\n    purchaseDate: '',\n    paymentMethod: 'check', // Default to 'check'\n    currentStage: 'initial-contact',\n    \n    // Financial Information\n    purchasePrice: '',\n    listPrice: '',\n    killPrice: '',\n    wholesalePrice: '',\n    commissionRate: '',\n    brokerageFee: '',\n    brokeerageFeePaidTo: '',\n    payoffBalance: '',\n    amountDueToCustomer: '',\n    amountDueToRP: '',\n    \n    // Seller Information\n    sellerName: '',\n    sellerCompany: '',\n    sellerAddress: '',\n    sellerPhone: '',\n    sellerEmail: '',\n    sellerLicenseNumber: '',\n    sellerTier: 'Tier 1',\n    \n    // RP Information\n    rpStockNumber: '',\n    vehicleDescription: '',\n    generalNotes: '',\n    \n    // Documentation\n    contractRequired: false,\n    titlePresent: false,\n    driverLicensePresent: false,\n    odometerPresent: false,\n    dealerLicensePresent: false,\n    documents: [], // For uploaded files\n    salesperson: ''\n  });\n\n  const [vinDecoding, setVinDecoding] = useState(false);\n  const [vinDecoded, setVinDecoded] = useState(false);\n  const [dealerSuggestions, setDealerSuggestions] = useState([]);\n  const [dealerBuyerSuggestions, setDealerBuyerSuggestions] = useState([]); // For Dealer Info (Buyer)\n  const [dealerSearch, setDealerSearch] = useState('');\n  const [formErrors, setFormErrors] = useState({});\n  const [saving, setSaving] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  // Remove documentTypes and documentTypeSelections state\n  // Add notes state for each file\n  const [documentNotes, setDocumentNotes] = useState([]); // Array of {fileIndex, note}\n\n  useEffect(() => {\n    // Fetch document types from backend\n    fetch(`${API_BASE}/api/backoffice/document-types`, { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => {\n        if (data.success && Array.isArray(data.data)) {\n          // setDocumentTypes(data.data); // This line is removed\n        }\n      })\n      .catch(() => {\n        // setDocumentTypes([]); // This line is removed\n      });\n  }, []);\n\n  // Helper function to format currency input\n  const formatCurrency = (value) => {\n    if (!value) return '';\n    // Remove all non-numeric characters except decimal point\n    const numericValue = value.toString().replace(/[^\\d.]/g, '');\n    // Ensure only one decimal point\n    const parts = numericValue.split('.');\n    if (parts.length > 2) {\n      return parts[0] + '.' + parts.slice(1).join('');\n    }\n    return numericValue;\n  };\n\n  // Add a helper to join address parts into a single line\n  function joinAddress(address) {\n    if (!address) return '';\n    const { street, city, state, zip } = address;\n    return [street, city, state, zip].filter(Boolean).join(', ');\n  }\n  // Add a helper to parse a single line address into parts\n  function parseAddress(full) {\n    if (!full) return { street: '', city: '', state: '', zip: '' };\n    const parts = full.split(',').map(s => s.trim());\n    return {\n      street: parts[0] || '',\n      city: parts[1] || '',\n      state: parts[2] || '',\n      zip: parts[3] || ''\n    };\n  }\n\n\n  // Get dynamic labels based on deal type\n  const getDynamicLabels = () => {\n    const dealType2 = formData.dealType2SubType;\n    const isRetailPP = formData.dealType === 'retail-pp';\n    \n    return {\n      purchasePriceLabel: dealType2 === 'sale' ? 'Sale Price' : 'Purchase Price',\n      sellerLabel: dealType2 === 'sale' ? 'Sold To' : 'Purchased From',\n      sellerSectionTitle: dealType2 === 'sale' ? 'Buyer Information' : 'Seller Information',\n      // For retail PP deals, use more generic labels\n      companyLabel: isRetailPP ? 'Company (if applicable)' : 'Company/Dealer',\n      licenseLabel: isRetailPP ? 'License Number (if applicable)' : 'Dealer License Number',\n      addressLabel: isRetailPP ? 'Address' : 'Seller Address'\n    };\n  };\n\n  const dynamicLabels = getDynamicLabels();\n\n  // Remove Deal Type 2 from main dealTypes\n  const dealTypes = [\n    { value: 'wholesale-d2d', label: 'Wholesale - D2D' },\n    { value: 'wholesale-private', label: 'Wholesale - Private Party' },\n    { value: 'wholesale-flip', label: 'Wholesale - Flip' },\n    { value: 'retail-pp', label: 'Retail - PP' },\n    { value: 'retail-auction', label: 'Retail - Auction' },\n    { value: 'retail-dtod', label: 'Retail - DtoD' },\n    { value: 'auction', label: 'Auction' }\n  ];\n\n  const fundingSources = [\n    { value: 'flpn-retail', label: 'FLPN - Retail' },\n    { value: 'flpn-wholesale', label: 'FLPN - Wholesale' },\n    { value: 'cash', label: 'Cash' },\n    { value: 'flooring-line', label: 'Flooring Line' },\n    { value: 'consignment', label: 'Consignment' }\n  ];\n\n  const paymentMethods = [\n    { value: 'check', label: 'Check' },\n    { value: 'wire', label: 'Wire Transfer' },\n    { value: 'ach', label: 'ACH' },\n    { value: 'cash', label: 'Cash' },\n    { value: 'financed', label: 'Financed' }\n  ];\n\n  const dealType2SubOptions = [\n    { value: 'buy', label: 'Buy' },\n    { value: 'sale', label: 'Sale' },\n    { value: 'buy-sell', label: 'Buy/Sell' },\n    { value: 'consign-a', label: 'Consign-A' },\n    { value: 'consign-b', label: 'Consign-B' },\n    { value: 'consign-c', label: 'Consign-C' },\n    { value: 'consign-rdnc', label: 'Consign-RDNC' }\n  ];\n\n  // Add to formData initial state\n  // This block is removed as per the edit hint.\n\n  // Add salesperson options\n  const salespersonOptions = [\n    { value: 'Brennan S', label: 'Brennan S' },\n    { value: 'Parker G', label: 'Parker G' },\n    { value: 'Dan M', label: 'Dan M' },\n    { value: 'Adiana P', label: 'Adiana P' },\n    { value: 'Brett M', label: 'Brett M' },\n    { value: 'Other', label: 'Other' }\n  ];\n\n  // Get deal type specific fields\n  const getDealTypeFields = () => {\n    // Both dealType and dealType2SubType are always required\n    const dealType = formData.dealType;\n    return {\n      showFinancials: [\n        'wholesale-d2d', 'wholesale-private', 'wholesale-flip',\n        'retail-pp', 'retail-auction', 'retail-dtod', 'auction'\n      ].includes(dealType),\n      showSellerInfo: true,\n      showDocumentation: [\n        'wholesale-d2d', 'wholesale-private', 'wholesale-flip',\n        'retail-pp', 'retail-auction', 'retail-dtod', 'auction'\n      ].includes(dealType),\n      requiredFields: ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName']\n    };\n  };\n\n  const dealTypeFields = getDealTypeFields();\n\n  // Real VIN decode function using backend API\n  const decodeVIN = async (vin) => {\n    setVinDecoding(true);\n    try {\n      const response = await fetch(`${API_BASE}/api/deals/vin/decode`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ vin }),\n        credentials: 'include'\n      });\n      \n      const data = await response.json();\n      \n      if (data.success && data.data) {\n        setFormData(prev => ({\n          ...prev,\n          year: data.data.year || '',\n          make: data.data.make || '',\n          model: data.data.model || ''\n        }));\n        \n        setVinDecoded(true);\n        setTimeout(() => setVinDecoded(false), 3000);\n      } else {\n        console.error('VIN decode failed:', data.error);\n        alert(data.error || 'Unable to decode VIN. Please check the VIN and try again.');\n      }\n    } catch (error) {\n      console.error('VIN decode error:', error);\n      alert('VIN decode service temporarily unavailable. Please try again later.');\n    } finally {\n      setVinDecoding(false);\n    }\n  };\n\n  // Real dealer search using backend API\n  const searchDealers = async (query) => {\n    if (query.length < 2) {\n      setDealerSuggestions([]);\n      return;\n    }\n    // setSearchingDealers(true); // Removed unused state\n    try {\n      const response = await fetch(`${API_BASE}/api/dealers/search?q=${encodeURIComponent(query)}`, { credentials: 'include' });\n      const data = await response.json();\n      setDealerSuggestions(data.dealers || []);\n      console.log('[DEALER SEARCH] Suggestions:', data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerSuggestions([]);\n    }\n  };\n\n  // Dealer search for Dealer Info (Buyer)\n  const searchDealersBuyer = async (query) => {\n    if (query.length < 2) {\n      setDealerBuyerSuggestions([]);\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/api/dealers/search?q=${encodeURIComponent(query)}`, { credentials: 'include' });\n      const data = await response.json();\n      setDealerBuyerSuggestions(data.dealers || []);\n    } catch (error) {\n      console.error('Dealer search error:', error);\n      setDealerBuyerSuggestions([]);\n    }\n  };\n\n  // Autofill dealer info when a suggestion is selected\n  const handleDealerSuggestionClick = (dealer) => {\n    setFormData(prev => ({\n      ...prev,\n      sellerName: dealer.name || '',\n      sellerCompany: dealer.company || '',\n      sellerAddress: dealer.addressString || '',\n      sellerPhone: dealer.phone || '',\n      sellerEmail: dealer.email || '',\n      sellerLicenseNumber: dealer.licenseNumber || '',\n      sellerTier: dealer.tier || 'Tier 1'\n    }));\n    setDealerSuggestions([]);\n    setDealerSearch('');\n    console.log('[DEALER AUTOFILL] Selected dealer:', dealer);\n    console.log('[DEALER AUTOFILL] Autofilled address:', dealer.addressString);\n    console.log('[DEALER AUTOFILL] Autofilled license number:', dealer.licenseNumber);\n  };\n\n  // Auto-generate stock number\n  // useEffect(() => {\n  //   if (!formData.rpStockNumber && formData.year && formData.make) {\n  //     const year = new Date().getFullYear();\n  //     const stockNumber = `RP${year}${String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0')}`;\n  //     setFormData(prev => ({ ...prev, rpStockNumber: stockNumber }));\n  //   }\n  // }, [formData.year, formData.make, formData.rpStockNumber]);\n\n  const handleInputChange = (field, value) => {\n    let processedValue = value;\n    \n    // Handle currency formatting for financial fields\n    if (['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field)) {\n      processedValue = formatCurrency(value);\n    }\n    \n    // If changing dealType, reset dealType2SubType unless still deal-type-2\n    if (field === 'dealType') {\n      setFormData(prev => ({\n        ...prev,\n        dealType: processedValue,\n        dealType2SubType: processedValue === 'deal-type-2' ? prev.dealType2SubType : ''\n      }));\n      if (currentStep > 1) setCurrentStep(1);\n      return;\n    }\n    \n    setFormData(prev => ({ ...prev, [field]: processedValue }));\n    \n    // Clear error when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({ ...prev, [field]: null }));\n    }\n    \n    // Trigger VIN decode when VIN is 17 characters\n    if (field === 'vin' && processedValue.length === 17 && !vinDecoded) {\n      decodeVIN(processedValue);\n    }\n    \n    // Search dealers when typing in seller field\n    if (field === 'sellerName') {\n      searchDealers(processedValue);\n    }\n\n    // Reset to step 1 when deal type changes\n    if (field === 'dealType' && currentStep > 1) {\n      setCurrentStep(1);\n    }\n  };\n\n  // Handle file uploads for documentation\n  const handleDocumentUpload = (e) => {\n    const files = Array.from(e.target.files);\n    setFormData(prev => ({\n      ...prev,\n      documents: [...(prev.documents || []), ...files]\n    }));\n    setDocumentNotes(prev => ([\n      ...prev,\n      ...files.map((_, i) => ({ fileIndex: (prev.length + i), note: '' }))\n    ]));\n  };\n  const handleRemoveDocument = (index) => {\n    setFormData(prev => ({\n      ...prev,\n      documents: prev.documents.filter((_, i) => i !== index)\n    }));\n    setDocumentNotes(prev => prev.filter(sel => sel.fileIndex !== index).map(sel => ({ ...sel, fileIndex: sel.fileIndex > index ? sel.fileIndex - 1 : sel.fileIndex })));\n  };\n  const handleDocumentNoteChange = (fileIndex, note) => {\n    setDocumentNotes(prev => {\n      const found = prev.find(sel => sel.fileIndex === fileIndex);\n      if (found) {\n        return prev.map(sel => sel.fileIndex === fileIndex ? { ...sel, note } : sel);\n      } else {\n        return [...prev, { fileIndex, note }];\n      }\n    });\n  };\n\n  // When a dealer is selected, autofill full address and license number\n  const handleDealerSuggestionSelect = (dealer) => {\n    setFormData(prev => {\n      const updated = {\n        ...prev,\n        sellerName: dealer.name || '',\n        sellerCompany: dealer.company || '',\n        sellerPhone: dealer.phone || '',\n        sellerEmail: dealer.email || '',\n        sellerAddress: dealer.addressString || '',\n        sellerLicenseNumber: dealer.licenseNumber || '',\n        sellerTier: dealer.tier || 'Tier 1',\n      };\n      return updated;\n    });\n  };\n\n  const validateForm = () => {\n    const errors = {};\n    const requiredFields = dealTypeFields.requiredFields || ['vin', 'dealType', 'dealType2SubType', 'year', 'make', 'model', 'sellerName'];\n    \n    requiredFields.forEach(field => {\n      if (!formData[field] || formData[field].toString().trim() === '') {\n        errors[field] = `${field.charAt(0).toUpperCase() + field.slice(1)} is required`;\n      }\n    });\n\n    // Additional validation for specific fields\n    if (formData.vin && formData.vin.length !== 17) {\n      errors.vin = 'VIN must be exactly 17 characters';\n    }\n\n    if (formData.year && (formData.year < 1900 || formData.year > new Date().getFullYear() + 1)) {\n      errors.year = 'Please enter a valid year';\n    }\n\n    if (formData.mileage && formData.mileage < 0) {\n      errors.mileage = 'Mileage cannot be negative';\n    }\n\n    if (dealTypeFields.showFinancials && formData.purchasePrice && formData.purchasePrice <= 0) {\n      errors.purchasePrice = 'Purchase price must be greater than 0';\n    }\n\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSave = async (isDraft = false) => {\n    if (!currentUser) {\n      alert('You must be logged in to submit a deal.');\n      navigate('/login');\n      return;\n    }\n    if (!isDraft && !validateForm()) {\n      console.log('[DEAL SUBMIT] Validation errors:', formErrors);\n      return;\n    }\n    \n    setSaving(true);\n    \n    try {\n      // Debug: log formData before building dealData\n      console.log('[DEAL SUBMIT] formData:', formData);\n      // First, create the deal in the backend\n      const dealData = {\n        vehicle: `${formData.year} ${formData.make} ${formData.model}`,\n        vin: formData.vin,\n        year: parseInt(formData.year),\n        make: formData.make,\n        model: formData.model,\n        rpStockNumber: formData.rpStockNumber,\n        color: formData.exteriorColor,\n        exteriorColor: formData.exteriorColor, // Add this field\n        interiorColor: formData.interiorColor, // Add this field\n        mileage: parseInt(formData.mileage) || 0,\n        purchasePrice: parseFloat(formData.purchasePrice) || 0,\n        listPrice: parseFloat(formData.listPrice) || 0,\n        killPrice: parseFloat(formData.killPrice) || 0,\n        dealType: formData.dealType.includes('retail') ? 'retail' : 'wholesale',\n        dealType2SubType: formData.dealType2SubType, // <-- Ensure this is sent\n        seller: {\n          name: formData.sellerName,\n          type: formData.dealType.includes('private') ? 'private' : 'dealer',\n          contact: {\n            address: parseAddress(formData.sellerAddress), // Use parsed address\n            phone: formData.sellerPhone,\n            email: formData.sellerEmail\n          },\n          licenseNumber: formData.sellerLicenseNumber,\n          tier: formData.sellerTier\n        },\n        fundingSource: formData.fundingSource,\n        paymentMethod: formData.paymentMethod,\n        purchaseDate: formData.purchaseDate ? new Date(formData.purchaseDate) : new Date(),\n        currentStage: 'documentation',\n        salesperson: currentUser.name || 'Unknown' // Use current user's name as salesperson\n      };\n      // Debug: log dealData before sending\n      console.log('[DEAL SUBMIT] dealData to backend:', dealData);\n      // Create deal (this would be your existing deal creation endpoint)\n      const dealResponse = await fetch(`${API_BASE}/api/deals`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify(dealData),\n        credentials: 'include'\n      });\n      // Debug: log backend response status\n      console.log('[DEAL SUBMIT] Backend response status:', dealResponse.status);\n      if (!dealResponse.ok) {\n        const err = await dealResponse.json().catch(() => ({}));\n        console.log('[DEAL SUBMIT] Backend error response:', err);\n        throw new Error('Failed to create deal');\n      }\n\n      const dealResult = await dealResponse.json();\n      const dealId = dealResult.deal._id;\n\n      // Generate document and create vehicle record\n      const documentResponse = await fetch(`${API_BASE}/api/documents/generate/${dealId}`, {\n        method: 'POST',\n        headers: buildHeaders(),\n        body: JSON.stringify({\n          dealType2: formData.dealType2SubType,\n          commissionRate: parseFloat(formData.commissionRate) || 0,\n          stockNumber: formData.rpStockNumber // <-- Add this line\n        }),\n        credentials: 'include' // Ensure cookies/session are sent for authentication\n      });\n\n      if (!documentResponse.ok) {\n        const err = await documentResponse.json().catch(() => ({}));\n        throw new Error(err.error || 'Failed to generate document');\n      }\n\n      const documentResult = await documentResponse.json();\n      \n      // --- UPLOAD USER DOCUMENTS ---\n      if (formData.documents && formData.documents.length > 0) {\n        for (let i = 0; i < formData.documents.length; i++) {\n          const file = formData.documents[i];\n          const noteObj = documentNotes.find(sel => sel.fileIndex === i);\n          const note = noteObj ? noteObj.note : '';\n          const documentType = 'extra_doc';\n          const form = new FormData();\n          form.append('document', file);\n          if (note) form.append('notes', note);\n          try {\n            const uploadRes = await fetch(`${API_BASE}/api/backoffice/deals/${dealId}/documents/${documentType}/upload`, {\n              method: 'POST',\n              headers: {\n                'Authorization': getAuthHeaders()['Authorization']\n              },\n              body: form,\n              credentials: 'include'\n            });\n            if (!uploadRes.ok) {\n              const err = await uploadRes.json().catch(() => ({}));\n              toast.error(`Failed to upload ${file.name}: ${err.error || uploadRes.statusText}`);\n            } else {\n              toast.success(`Uploaded ${file.name}`);\n            }\n          } catch (err) {\n            toast.error(`Error uploading ${file.name}: ${err.message}`);\n          }\n        }\n      }\n      // --- END UPLOAD USER DOCUMENTS ---\n      \n      console.log('Deal created and document generated:', documentResult);\n      \n      // Show success message with document info\n      const successMessage = isDraft \n        ? 'Draft saved successfully!' \n        : `Deal submitted successfully!\\n\\nYour deal has been sent to the back office for processing. You will be notified when the deal is complete.`;\n      \n      toast.success(successMessage);\n      \n      // Optionally redirect to a success page or clear form\n      if (!isDraft) {\n        // Clear form or redirect\n        setFormData({\n          vin: '',\n          year: '',\n          make: '',\n          model: '',\n          mileage: '',\n          exteriorColor: '',\n          interiorColor: '',\n          dealType: '',\n          dealType2SubType: '',\n          fundingSource: '',\n          purchaseDate: '',\n          paymentMethod: 'check',\n          currentStage: 'initial-contact',\n          purchasePrice: '',\n          listPrice: '',\n          killPrice: '',\n          wholesalePrice: '',\n          commissionRate: '',\n          brokerageFee: '',\n          brokeerageFeePaidTo: '',\n          payoffBalance: '',\n          amountDueToCustomer: '',\n          amountDueToRP: '',\n          sellerName: '',\n          sellerCompany: '',\n          sellerAddress: '',\n          sellerPhone: '',\n          sellerEmail: '',\n          sellerLicenseNumber: '',\n          sellerTier: 'Tier 1',\n          rpStockNumber: '',\n          vehicleDescription: '',\n          generalNotes: '',\n          contractRequired: false,\n          titlePresent: false,\n          driverLicensePresent: false,\n          odometerPresent: false,\n          dealerLicensePresent: false,\n          documents: [],\n          salesperson: ''\n        });\n        setCurrentStep(1);\n      }\n      \n    } catch (error) {\n      if (error.message.includes('401') || error.message.includes('not authorized')) {\n        alert('Session expired or not authorized. Please log in again.');\n        navigate('/login');\n      } else {\n        alert(`Error saving deal: ${error.message}`);\n        console.log('[DEAL SUBMIT] Error:', error);\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleEmailToListingTeam = () => {\n    const emailBody = `New Vehicle Ready for Listing\n\nVehicle: ${formData.year} ${formData.make} ${formData.model}\nVIN: ${formData.vin}\nStock #: ${formData.rpStockNumber}\nMileage: ${formData.mileage}\nExterior: ${formData.exteriorColor}\nInterior: ${formData.interiorColor}\n\nDescription:\n${formData.vehicleDescription}\n\nPlease prepare listing materials for this vehicle.\n\nBest regards,\n${currentUser.name}`;\n\n    const mailtoLink = `mailto:listing@rpexotics.com?subject=New Vehicle for Listing - ${formData.year} ${formData.make} ${formData.model}&body=${encodeURIComponent(emailBody)}`;\n    window.open(mailtoLink);\n  };\n\n  // Remove handleCompleteDeal and use handleSave for final submission\n  // Update button text and alerts\n\n  const renderStepIndicator = () => (\n    <div className=\"mb-8\">\n      <div className=\"flex items-center justify-between\">\n        {Array.from({ length: totalSteps }, (_, index) => {\n          const stepNumber = index + 1;\n          const isActive = currentStep === stepNumber;\n          const isCompleted = currentStep > stepNumber;\n          \n          let stepTitle = '';\n          let stepDescription = '';\n          \n          if (stepNumber === 1) {\n            stepTitle = 'Vehicle & Deal Type';\n            stepDescription = 'Enter vehicle information and select deal type';\n          } else if (stepNumber === 2) {\n            stepTitle = 'Deal Configuration';\n            stepDescription = 'Configure funding, payment, and timeline';\n          } else if (stepNumber === 3 && dealTypeFields.showFinancials) {\n            stepTitle = 'Financial Information';\n            stepDescription = 'Set pricing and financial terms';\n          } else if ((stepNumber === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo) || \n                     (stepNumber === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo)) {\n            stepTitle = 'Seller Information';\n            stepDescription = 'Add seller contact information';\n          } else if ((stepNumber === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation) ||\n                     (stepNumber === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation) ||\n                     (stepNumber === 5 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation)) {\n            stepTitle = 'Documentation & Notes';\n            stepDescription = 'Document status and additional notes';\n          }\n          \n          return (\n            <div key={stepNumber} className=\"flex items-center\">\n              <div className={`flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors ${\n                isActive \n                  ? 'bg-blue-600 border-blue-600 text-white' \n                  : isCompleted \n                    ? 'bg-green-600 border-green-600 text-white' \n                    : 'bg-white/10 border-white/20 text-gray-400'\n              }`}>\n                {isCompleted ? (\n                  <CheckCircle className=\"h-5 w-5\" />\n                ) : (\n                  <span className=\"text-sm font-medium\">{stepNumber}</span>\n                )}\n              </div>\n              <div className=\"ml-3\">\n                <p className={`text-sm font-medium ${isActive ? 'text-white' : 'text-gray-400'}`}>\n                  {stepTitle}\n                </p>\n                <p className=\"text-xs text-gray-500\">{stepDescription}</p>\n              </div>\n              {stepNumber < totalSteps && (\n                <div className={`w-16 h-0.5 mx-4 ${isCompleted ? 'bg-green-600' : 'bg-white/20'}`} />\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  const renderFormField = (label, field, type = 'text', options = null, required = false, icon = null, isDealerBuyer = false) => {\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"flex items-center text-sm font-medium text-gray-300\">\n          {icon && React.createElement(icon, { className: \"h-4 w-4 mr-2\" })}\n          {label}\n          {required && <span className=\"text-red-400 ml-1\">*</span>}\n        </label>\n        \n        {type === 'select' ? (\n          <select\n            value={formData[field]}\n            onChange={(e) => handleInputChange(field, e.target.value)}\n            className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${\n              formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n            }`}\n          >\n            <option value=\"\">Select {label}</option>\n            {options?.map(option => (\n              <option key={option.value} value={option.value} className=\"bg-gray-800\">\n                {option.label}\n              </option>\n            ))}\n          </select>\n        ) : type === 'textarea' ? (\n          <textarea\n            value={formData[field]}\n            onChange={(e) => handleInputChange(field, e.target.value)}\n            rows={4}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n            className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors resize-none ${\n              formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n            }`}\n          />\n        ) : type === 'checkbox' ? (\n          <label className=\"flex items-center space-x-2 cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={!!formData[field]}\n              onChange={(e) => handleInputChange(field, e.target.checked)}\n              className=\"rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500\"\n            />\n            <span className=\"text-gray-300\">{label}</span>\n          </label>\n        ) : (\n          <div className=\"relative\">\n            {['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) && (\n              <div className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm\">$</div>\n            )}\n            <input\n              type={type}\n              value={formData[field] || ''}\n              onChange={(e) => {\n                handleInputChange(field, e.target.value);\n                if (isDealerBuyer && field === 'dealerName') searchDealersBuyer(e.target.value);\n                // Only search for sellerName if not a retail deal\n                if (!isDealerBuyer && field === 'sellerName' && !['retail-pp','retail-auction','retail-dtod'].includes(formData.dealType)) searchDealers(e.target.value);\n              }}\n              placeholder={`Enter ${label.toLowerCase()}...`}\n              className={`w-full bg-white/10 border rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${\n                formErrors[field] ? 'border-red-500' : 'border-white/20 hover:border-white/30'\n              } ${field === 'vin' ? 'pr-20' : ''} ${['purchasePrice', 'listPrice', 'killPrice', 'wholesalePrice', 'brokerageFee', 'payoffBalance', 'amountDueToCustomer', 'amountDueToRP'].includes(field) ? 'pl-8' : ''}`}\n            />\n            \n            {field === 'vin' && formData.vin.length === 17 && (\n              <div className=\"absolute right-2 top-1/2 transform -translate-y-1/2\">\n                {vinDecoding ? (\n                  <Loader2 className=\"h-5 w-5 text-blue-400 animate-spin\" />\n                ) : vinDecoded ? (\n                  <CheckCircle className=\"h-5 w-5 text-green-400\" />\n                ) : (\n                  <button\n                    onClick={() => decodeVIN(formData.vin)}\n                    className=\"bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded transition-colors\"\n                  >\n                    Decode\n                  </button>\n                )}\n              </div>\n            )}\n            \n            {/* Dealer Buyer Autocomplete */}\n            {isDealerBuyer && field === 'dealerName' && dealerBuyerSuggestions.length > 0 && (\n              <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\">\n                {dealerBuyerSuggestions.map(dealer => (\n                  <div\n                    key={dealer.id}\n                    className=\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\"\n                    onClick={() => {\n                      setFormData(prev => ({\n                        ...prev,\n                        dealerName: dealer.name,\n                        dealerCompany: dealer.company,\n                        dealerPhone: dealer.phone,\n                        dealerEmail: dealer.contact?.email || dealer.email || '',\n                        dealerAddress: dealer.location || dealer.address || ''\n                      }));\n                      setDealerBuyerSuggestions([]);\n                    }}\n                  >\n                    <div className=\"font-medium text-white\">{dealer.name}</div>\n                    <div className=\"text-sm text-gray-400\">{dealer.company} • {dealer.location}</div>\n                  </div>\n                ))}\n              </div>\n            )}\n            {/* Seller Autocomplete (only for non-retail deals) */}\n            {!isDealerBuyer && field === 'sellerName' && !['retail-pp','retail-auction','retail-dtod'].includes(formData.dealType) && dealerSuggestions.length > 0 && (\n              <div className=\"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-white/20 rounded-lg shadow-xl z-10 max-h-40 overflow-y-auto\">\n                {dealerSuggestions.map(dealer => (\n                  <div\n                    key={dealer.id}\n                    className=\"p-3 hover:bg-white/10 cursor-pointer border-b border-white/10 last:border-b-0\"\n                    onClick={() => {\n                      handleDealerSuggestionSelect(dealer);\n                      setDealerSuggestions([]);\n                    }}\n                  >\n                    <div className=\"font-medium text-white\">{dealer.name}</div>\n                    <div className=\"text-sm text-gray-400\">{dealer.company} • {dealer.location}</div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n        \n        {formErrors[field] && (\n          <div className=\"flex items-center text-red-400 text-sm\">\n            <AlertCircle className=\"h-4 w-4 mr-1\" />\n            {formErrors[field]}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderStep = () => {\n    switch (currentStep) {\n      case 1:\n        return (\n          <div className=\"space-y-6\">\n            {/* Deal Type Selection */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Deal Type Selection</h3>\n              {renderFormField('Deal Type', 'dealType', 'select', dealTypes, true, Car)}\n              <div className=\"mt-4\">\n                {renderFormField('Deal Type 2', 'dealType2SubType', 'select', dealType2SubOptions, true)}\n              </div>\n            </div>\n            {/* Vehicle Information */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Vehicle Information</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"md:col-span-2\">\n                  {renderFormField('VIN', 'vin', 'text', null, true, Hash)}\n                </div>\n                {renderFormField('Year', 'year', 'number', null, true, Calendar)}\n                {renderFormField('Make', 'make', 'text', null, true)}\n                {renderFormField('Model', 'model', 'text', null, true)}\n                {renderFormField('Mileage', 'mileage', 'number', null, false, Gauge)}\n                {renderFormField('Exterior Color', 'exteriorColor', 'text', null, false, Palette)}\n                {renderFormField('Interior Color', 'interiorColor', 'text', null, false, Palette)}\n              </div>\n            </div>\n          </div>\n        );\n      \n      case 2:\n        return (\n          <div className=\"space-y-6\">\n            {/* Deal Configuration */}\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">Deal Configuration</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {renderFormField('Funding Source', 'fundingSource', 'select', fundingSources, true, DollarSign)}\n                {renderFormField('Purchase/Sale Date', 'purchaseDate', 'date', null, true, Calendar)}\n                {renderFormField('Payment Method', 'paymentMethod', 'select', paymentMethods, true)}\n                {renderFormField('RP Stock Number', 'rpStockNumber', 'text', null, false, Hash)}\n                {renderFormField('Salesperson', 'salesperson', 'select', salespersonOptions, true, User)}\n              </div>\n            </div>\n          </div>\n        );\n      case 3:\n        return dealTypeFields.showFinancials ? (\n          <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n            <h3 className=\"text-lg font-medium text-white mb-4\">Financial Information</h3>\n            {formData.dealType2SubType === 'sale' ? (\n              <div className=\"space-y-6\">\n                {renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign)}\n                {renderFormField('Brokerage Fee', 'brokerageFee', 'number')}\n                {renderFormField('Brokerage Fee Paid To', 'brokeerageFeePaidTo', 'text')}\n                {renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number')}\n                {renderFormField('Amount Due to RP', 'amountDueToRP', 'number')}\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {/* Left column */}\n                <div className=\"space-y-6\">\n                  {renderFormField(dynamicLabels.purchasePriceLabel, 'purchasePrice', 'number', null, true, DollarSign)}\n                  {renderFormField('Kill Price', 'killPrice', 'number')}\n                  {renderFormField('Wholesale Price', 'wholesalePrice', 'number')}\n                  {renderFormField('List Price', 'listPrice', 'number')}\n                  {/* Only show Commission Rate for consign deals, otherwise keep layout clean */}\n                  {['consign-a','consign-b','consign-c','consign-rdnc'].includes(formData.dealType2SubType)\n                    ? renderFormField('Commission Rate (%)', 'commissionRate', 'number')\n                    : null}\n                </div>\n                {/* Right column */}\n                <div className=\"space-y-6\">\n                  {renderFormField('Brokerage Fee', 'brokerageFee', 'number')}\n                  {renderFormField('Brokerage Fee Paid To', 'brokeerageFeePaidTo', 'text')}\n                  {renderFormField('Payoff Balance', 'payoffBalance', 'number')}\n                  {renderFormField('Amount Due to Customer', 'amountDueToCustomer', 'number')}\n                  {renderFormField('Amount Due to RP', 'amountDueToRP', 'number')}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <DollarSign className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-white mb-2\">Financial Information Not Required</h3>\n            <p className=\"text-gray-400\">This deal type does not require financial information.</p>\n          </div>\n        );\n      \n      case 4:\n        // Seller/Dealer Info step\n        if (formData.dealType === 'wholesale-flip' && formData.dealType2SubType === 'buy-sell') {\n          return (\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10 space-y-10\">\n              <div>\n                <h3 className=\"text-lg font-medium text-white mb-4\">Dealer Info (Buyer)</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {renderFormField('Dealer Name', 'dealerName', 'text', null, true, User, true)}\n                  {renderFormField('Dealer Company', 'dealerCompany', 'text')}\n                  {renderFormField('Dealer Phone', 'dealerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Dealer Email', 'dealerEmail', 'email', null, false, Mail)}\n                  {renderFormField('Dealer Address', 'dealerAddress', 'text', null, false, MapPin)}\n                </div>\n              </div>\n              <div>\n                <h3 className=\"text-lg font-medium text-white mb-4\">Seller Info (Seller)</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {renderFormField('Seller Name', 'sellerName', 'text', null, true, User)}\n                  {renderFormField('Seller Company', 'sellerCompany', 'text')}\n                  {renderFormField('Seller Phone', 'sellerPhone', 'tel', null, false, Phone)}\n                  {renderFormField('Seller Email', 'sellerEmail', 'email', null, false, Mail)}\n                  {renderFormField('Seller Address', 'sellerAddress', 'text', null, false, MapPin)}\n                  {renderFormField('Dealer License #', 'sellerLicenseNumber', 'text', null, false, Hash)}\n                  \n                  {/* Tier Selection */}\n                  <div className=\"md:col-span-2\">\n                    <label className=\"block text-sm font-medium text-white mb-2\">\n                      Dealer Tier\n                    </label>\n                    <div className=\"flex space-x-4\">\n                      <button\n                        type=\"button\"\n                        onClick={() => handleInputChange('sellerTier', 'Tier 1')}\n                        className={`px-4 py-2 rounded-lg border transition-colors ${\n                          formData.sellerTier === 'Tier 1'\n                            ? 'bg-red-600 border-red-500 text-white'\n                            : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                        }`}\n                      >\n                        Tier 1 - Pay Upon Release\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => handleInputChange('sellerTier', 'Tier 2')}\n                        className={`px-4 py-2 rounded-lg border transition-colors ${\n                          formData.sellerTier === 'Tier 2'\n                            ? 'bg-green-600 border-green-500 text-white'\n                            : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                        }`}\n                      >\n                        Tier 2 - Pay Upon Title\n                      </button>\n                    </div>\n                    <p className=\"text-xs text-gray-400 mt-1\">\n                      Tier 2 dealers are in our dealer network and get extended payment terms\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          );\n        } else {\n          const isRetailPP = formData.dealType === 'retail-pp';\n          return (\n            <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n              <h3 className=\"text-lg font-medium text-white mb-4\">{dynamicLabels.sellerSectionTitle}</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"md:col-span-2\">\n                  {renderFormField(dynamicLabels.sellerLabel, 'sellerName', 'text', null, true, User)}\n                </div>\n                {renderFormField(dynamicLabels.companyLabel, 'sellerCompany', 'text')}\n                {renderFormField('Phone', 'sellerPhone', 'tel', null, false, Phone)}\n                {renderFormField('Email', 'sellerEmail', 'email', null, false, Mail)}\n                {renderFormField(dynamicLabels.addressLabel, 'sellerAddress', 'text', null, false, MapPin)}\n                \n                {/* Only show license number and tier for non-retail deals */}\n                {!isRetailPP && (\n                  <>\n                    <div>\n                      <label htmlFor=\"seller-license-number\" className=\"block text-sm font-medium text-gray-300 mb-1\">Dealer License Number</label>\n                      <input\n                        type=\"text\"\n                        id=\"seller-license-number\"\n                        value={formData.sellerLicenseNumber || ''}\n                        onChange={e => handleInputChange('sellerLicenseNumber', e.target.value)}\n                        className=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      />\n                    </div>\n                    \n                    {/* Tier Selection */}\n                    <div className=\"md:col-span-2\">\n                      <label className=\"block text-sm font-medium text-white mb-2\">\n                        Dealer Tier\n                      </label>\n                      <div className=\"flex space-x-4\">\n                        <button\n                          type=\"button\"\n                          onClick={() => handleInputChange('sellerTier', 'Tier 1')}\n                          className={`px-4 py-2 rounded-lg border transition-colors ${\n                            formData.sellerTier === 'Tier 1'\n                              ? 'bg-red-600 border-red-500 text-white'\n                              : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                          }`}\n                        >\n                          Tier 1 - Pay Upon Release\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => handleInputChange('sellerTier', 'Tier 2')}\n                          className={`px-4 py-2 rounded-lg border transition-colors ${\n                            formData.sellerTier === 'Tier 2'\n                              ? 'bg-green-600 border-green-500 text-white'\n                              : 'bg-white/10 border-white/20 text-white hover:bg-white/20'\n                          }`}\n                        >\n                          Tier 2 - Pay Upon Title\n                        </button>\n                      </div>\n                      <p className=\"text-xs text-gray-400 mt-1\">\n                        Tier 2 dealers are in our dealer network and get extended payment terms\n                      </p>\n                    </div>\n                  </>\n                )}\n                \n                {/* For retail PP deals, show optional license number field */}\n                {isRetailPP && (\n                  <div>\n                    <label htmlFor=\"seller-license-number\" className=\"block text-sm font-medium text-gray-300 mb-1\">License Number (if applicable)</label>\n                    <input\n                      type=\"text\"\n                      id=\"seller-license-number\"\n                      value={formData.sellerLicenseNumber || ''}\n                      onChange={e => handleInputChange('sellerLicenseNumber', e.target.value)}\n                      placeholder=\"Enter license number if applicable...\"\n                      className=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                )}\n              </div>\n            </div>\n          );\n        }\n      \n      case 5:\n        return dealTypeFields.showDocumentation ? (\n          <div className=\"bg-white/5 rounded-xl p-6 border border-white/10\">\n            <h3 className=\"text-lg font-medium text-white mb-4\">Documentation & Notes</h3>\n            <div className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-4\">\n                  <h4 className=\"text-md font-medium text-white mb-4\">Documentation Status</h4>\n                  {renderFormField('Contract Required', 'contractRequired', 'checkbox')}\n                  {renderFormField('Title Present', 'titlePresent', 'checkbox')}\n                  {renderFormField('Driver License Present', 'driverLicensePresent', 'checkbox')}\n                  {renderFormField('Odometer Present', 'odometerPresent', 'checkbox')}\n                  {renderFormField('Dealer License Present', 'dealerLicensePresent', 'checkbox')}\n                </div>\n                <div className=\"space-y-4\">\n                  {renderFormField('Vehicle Description', 'vehicleDescription', 'textarea', null, false, Info)}\n                  {/* File upload area */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-white mb-2\">Upload Documents/Photos</label>\n                    <input\n                      type=\"file\"\n                      multiple\n                      accept=\"image/*,application/pdf\"\n                      onChange={handleDocumentUpload}\n                      className=\"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700\"\n                    />\n                    {/* Preview uploaded files */}\n                    {formData.documents && formData.documents.length > 0 && (\n                      <div className=\"mt-3 space-y-2\">\n                        {formData.documents.map((file, i) => (\n                          <div key={i} className=\"flex items-center space-x-3 bg-white/10 rounded p-2\">\n                            {file.type && file.type.startsWith('image') ? (\n                              <img src={URL.createObjectURL(file)} alt={file.name} className=\"h-12 w-12 object-cover rounded\" />\n                            ) : (\n                              <span className=\"inline-block w-12 h-12 bg-gray-700 text-white flex items-center justify-center rounded\">PDF</span>\n                            )}\n                            <span className=\"text-white text-sm truncate max-w-xs\">{file.name}</span>\n                            <input\n                              type=\"text\"\n                              value={documentNotes.find(sel => sel.fileIndex === i)?.note || ''}\n                              onChange={e => handleDocumentNoteChange(i, e.target.value)}\n                              placeholder=\"Add a note (optional)\"\n                              className=\"bg-white/10 border rounded-lg px-2 py-1 text-white text-sm\"\n                            />\n                            <button\n                              type=\"button\"\n                              className=\"ml-auto text-red-400 hover:text-red-600 text-xs font-medium\"\n                              onClick={() => handleRemoveDocument(i)}\n                            >\n                              Remove\n                            </button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n              <div>\n                {renderFormField('General Notes', 'generalNotes', 'textarea', null, false, Info)}\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <Info className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-white mb-2\">Documentation Not Required</h3>\n            <p className=\"text-gray-400\">This deal type does not require documentation tracking.</p>\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  // Calculate total steps based on deal type\n  const getTotalSteps = () => {\n    let steps = 2; // Always have vehicle info and deal config\n    if (dealTypeFields.showFinancials) steps++;\n    if (dealTypeFields.showSellerInfo) steps++;\n    if (dealTypeFields.showDocumentation) steps++;\n    return steps;\n  };\n\n  const totalSteps = getTotalSteps();\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black\">\n      {/* Animated Background */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/5 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n      </div>\n\n      {/* Header */}\n      <header className=\"relative bg-black/20 backdrop-blur-md border-b border-white/10\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <button \n                onClick={() => window.history.back()}\n                className=\"mr-4 p-2 bg-white/10 hover:bg-white/20 rounded-lg border border-white/20 transition-colors\"\n              >\n                <ArrowLeft className=\"h-5 w-5 text-white\" />\n              </button>\n              <div className=\"flex items-center\">\n                <div className=\"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl p-3 mr-4 shadow-lg shadow-blue-500/25\">\n                  <Plus className=\"h-6 w-6 text-white\" />\n                </div>\n                <div>\n                  <h1 className=\"text-xl font-bold text-white\">New Deal Entry</h1>\n                  <p className=\"text-gray-300 text-sm\">Create a new vehicle deal</p>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"flex items-center space-x-3\">\n              <button\n                onClick={() => handleSave(true)}\n                disabled={saving}\n                className=\"flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/20 transition-colors disabled:opacity-50\"\n              >\n                {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <Save className=\"h-4 w-4 mr-2\" />}\n                Save Draft\n              </button>\n              \n              <button\n                onClick={() => handleSave(false)}\n                disabled={saving}\n                className=\"flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50\"\n              >\n                {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <CheckCircle className=\"h-4 w-4 mr-2\" />}\n                Create Deal\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"relative max-w-6xl mx-auto px-6 py-8\">\n        {/* Step Indicator */}\n        {renderStepIndicator()}\n\n        {/* Form Content */}\n        <div className=\"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 p-8\">\n          <div className=\"mb-6\">\n            <h2 className=\"text-2xl font-bold text-white mb-2\">\n              {currentStep === 1 && 'Vehicle Information & Deal Type'}\n              {currentStep === 2 && 'Deal Configuration'}\n              {currentStep === 3 && dealTypeFields.showFinancials && 'Financial Information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes'}\n              {currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Seller Information'}\n              {currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Documentation & Notes'}\n              {currentStep === 5 && 'Documentation & Notes'}\n            </h2>\n            <p className=\"text-gray-300\">\n              {currentStep === 1 && 'Enter basic vehicle information and select the deal type'}\n              {currentStep === 2 && 'Configure deal type, funding, and timeline'}\n              {currentStep === 3 && dealTypeFields.showFinancials && 'Set pricing and financial terms'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information'}\n              {currentStep === 3 && !dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes'}\n              {currentStep === 4 && dealTypeFields.showFinancials && dealTypeFields.showSellerInfo && 'Add seller contact information'}\n              {currentStep === 4 && dealTypeFields.showFinancials && !dealTypeFields.showSellerInfo && dealTypeFields.showDocumentation && 'Document status and additional notes'}\n              {currentStep === 5 && 'Document status and additional notes'}\n            </p>\n          </div>\n\n          {renderStep()}\n\n          {/* Navigation Buttons */}\n          <div className=\"flex items-center justify-between mt-8 pt-6 border-t border-white/10\">\n            <button\n              onClick={() => setCurrentStep(Math.max(1, currentStep - 1))}\n              disabled={currentStep === 1}\n              className=\"flex items-center px-4 py-2 text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Previous\n            </button>\n\n            <div className=\"flex items-center space-x-3\">\n              {currentStep === totalSteps && formData.vehicleDescription && (\n                <button\n                  onClick={handleEmailToListingTeam}\n                  className=\"flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\n                >\n                  <Send className=\"h-4 w-4 mr-2\" />\n                  Email to Listing Team\n                </button>\n              )}\n              \n              {currentStep < totalSteps ? (\n                <button\n                  onClick={() => setCurrentStep(Math.min(totalSteps, currentStep + 1))}\n                  className=\"flex items-center px-6 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-lg transition-colors\"\n                >\n                  Next\n                  <ArrowLeft className=\"h-4 w-4 ml-2 rotate-180\" />\n                </button>\n              ) : (\n                <button\n                  onClick={() => handleSave(false)}\n                  disabled={saving}\n                  className=\"flex items-center px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-lg transition-colors disabled:opacity-50\"\n                >\n                  {saving ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <CheckCircle className=\"h-4 w-4 mr-2\" />}\n                  Submit Deal\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* VIN Decode Status */}\n        {vinDecoding && (\n          <div className=\"fixed bottom-6 right-6 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\">\n            <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n            Decoding VIN...\n          </div>\n        )}\n        \n        {vinDecoded && (\n          <div className=\"fixed bottom-6 right-6 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center\">\n            <CheckCircle className=\"h-4 w-4 mr-2\" />\n            VIN decoded successfully!\n          </div>\n        )}\n      </div>\n      <ToastContainer />\n    </div>\n  );\n};\n\nexport default NewDealEntry; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SACEC,GAAG,EAAEC,SAAS,EAAEC,IAAI,EAAEC,IAAI,EAAEC,WAAW,EAAEC,OAAO,EAChDC,QAAQ,EAAEC,UAAU,EAAEC,IAAI,EAC1BC,MAAM,EAAEC,KAAK,EAAEC,IAAI,EAAEC,IAAI,EAAEC,OAAO,EAAEC,KAAK,EACzCC,IAAI,EAAEC,IAAI,EAAEC,WAAW,QAClB,cAAc;AACrB,SAASC,OAAO,QAAQ,eAAe;AACvC,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,cAAc,EAAEC,KAAK,QAAQ,gBAAgB;AACtD,OAAO,uCAAuC;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE/C,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACzB,MAAM;IAAEC,IAAI,EAAEC,WAAW;IAAEC;EAAe,CAAC,GAAGZ,OAAO,CAAC,CAAC;EACvD,MAAMa,QAAQ,GAAGZ,WAAW,CAAC,CAAC;;EAE9B;EACApB,SAAS,CAAC,MAAM;IACd,IAAI,CAAC8B,WAAW,EAAE;MAChBE,QAAQ,CAAC,QAAQ,CAAC;IACpB;EACF,CAAC,EAAE,CAACF,WAAW,EAAEE,QAAQ,CAAC,CAAC;;EAE3B;EACA,MAAMC,QAAQ,GAAG,uBAAuB;;EAExC;EACA,MAAMC,YAAY,GAAGA,CAACC,KAAK,GAAG,CAAC,CAAC,KAAK;IACnC,MAAMC,OAAO,GAAG;MACd,GAAGL,cAAc,CAAC,CAAC;MACnB,cAAc,EAAE,kBAAkB;MAClC,GAAGI;IACL,CAAC;IACD;IACA,IAAI,CAACC,OAAO,CAAC,eAAe,CAAC,EAAE;MAC7BC,OAAO,CAACC,IAAI,CAAC,kDAAkD,CAAC;IAClE,CAAC,MAAM;MACLD,OAAO,CAACE,GAAG,CAAC,2CAA2C,EAAEH,OAAO,CAAC,eAAe,CAAC,CAAC;IACpF;IACA,OAAOA,OAAO;EAChB,CAAC;EAED,MAAM,CAACI,QAAQ,EAAEC,WAAW,CAAC,GAAG1C,QAAQ,CAAC;IACvC;IACA2C,GAAG,EAAE,EAAE;IACPC,IAAI,EAAE,EAAE;IACRC,IAAI,EAAE,EAAE;IACRC,KAAK,EAAE,EAAE;IACTC,OAAO,EAAE,EAAE;IACXC,aAAa,EAAE,EAAE;IACjBC,aAAa,EAAE,EAAE;IAEjB;IACAC,QAAQ,EAAE,EAAE;IACZC,gBAAgB,EAAE,EAAE;IAAE;IACtBC,aAAa,EAAE,EAAE;IACjBC,YAAY,EAAE,EAAE;IAChBC,aAAa,EAAE,OAAO;IAAE;IACxBC,YAAY,EAAE,iBAAiB;IAE/B;IACAC,aAAa,EAAE,EAAE;IACjBC,SAAS,EAAE,EAAE;IACbC,SAAS,EAAE,EAAE;IACbC,cAAc,EAAE,EAAE;IAClBC,cAAc,EAAE,EAAE;IAClBC,YAAY,EAAE,EAAE;IAChBC,mBAAmB,EAAE,EAAE;IACvBC,aAAa,EAAE,EAAE;IACjBC,mBAAmB,EAAE,EAAE;IACvBC,aAAa,EAAE,EAAE;IAEjB;IACAC,UAAU,EAAE,EAAE;IACdC,aAAa,EAAE,EAAE;IACjBC,aAAa,EAAE,EAAE;IACjBC,WAAW,EAAE,EAAE;IACfC,WAAW,EAAE,EAAE;IACfC,mBAAmB,EAAE,EAAE;IACvBC,UAAU,EAAE,QAAQ;IAEpB;IACAC,aAAa,EAAE,EAAE;IACjBC,kBAAkB,EAAE,EAAE;IACtBC,YAAY,EAAE,EAAE;IAEhB;IACAC,gBAAgB,EAAE,KAAK;IACvBC,YAAY,EAAE,KAAK;IACnBC,oBAAoB,EAAE,KAAK;IAC3BC,eAAe,EAAE,KAAK;IACtBC,oBAAoB,EAAE,KAAK;IAC3BC,SAAS,EAAE,EAAE;IAAE;IACfC,WAAW,EAAE;EACf,CAAC,CAAC;EAEF,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGpF,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACqF,UAAU,EAAEC,aAAa,CAAC,GAAGtF,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACuF,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGxF,QAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAACyF,sBAAsB,EAAEC,yBAAyB,CAAC,GAAG1F,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC1E,MAAM,CAAC2F,YAAY,EAAEC,eAAe,CAAC,GAAG5F,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAAC6F,UAAU,EAAEC,aAAa,CAAC,GAAG9F,QAAQ,CAAC,CAAC,CAAC,CAAC;EAChD,MAAM,CAAC+F,MAAM,EAAEC,SAAS,CAAC,GAAGhG,QAAQ,CAAC,KAAK,CAAC;EAC3C,MAAM,CAACiG,WAAW,EAAEC,cAAc,CAAC,GAAGlG,QAAQ,CAAC,CAAC,CAAC;EACjD;EACA;EACA,MAAM,CAACmG,aAAa,EAAEC,gBAAgB,CAAC,GAAGpG,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;;EAExDC,SAAS,CAAC,MAAM;IACd;IACAoG,KAAK,CAAC,GAAGnE,QAAQ,gCAAgC,EAAE;MAAEoE,WAAW,EAAE;IAAU,CAAC,CAAC,CAC3EC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAACG,IAAI,IAAI;MACZ,IAAIA,IAAI,CAACC,OAAO,IAAIC,KAAK,CAACC,OAAO,CAACH,IAAI,CAACA,IAAI,CAAC,EAAE;QAC5C;MAAA;IAEJ,CAAC,CAAC,CACDI,KAAK,CAAC,MAAM;MACX;IAAA,CACD,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMC,cAAc,GAAIC,KAAK,IAAK;IAChC,IAAI,CAACA,KAAK,EAAE,OAAO,EAAE;IACrB;IACA,MAAMC,YAAY,GAAGD,KAAK,CAACE,QAAQ,CAAC,CAAC,CAACC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC;IAC5D;IACA,MAAMC,KAAK,GAAGH,YAAY,CAACI,KAAK,CAAC,GAAG,CAAC;IACrC,IAAID,KAAK,CAACE,MAAM,GAAG,CAAC,EAAE;MACpB,OAAOF,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,KAAK,CAACG,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;IACjD;IACA,OAAOP,YAAY;EACrB,CAAC;;EAED;EACA,SAASQ,WAAWA,CAACC,OAAO,EAAE;IAC5B,IAAI,CAACA,OAAO,EAAE,OAAO,EAAE;IACvB,MAAM;MAAEC,MAAM;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAI,CAAC,GAAGJ,OAAO;IAC5C,OAAO,CAACC,MAAM,EAAEC,IAAI,EAAEC,KAAK,EAAEC,GAAG,CAAC,CAACC,MAAM,CAACC,OAAO,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC;EAC9D;EACA;EACA,SAASS,YAAYA,CAACC,IAAI,EAAE;IAC1B,IAAI,CAACA,IAAI,EAAE,OAAO;MAAEP,MAAM,EAAE,EAAE;MAAEC,IAAI,EAAE,EAAE;MAAEC,KAAK,EAAE,EAAE;MAAEC,GAAG,EAAE;IAAG,CAAC;IAC9D,MAAMV,KAAK,GAAGc,IAAI,CAACb,KAAK,CAAC,GAAG,CAAC,CAACc,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;IAChD,OAAO;MACLV,MAAM,EAAEP,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE;MACtBQ,IAAI,EAAER,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE;MACpBS,KAAK,EAAET,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE;MACrBU,GAAG,EAAEV,KAAK,CAAC,CAAC,CAAC,IAAI;IACnB,CAAC;EACH;;EAGA;EACA,MAAMkB,gBAAgB,GAAGA,CAAA,KAAM;IAC7B,MAAMC,SAAS,GAAG9F,QAAQ,CAACU,gBAAgB;IAC3C,MAAMqF,UAAU,GAAG/F,QAAQ,CAACS,QAAQ,KAAK,WAAW;IAEpD,OAAO;MACLuF,kBAAkB,EAAEF,SAAS,KAAK,MAAM,GAAG,YAAY,GAAG,gBAAgB;MAC1EG,WAAW,EAAEH,SAAS,KAAK,MAAM,GAAG,SAAS,GAAG,gBAAgB;MAChEI,kBAAkB,EAAEJ,SAAS,KAAK,MAAM,GAAG,mBAAmB,GAAG,oBAAoB;MACrF;MACAK,YAAY,EAAEJ,UAAU,GAAG,yBAAyB,GAAG,gBAAgB;MACvEK,YAAY,EAAEL,UAAU,GAAG,gCAAgC,GAAG,uBAAuB;MACrFM,YAAY,EAAEN,UAAU,GAAG,SAAS,GAAG;IACzC,CAAC;EACH,CAAC;EAED,MAAMO,aAAa,GAAGT,gBAAgB,CAAC,CAAC;;EAExC;EACA,MAAMU,SAAS,GAAG,CAChB;IAAEhC,KAAK,EAAE,eAAe;IAAEiC,KAAK,EAAE;EAAkB,CAAC,EACpD;IAAEjC,KAAK,EAAE,mBAAmB;IAAEiC,KAAK,EAAE;EAA4B,CAAC,EAClE;IAAEjC,KAAK,EAAE,gBAAgB;IAAEiC,KAAK,EAAE;EAAmB,CAAC,EACtD;IAAEjC,KAAK,EAAE,WAAW;IAAEiC,KAAK,EAAE;EAAc,CAAC,EAC5C;IAAEjC,KAAK,EAAE,gBAAgB;IAAEiC,KAAK,EAAE;EAAmB,CAAC,EACtD;IAAEjC,KAAK,EAAE,aAAa;IAAEiC,KAAK,EAAE;EAAgB,CAAC,EAChD;IAAEjC,KAAK,EAAE,SAAS;IAAEiC,KAAK,EAAE;EAAU,CAAC,CACvC;EAED,MAAMC,cAAc,GAAG,CACrB;IAAElC,KAAK,EAAE,aAAa;IAAEiC,KAAK,EAAE;EAAgB,CAAC,EAChD;IAAEjC,KAAK,EAAE,gBAAgB;IAAEiC,KAAK,EAAE;EAAmB,CAAC,EACtD;IAAEjC,KAAK,EAAE,MAAM;IAAEiC,KAAK,EAAE;EAAO,CAAC,EAChC;IAAEjC,KAAK,EAAE,eAAe;IAAEiC,KAAK,EAAE;EAAgB,CAAC,EAClD;IAAEjC,KAAK,EAAE,aAAa;IAAEiC,KAAK,EAAE;EAAc,CAAC,CAC/C;EAED,MAAME,cAAc,GAAG,CACrB;IAAEnC,KAAK,EAAE,OAAO;IAAEiC,KAAK,EAAE;EAAQ,CAAC,EAClC;IAAEjC,KAAK,EAAE,MAAM;IAAEiC,KAAK,EAAE;EAAgB,CAAC,EACzC;IAAEjC,KAAK,EAAE,KAAK;IAAEiC,KAAK,EAAE;EAAM,CAAC,EAC9B;IAAEjC,KAAK,EAAE,MAAM;IAAEiC,KAAK,EAAE;EAAO,CAAC,EAChC;IAAEjC,KAAK,EAAE,UAAU;IAAEiC,KAAK,EAAE;EAAW,CAAC,CACzC;EAED,MAAMG,mBAAmB,GAAG,CAC1B;IAAEpC,KAAK,EAAE,KAAK;IAAEiC,KAAK,EAAE;EAAM,CAAC,EAC9B;IAAEjC,KAAK,EAAE,MAAM;IAAEiC,KAAK,EAAE;EAAO,CAAC,EAChC;IAAEjC,KAAK,EAAE,UAAU;IAAEiC,KAAK,EAAE;EAAW,CAAC,EACxC;IAAEjC,KAAK,EAAE,WAAW;IAAEiC,KAAK,EAAE;EAAY,CAAC,EAC1C;IAAEjC,KAAK,EAAE,WAAW;IAAEiC,KAAK,EAAE;EAAY,CAAC,EAC1C;IAAEjC,KAAK,EAAE,WAAW;IAAEiC,KAAK,EAAE;EAAY,CAAC,EAC1C;IAAEjC,KAAK,EAAE,cAAc;IAAEiC,KAAK,EAAE;EAAe,CAAC,CACjD;;EAED;EACA;;EAEA;EACA,MAAMI,kBAAkB,GAAG,CACzB;IAAErC,KAAK,EAAE,WAAW;IAAEiC,KAAK,EAAE;EAAY,CAAC,EAC1C;IAAEjC,KAAK,EAAE,UAAU;IAAEiC,KAAK,EAAE;EAAW,CAAC,EACxC;IAAEjC,KAAK,EAAE,OAAO;IAAEiC,KAAK,EAAE;EAAQ,CAAC,EAClC;IAAEjC,KAAK,EAAE,UAAU;IAAEiC,KAAK,EAAE;EAAW,CAAC,EACxC;IAAEjC,KAAK,EAAE,SAAS;IAAEiC,KAAK,EAAE;EAAU,CAAC,EACtC;IAAEjC,KAAK,EAAE,OAAO;IAAEiC,KAAK,EAAE;EAAQ,CAAC,CACnC;;EAED;EACA,MAAMK,iBAAiB,GAAGA,CAAA,KAAM;IAC9B;IACA,MAAMpG,QAAQ,GAAGT,QAAQ,CAACS,QAAQ;IAClC,OAAO;MACLqG,cAAc,EAAE,CACd,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,EACtD,WAAW,EAAE,gBAAgB,EAAE,aAAa,EAAE,SAAS,CACxD,CAACC,QAAQ,CAACtG,QAAQ,CAAC;MACpBuG,cAAc,EAAE,IAAI;MACpBC,iBAAiB,EAAE,CACjB,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,EACtD,WAAW,EAAE,gBAAgB,EAAE,aAAa,EAAE,SAAS,CACxD,CAACF,QAAQ,CAACtG,QAAQ,CAAC;MACpByG,cAAc,EAAE,CAAC,KAAK,EAAE,UAAU,EAAE,kBAAkB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY;IAC/F,CAAC;EACH,CAAC;EAED,MAAMC,cAAc,GAAGN,iBAAiB,CAAC,CAAC;;EAE1C;EACA,MAAMO,SAAS,GAAG,MAAOlH,GAAG,IAAK;IAC/ByC,cAAc,CAAC,IAAI,CAAC;IACpB,IAAI;MACF,MAAM0E,QAAQ,GAAG,MAAMzD,KAAK,CAAC,GAAGnE,QAAQ,uBAAuB,EAAE;QAC/D6H,MAAM,EAAE,MAAM;QACd1H,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/C2H,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEvH;QAAI,CAAC,CAAC;QAC7B2D,WAAW,EAAE;MACf,CAAC,CAAC;MAEF,MAAMI,IAAI,GAAG,MAAMoD,QAAQ,CAACrD,IAAI,CAAC,CAAC;MAElC,IAAIC,IAAI,CAACC,OAAO,IAAID,IAAI,CAACA,IAAI,EAAE;QAC7BhE,WAAW,CAACyH,IAAI,KAAK;UACnB,GAAGA,IAAI;UACPvH,IAAI,EAAE8D,IAAI,CAACA,IAAI,CAAC9D,IAAI,IAAI,EAAE;UAC1BC,IAAI,EAAE6D,IAAI,CAACA,IAAI,CAAC7D,IAAI,IAAI,EAAE;UAC1BC,KAAK,EAAE4D,IAAI,CAACA,IAAI,CAAC5D,KAAK,IAAI;QAC5B,CAAC,CAAC,CAAC;QAEHwC,aAAa,CAAC,IAAI,CAAC;QACnB8E,UAAU,CAAC,MAAM9E,aAAa,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;MAC9C,CAAC,MAAM;QACLhD,OAAO,CAAC+H,KAAK,CAAC,oBAAoB,EAAE3D,IAAI,CAAC2D,KAAK,CAAC;QAC/CC,KAAK,CAAC5D,IAAI,CAAC2D,KAAK,IAAI,2DAA2D,CAAC;MAClF;IACF,CAAC,CAAC,OAAOA,KAAK,EAAE;MACd/H,OAAO,CAAC+H,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;MACzCC,KAAK,CAAC,qEAAqE,CAAC;IAC9E,CAAC,SAAS;MACRlF,cAAc,CAAC,KAAK,CAAC;IACvB;EACF,CAAC;;EAED;EACA,MAAMmF,aAAa,GAAG,MAAOC,KAAK,IAAK;IACrC,IAAIA,KAAK,CAAClD,MAAM,GAAG,CAAC,EAAE;MACpB9B,oBAAoB,CAAC,EAAE,CAAC;MACxB;IACF;IACA;IACA,IAAI;MACF,MAAMsE,QAAQ,GAAG,MAAMzD,KAAK,CAAC,GAAGnE,QAAQ,yBAAyBuI,kBAAkB,CAACD,KAAK,CAAC,EAAE,EAAE;QAAElE,WAAW,EAAE;MAAU,CAAC,CAAC;MACzH,MAAMI,IAAI,GAAG,MAAMoD,QAAQ,CAACrD,IAAI,CAAC,CAAC;MAClCjB,oBAAoB,CAACkB,IAAI,CAACgE,OAAO,IAAI,EAAE,CAAC;MACxCpI,OAAO,CAACE,GAAG,CAAC,8BAA8B,EAAEkE,IAAI,CAACgE,OAAO,IAAI,EAAE,CAAC;IACjE,CAAC,CAAC,OAAOL,KAAK,EAAE;MACd/H,OAAO,CAAC+H,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C7E,oBAAoB,CAAC,EAAE,CAAC;IAC1B;EACF,CAAC;;EAED;EACA,MAAMmF,kBAAkB,GAAG,MAAOH,KAAK,IAAK;IAC1C,IAAIA,KAAK,CAAClD,MAAM,GAAG,CAAC,EAAE;MACpB5B,yBAAyB,CAAC,EAAE,CAAC;MAC7B;IACF;IACA,IAAI;MACF,MAAMoE,QAAQ,GAAG,MAAMzD,KAAK,CAAC,GAAGnE,QAAQ,yBAAyBuI,kBAAkB,CAACD,KAAK,CAAC,EAAE,EAAE;QAAElE,WAAW,EAAE;MAAU,CAAC,CAAC;MACzH,MAAMI,IAAI,GAAG,MAAMoD,QAAQ,CAACrD,IAAI,CAAC,CAAC;MAClCf,yBAAyB,CAACgB,IAAI,CAACgE,OAAO,IAAI,EAAE,CAAC;IAC/C,CAAC,CAAC,OAAOL,KAAK,EAAE;MACd/H,OAAO,CAAC+H,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C3E,yBAAyB,CAAC,EAAE,CAAC;IAC/B;EACF,CAAC;;EAED;EACA,MAAMkF,2BAA2B,GAAIC,MAAM,IAAK;IAC9CnI,WAAW,CAACyH,IAAI,KAAK;MACnB,GAAGA,IAAI;MACPjG,UAAU,EAAE2G,MAAM,CAACC,IAAI,IAAI,EAAE;MAC7B3G,aAAa,EAAE0G,MAAM,CAACE,OAAO,IAAI,EAAE;MACnC3G,aAAa,EAAEyG,MAAM,CAACG,aAAa,IAAI,EAAE;MACzC3G,WAAW,EAAEwG,MAAM,CAACI,KAAK,IAAI,EAAE;MAC/B3G,WAAW,EAAEuG,MAAM,CAACK,KAAK,IAAI,EAAE;MAC/B3G,mBAAmB,EAAEsG,MAAM,CAACM,aAAa,IAAI,EAAE;MAC/C3G,UAAU,EAAEqG,MAAM,CAACO,IAAI,IAAI;IAC7B,CAAC,CAAC,CAAC;IACH5F,oBAAoB,CAAC,EAAE,CAAC;IACxBI,eAAe,CAAC,EAAE,CAAC;IACnBtD,OAAO,CAACE,GAAG,CAAC,oCAAoC,EAAEqI,MAAM,CAAC;IACzDvI,OAAO,CAACE,GAAG,CAAC,uCAAuC,EAAEqI,MAAM,CAACG,aAAa,CAAC;IAC1E1I,OAAO,CAACE,GAAG,CAAC,8CAA8C,EAAEqI,MAAM,CAACM,aAAa,CAAC;EACnF,CAAC;;EAED;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA,MAAME,iBAAiB,GAAGA,CAACC,KAAK,EAAEtE,KAAK,KAAK;IAC1C,IAAIuE,cAAc,GAAGvE,KAAK;;IAE1B;IACA,IAAI,CAAC,eAAe,EAAE,WAAW,EAAE,WAAW,EAAE,gBAAgB,EAAE,cAAc,EAAE,eAAe,EAAE,qBAAqB,EAAE,eAAe,CAAC,CAACwC,QAAQ,CAAC8B,KAAK,CAAC,EAAE;MAC1JC,cAAc,GAAGxE,cAAc,CAACC,KAAK,CAAC;IACxC;;IAEA;IACA,IAAIsE,KAAK,KAAK,UAAU,EAAE;MACxB5I,WAAW,CAACyH,IAAI,KAAK;QACnB,GAAGA,IAAI;QACPjH,QAAQ,EAAEqI,cAAc;QACxBpI,gBAAgB,EAAEoI,cAAc,KAAK,aAAa,GAAGpB,IAAI,CAAChH,gBAAgB,GAAG;MAC/E,CAAC,CAAC,CAAC;MACH,IAAI8C,WAAW,GAAG,CAAC,EAAEC,cAAc,CAAC,CAAC,CAAC;MACtC;IACF;IAEAxD,WAAW,CAACyH,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACmB,KAAK,GAAGC;IAAe,CAAC,CAAC,CAAC;;IAE3D;IACA,IAAI1F,UAAU,CAACyF,KAAK,CAAC,EAAE;MACrBxF,aAAa,CAACqE,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAE,CAACmB,KAAK,GAAG;MAAK,CAAC,CAAC,CAAC;IACrD;;IAEA;IACA,IAAIA,KAAK,KAAK,KAAK,IAAIC,cAAc,CAACjE,MAAM,KAAK,EAAE,IAAI,CAACjC,UAAU,EAAE;MAClEwE,SAAS,CAAC0B,cAAc,CAAC;IAC3B;;IAEA;IACA,IAAID,KAAK,KAAK,YAAY,EAAE;MAC1Bf,aAAa,CAACgB,cAAc,CAAC;IAC/B;;IAEA;IACA,IAAID,KAAK,KAAK,UAAU,IAAIrF,WAAW,GAAG,CAAC,EAAE;MAC3CC,cAAc,CAAC,CAAC,CAAC;IACnB;EACF,CAAC;;EAED;EACA,MAAMsF,oBAAoB,GAAIC,CAAC,IAAK;IAClC,MAAMC,KAAK,GAAG9E,KAAK,CAAC+E,IAAI,CAACF,CAAC,CAACG,MAAM,CAACF,KAAK,CAAC;IACxChJ,WAAW,CAACyH,IAAI,KAAK;MACnB,GAAGA,IAAI;MACPlF,SAAS,EAAE,CAAC,IAAIkF,IAAI,CAAClF,SAAS,IAAI,EAAE,CAAC,EAAE,GAAGyG,KAAK;IACjD,CAAC,CAAC,CAAC;IACHtF,gBAAgB,CAAC+D,IAAI,IAAK,CACxB,GAAGA,IAAI,EACP,GAAGuB,KAAK,CAACvD,GAAG,CAAC,CAAC0D,CAAC,EAAEC,CAAC,MAAM;MAAEC,SAAS,EAAG5B,IAAI,CAAC7C,MAAM,GAAGwE,CAAE;MAAEE,IAAI,EAAE;IAAG,CAAC,CAAC,CAAC,CACpE,CAAC;EACL,CAAC;EACD,MAAMC,oBAAoB,GAAIC,KAAK,IAAK;IACtCxJ,WAAW,CAACyH,IAAI,KAAK;MACnB,GAAGA,IAAI;MACPlF,SAAS,EAAEkF,IAAI,CAAClF,SAAS,CAAC8C,MAAM,CAAC,CAAC8D,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKI,KAAK;IACxD,CAAC,CAAC,CAAC;IACH9F,gBAAgB,CAAC+D,IAAI,IAAIA,IAAI,CAACpC,MAAM,CAACoE,GAAG,IAAIA,GAAG,CAACJ,SAAS,KAAKG,KAAK,CAAC,CAAC/D,GAAG,CAACgE,GAAG,KAAK;MAAE,GAAGA,GAAG;MAAEJ,SAAS,EAAEI,GAAG,CAACJ,SAAS,GAAGG,KAAK,GAAGC,GAAG,CAACJ,SAAS,GAAG,CAAC,GAAGI,GAAG,CAACJ;IAAU,CAAC,CAAC,CAAC,CAAC;EACtK,CAAC;EACD,MAAMK,wBAAwB,GAAGA,CAACL,SAAS,EAAEC,IAAI,KAAK;IACpD5F,gBAAgB,CAAC+D,IAAI,IAAI;MACvB,MAAMkC,KAAK,GAAGlC,IAAI,CAACmC,IAAI,CAACH,GAAG,IAAIA,GAAG,CAACJ,SAAS,KAAKA,SAAS,CAAC;MAC3D,IAAIM,KAAK,EAAE;QACT,OAAOlC,IAAI,CAAChC,GAAG,CAACgE,GAAG,IAAIA,GAAG,CAACJ,SAAS,KAAKA,SAAS,GAAG;UAAE,GAAGI,GAAG;UAAEH;QAAK,CAAC,GAAGG,GAAG,CAAC;MAC9E,CAAC,MAAM;QACL,OAAO,CAAC,GAAGhC,IAAI,EAAE;UAAE4B,SAAS;UAAEC;QAAK,CAAC,CAAC;MACvC;IACF,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMO,4BAA4B,GAAI1B,MAAM,IAAK;IAC/CnI,WAAW,CAACyH,IAAI,IAAI;MAClB,MAAMqC,OAAO,GAAG;QACd,GAAGrC,IAAI;QACPjG,UAAU,EAAE2G,MAAM,CAACC,IAAI,IAAI,EAAE;QAC7B3G,aAAa,EAAE0G,MAAM,CAACE,OAAO,IAAI,EAAE;QACnC1G,WAAW,EAAEwG,MAAM,CAACI,KAAK,IAAI,EAAE;QAC/B3G,WAAW,EAAEuG,MAAM,CAACK,KAAK,IAAI,EAAE;QAC/B9G,aAAa,EAAEyG,MAAM,CAACG,aAAa,IAAI,EAAE;QACzCzG,mBAAmB,EAAEsG,MAAM,CAACM,aAAa,IAAI,EAAE;QAC/C3G,UAAU,EAAEqG,MAAM,CAACO,IAAI,IAAI;MAC7B,CAAC;MACD,OAAOoB,OAAO;IAChB,CAAC,CAAC;EACJ,CAAC;EAED,MAAMC,YAAY,GAAGA,CAAA,KAAM;IACzB,MAAMC,MAAM,GAAG,CAAC,CAAC;IACjB,MAAM/C,cAAc,GAAGC,cAAc,CAACD,cAAc,IAAI,CAAC,KAAK,EAAE,UAAU,EAAE,kBAAkB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY,CAAC;IAEtIA,cAAc,CAACgD,OAAO,CAACrB,KAAK,IAAI;MAC9B,IAAI,CAAC7I,QAAQ,CAAC6I,KAAK,CAAC,IAAI7I,QAAQ,CAAC6I,KAAK,CAAC,CAACpE,QAAQ,CAAC,CAAC,CAACmB,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;QAChEqE,MAAM,CAACpB,KAAK,CAAC,GAAG,GAAGA,KAAK,CAACsB,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGvB,KAAK,CAAC/D,KAAK,CAAC,CAAC,CAAC,cAAc;MACjF;IACF,CAAC,CAAC;;IAEF;IACA,IAAI9E,QAAQ,CAACE,GAAG,IAAIF,QAAQ,CAACE,GAAG,CAAC2E,MAAM,KAAK,EAAE,EAAE;MAC9CoF,MAAM,CAAC/J,GAAG,GAAG,mCAAmC;IAClD;IAEA,IAAIF,QAAQ,CAACG,IAAI,KAAKH,QAAQ,CAACG,IAAI,GAAG,IAAI,IAAIH,QAAQ,CAACG,IAAI,GAAG,IAAIkK,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;MAC3FL,MAAM,CAAC9J,IAAI,GAAG,2BAA2B;IAC3C;IAEA,IAAIH,QAAQ,CAACM,OAAO,IAAIN,QAAQ,CAACM,OAAO,GAAG,CAAC,EAAE;MAC5C2J,MAAM,CAAC3J,OAAO,GAAG,4BAA4B;IAC/C;IAEA,IAAI6G,cAAc,CAACL,cAAc,IAAI9G,QAAQ,CAACe,aAAa,IAAIf,QAAQ,CAACe,aAAa,IAAI,CAAC,EAAE;MAC1FkJ,MAAM,CAAClJ,aAAa,GAAG,uCAAuC;IAChE;IAEAsC,aAAa,CAAC4G,MAAM,CAAC;IACrB,OAAOM,MAAM,CAACC,IAAI,CAACP,MAAM,CAAC,CAACpF,MAAM,KAAK,CAAC;EACzC,CAAC;EAED,MAAM4F,UAAU,GAAG,MAAAA,CAAOC,OAAO,GAAG,KAAK,KAAK;IAC5C,IAAI,CAACpL,WAAW,EAAE;MAChBuI,KAAK,CAAC,yCAAyC,CAAC;MAChDrI,QAAQ,CAAC,QAAQ,CAAC;MAClB;IACF;IACA,IAAI,CAACkL,OAAO,IAAI,CAACV,YAAY,CAAC,CAAC,EAAE;MAC/BnK,OAAO,CAACE,GAAG,CAAC,kCAAkC,EAAEqD,UAAU,CAAC;MAC3D;IACF;IAEAG,SAAS,CAAC,IAAI,CAAC;IAEf,IAAI;MACF;MACA1D,OAAO,CAACE,GAAG,CAAC,yBAAyB,EAAEC,QAAQ,CAAC;MAChD;MACA,MAAM2K,QAAQ,GAAG;QACfC,OAAO,EAAE,GAAG5K,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK,EAAE;QAC9DH,GAAG,EAAEF,QAAQ,CAACE,GAAG;QACjBC,IAAI,EAAE0K,QAAQ,CAAC7K,QAAQ,CAACG,IAAI,CAAC;QAC7BC,IAAI,EAAEJ,QAAQ,CAACI,IAAI;QACnBC,KAAK,EAAEL,QAAQ,CAACK,KAAK;QACrB2B,aAAa,EAAEhC,QAAQ,CAACgC,aAAa;QACrC8I,KAAK,EAAE9K,QAAQ,CAACO,aAAa;QAC7BA,aAAa,EAAEP,QAAQ,CAACO,aAAa;QAAE;QACvCC,aAAa,EAAER,QAAQ,CAACQ,aAAa;QAAE;QACvCF,OAAO,EAAEuK,QAAQ,CAAC7K,QAAQ,CAACM,OAAO,CAAC,IAAI,CAAC;QACxCS,aAAa,EAAEgK,UAAU,CAAC/K,QAAQ,CAACe,aAAa,CAAC,IAAI,CAAC;QACtDC,SAAS,EAAE+J,UAAU,CAAC/K,QAAQ,CAACgB,SAAS,CAAC,IAAI,CAAC;QAC9CC,SAAS,EAAE8J,UAAU,CAAC/K,QAAQ,CAACiB,SAAS,CAAC,IAAI,CAAC;QAC9CR,QAAQ,EAAET,QAAQ,CAACS,QAAQ,CAACsG,QAAQ,CAAC,QAAQ,CAAC,GAAG,QAAQ,GAAG,WAAW;QACvErG,gBAAgB,EAAEV,QAAQ,CAACU,gBAAgB;QAAE;QAC7CsK,MAAM,EAAE;UACN3C,IAAI,EAAErI,QAAQ,CAACyB,UAAU;UACzBwJ,IAAI,EAAEjL,QAAQ,CAACS,QAAQ,CAACsG,QAAQ,CAAC,SAAS,CAAC,GAAG,SAAS,GAAG,QAAQ;UAClEmE,OAAO,EAAE;YACPjG,OAAO,EAAEO,YAAY,CAACxF,QAAQ,CAAC2B,aAAa,CAAC;YAAE;YAC/C6G,KAAK,EAAExI,QAAQ,CAAC4B,WAAW;YAC3B6G,KAAK,EAAEzI,QAAQ,CAAC6B;UAClB,CAAC;UACD6G,aAAa,EAAE1I,QAAQ,CAAC8B,mBAAmB;UAC3C6G,IAAI,EAAE3I,QAAQ,CAAC+B;QACjB,CAAC;QACDpB,aAAa,EAAEX,QAAQ,CAACW,aAAa;QACrCE,aAAa,EAAEb,QAAQ,CAACa,aAAa;QACrCD,YAAY,EAAEZ,QAAQ,CAACY,YAAY,GAAG,IAAIyJ,IAAI,CAACrK,QAAQ,CAACY,YAAY,CAAC,GAAG,IAAIyJ,IAAI,CAAC,CAAC;QAClFvJ,YAAY,EAAE,eAAe;QAC7B2B,WAAW,EAAEnD,WAAW,CAAC+I,IAAI,IAAI,SAAS,CAAC;MAC7C,CAAC;MACD;MACAxI,OAAO,CAACE,GAAG,CAAC,oCAAoC,EAAE4K,QAAQ,CAAC;MAC3D;MACA,MAAMQ,YAAY,GAAG,MAAMvH,KAAK,CAAC,GAAGnE,QAAQ,YAAY,EAAE;QACxD6H,MAAM,EAAE,MAAM;QACd1H,OAAO,EAAEF,YAAY,CAAC,CAAC;QACvB6H,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACkD,QAAQ,CAAC;QAC9B9G,WAAW,EAAE;MACf,CAAC,CAAC;MACF;MACAhE,OAAO,CAACE,GAAG,CAAC,wCAAwC,EAAEoL,YAAY,CAACC,MAAM,CAAC;MAC1E,IAAI,CAACD,YAAY,CAACE,EAAE,EAAE;QACpB,MAAMC,GAAG,GAAG,MAAMH,YAAY,CAACnH,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACvDxE,OAAO,CAACE,GAAG,CAAC,uCAAuC,EAAEuL,GAAG,CAAC;QACzD,MAAM,IAAIC,KAAK,CAAC,uBAAuB,CAAC;MAC1C;MAEA,MAAMC,UAAU,GAAG,MAAML,YAAY,CAACnH,IAAI,CAAC,CAAC;MAC5C,MAAMyH,MAAM,GAAGD,UAAU,CAACE,IAAI,CAACC,GAAG;;MAElC;MACA,MAAMC,gBAAgB,GAAG,MAAMhI,KAAK,CAAC,GAAGnE,QAAQ,2BAA2BgM,MAAM,EAAE,EAAE;QACnFnE,MAAM,EAAE,MAAM;QACd1H,OAAO,EAAEF,YAAY,CAAC,CAAC;QACvB6H,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnB3B,SAAS,EAAE9F,QAAQ,CAACU,gBAAgB;UACpCS,cAAc,EAAE4J,UAAU,CAAC/K,QAAQ,CAACmB,cAAc,CAAC,IAAI,CAAC;UACxD0K,WAAW,EAAE7L,QAAQ,CAACgC,aAAa,CAAC;QACtC,CAAC,CAAC;QACF6B,WAAW,EAAE,SAAS,CAAC;MACzB,CAAC,CAAC;MAEF,IAAI,CAAC+H,gBAAgB,CAACP,EAAE,EAAE;QACxB,MAAMC,GAAG,GAAG,MAAMM,gBAAgB,CAAC5H,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC3D,MAAM,IAAIkH,KAAK,CAACD,GAAG,CAAC1D,KAAK,IAAI,6BAA6B,CAAC;MAC7D;MAEA,MAAMkE,cAAc,GAAG,MAAMF,gBAAgB,CAAC5H,IAAI,CAAC,CAAC;;MAEpD;MACA,IAAIhE,QAAQ,CAACwC,SAAS,IAAIxC,QAAQ,CAACwC,SAAS,CAACqC,MAAM,GAAG,CAAC,EAAE;QACvD,KAAK,IAAIwE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGrJ,QAAQ,CAACwC,SAAS,CAACqC,MAAM,EAAEwE,CAAC,EAAE,EAAE;UAClD,MAAM0C,IAAI,GAAG/L,QAAQ,CAACwC,SAAS,CAAC6G,CAAC,CAAC;UAClC,MAAM2C,OAAO,GAAGtI,aAAa,CAACmG,IAAI,CAACH,GAAG,IAAIA,GAAG,CAACJ,SAAS,KAAKD,CAAC,CAAC;UAC9D,MAAME,IAAI,GAAGyC,OAAO,GAAGA,OAAO,CAACzC,IAAI,GAAG,EAAE;UACxC,MAAM0C,YAAY,GAAG,WAAW;UAChC,MAAMC,IAAI,GAAG,IAAIC,QAAQ,CAAC,CAAC;UAC3BD,IAAI,CAACE,MAAM,CAAC,UAAU,EAAEL,IAAI,CAAC;UAC7B,IAAIxC,IAAI,EAAE2C,IAAI,CAACE,MAAM,CAAC,OAAO,EAAE7C,IAAI,CAAC;UACpC,IAAI;YACF,MAAM8C,SAAS,GAAG,MAAMzI,KAAK,CAAC,GAAGnE,QAAQ,yBAAyBgM,MAAM,cAAcQ,YAAY,SAAS,EAAE;cAC3G3E,MAAM,EAAE,MAAM;cACd1H,OAAO,EAAE;gBACP,eAAe,EAAEL,cAAc,CAAC,CAAC,CAAC,eAAe;cACnD,CAAC;cACDgI,IAAI,EAAE2E,IAAI;cACVrI,WAAW,EAAE;YACf,CAAC,CAAC;YACF,IAAI,CAACwI,SAAS,CAAChB,EAAE,EAAE;cACjB,MAAMC,GAAG,GAAG,MAAMe,SAAS,CAACrI,IAAI,CAAC,CAAC,CAACK,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;cACpDvF,KAAK,CAAC8I,KAAK,CAAC,oBAAoBmE,IAAI,CAAC1D,IAAI,KAAKiD,GAAG,CAAC1D,KAAK,IAAIyE,SAAS,CAACC,UAAU,EAAE,CAAC;YACpF,CAAC,MAAM;cACLxN,KAAK,CAACoF,OAAO,CAAC,YAAY6H,IAAI,CAAC1D,IAAI,EAAE,CAAC;YACxC;UACF,CAAC,CAAC,OAAOiD,GAAG,EAAE;YACZxM,KAAK,CAAC8I,KAAK,CAAC,mBAAmBmE,IAAI,CAAC1D,IAAI,KAAKiD,GAAG,CAACiB,OAAO,EAAE,CAAC;UAC7D;QACF;MACF;MACA;;MAEA1M,OAAO,CAACE,GAAG,CAAC,sCAAsC,EAAE+L,cAAc,CAAC;;MAEnE;MACA,MAAMU,cAAc,GAAG9B,OAAO,GAC1B,2BAA2B,GAC3B,4IAA4I;MAEhJ5L,KAAK,CAACoF,OAAO,CAACsI,cAAc,CAAC;;MAE7B;MACA,IAAI,CAAC9B,OAAO,EAAE;QACZ;QACAzK,WAAW,CAAC;UACVC,GAAG,EAAE,EAAE;UACPC,IAAI,EAAE,EAAE;UACRC,IAAI,EAAE,EAAE;UACRC,KAAK,EAAE,EAAE;UACTC,OAAO,EAAE,EAAE;UACXC,aAAa,EAAE,EAAE;UACjBC,aAAa,EAAE,EAAE;UACjBC,QAAQ,EAAE,EAAE;UACZC,gBAAgB,EAAE,EAAE;UACpBC,aAAa,EAAE,EAAE;UACjBC,YAAY,EAAE,EAAE;UAChBC,aAAa,EAAE,OAAO;UACtBC,YAAY,EAAE,iBAAiB;UAC/BC,aAAa,EAAE,EAAE;UACjBC,SAAS,EAAE,EAAE;UACbC,SAAS,EAAE,EAAE;UACbC,cAAc,EAAE,EAAE;UAClBC,cAAc,EAAE,EAAE;UAClBC,YAAY,EAAE,EAAE;UAChBC,mBAAmB,EAAE,EAAE;UACvBC,aAAa,EAAE,EAAE;UACjBC,mBAAmB,EAAE,EAAE;UACvBC,aAAa,EAAE,EAAE;UACjBC,UAAU,EAAE,EAAE;UACdC,aAAa,EAAE,EAAE;UACjBC,aAAa,EAAE,EAAE;UACjBC,WAAW,EAAE,EAAE;UACfC,WAAW,EAAE,EAAE;UACfC,mBAAmB,EAAE,EAAE;UACvBC,UAAU,EAAE,QAAQ;UACpBC,aAAa,EAAE,EAAE;UACjBC,kBAAkB,EAAE,EAAE;UACtBC,YAAY,EAAE,EAAE;UAChBC,gBAAgB,EAAE,KAAK;UACvBC,YAAY,EAAE,KAAK;UACnBC,oBAAoB,EAAE,KAAK;UAC3BC,eAAe,EAAE,KAAK;UACtBC,oBAAoB,EAAE,KAAK;UAC3BC,SAAS,EAAE,EAAE;UACbC,WAAW,EAAE;QACf,CAAC,CAAC;QACFgB,cAAc,CAAC,CAAC,CAAC;MACnB;IAEF,CAAC,CAAC,OAAOmE,KAAK,EAAE;MACd,IAAIA,KAAK,CAAC2E,OAAO,CAACxF,QAAQ,CAAC,KAAK,CAAC,IAAIa,KAAK,CAAC2E,OAAO,CAACxF,QAAQ,CAAC,gBAAgB,CAAC,EAAE;QAC7Ec,KAAK,CAAC,yDAAyD,CAAC;QAChErI,QAAQ,CAAC,QAAQ,CAAC;MACpB,CAAC,MAAM;QACLqI,KAAK,CAAC,sBAAsBD,KAAK,CAAC2E,OAAO,EAAE,CAAC;QAC5C1M,OAAO,CAACE,GAAG,CAAC,sBAAsB,EAAE6H,KAAK,CAAC;MAC5C;IACF,CAAC,SAAS;MACRrE,SAAS,CAAC,KAAK,CAAC;IAClB;EACF,CAAC;EAED,MAAMkJ,wBAAwB,GAAGA,CAAA,KAAM;IACrC,MAAMC,SAAS,GAAG;AACtB;AACA,WAAW1M,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK;AAC3D,OAAOL,QAAQ,CAACE,GAAG;AACnB,WAAWF,QAAQ,CAACgC,aAAa;AACjC,WAAWhC,QAAQ,CAACM,OAAO;AAC3B,YAAYN,QAAQ,CAACO,aAAa;AAClC,YAAYP,QAAQ,CAACQ,aAAa;AAClC;AACA;AACA,EAAER,QAAQ,CAACiC,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,EAAE3C,WAAW,CAAC+I,IAAI,EAAE;IAEhB,MAAMsE,UAAU,GAAG,kEAAkE3M,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACK,KAAK,SAAS2H,kBAAkB,CAAC0E,SAAS,CAAC,EAAE;IAC7KE,MAAM,CAACC,IAAI,CAACF,UAAU,CAAC;EACzB,CAAC;;EAED;EACA;;EAEA,MAAMG,mBAAmB,GAAGA,CAAA,kBAC1B9N,OAAA;IAAK+N,SAAS,EAAC,MAAM;IAAAC,QAAA,eACnBhO,OAAA;MAAK+N,SAAS,EAAC,mCAAmC;MAAAC,QAAA,EAC/C7I,KAAK,CAAC+E,IAAI,CAAC;QAAErE,MAAM,EAAEoI;MAAW,CAAC,EAAE,CAAC7D,CAAC,EAAEK,KAAK,KAAK;QAChD,MAAMyD,UAAU,GAAGzD,KAAK,GAAG,CAAC;QAC5B,MAAM0D,QAAQ,GAAG3J,WAAW,KAAK0J,UAAU;QAC3C,MAAME,WAAW,GAAG5J,WAAW,GAAG0J,UAAU;QAE5C,IAAIG,SAAS,GAAG,EAAE;QAClB,IAAIC,eAAe,GAAG,EAAE;QAExB,IAAIJ,UAAU,KAAK,CAAC,EAAE;UACpBG,SAAS,GAAG,qBAAqB;UACjCC,eAAe,GAAG,gDAAgD;QACpE,CAAC,MAAM,IAAIJ,UAAU,KAAK,CAAC,EAAE;UAC3BG,SAAS,GAAG,oBAAoB;UAChCC,eAAe,GAAG,0CAA0C;QAC9D,CAAC,MAAM,IAAIJ,UAAU,KAAK,CAAC,IAAI/F,cAAc,CAACL,cAAc,EAAE;UAC5DuG,SAAS,GAAG,uBAAuB;UACnCC,eAAe,GAAG,iCAAiC;QACrD,CAAC,MAAM,IAAKJ,UAAU,KAAK,CAAC,IAAI,CAAC/F,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IACnFkG,UAAU,KAAK,CAAC,IAAI/F,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAe,EAAE;UAC/FqG,SAAS,GAAG,oBAAoB;UAChCC,eAAe,GAAG,gCAAgC;QACpD,CAAC,MAAM,IAAKJ,UAAU,KAAK,CAAC,IAAI,CAAC/F,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAiB,IACxHiG,UAAU,KAAK,CAAC,IAAI/F,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAkB,IACxHiG,UAAU,KAAK,CAAC,IAAI/F,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAkB,EAAE;UACnIoG,SAAS,GAAG,uBAAuB;UACnCC,eAAe,GAAG,sCAAsC;QAC1D;QAEA,oBACEtO,OAAA;UAAsB+N,SAAS,EAAC,mBAAmB;UAAAC,QAAA,gBACjDhO,OAAA;YAAK+N,SAAS,EAAE,sFACdI,QAAQ,GACJ,wCAAwC,GACxCC,WAAW,GACT,0CAA0C,GAC1C,2CAA2C,EAChD;YAAAJ,QAAA,EACAI,WAAW,gBACVpO,OAAA,CAACnB,WAAW;cAACkP,SAAS,EAAC;YAAS;cAAAQ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,gBAEnC1O,OAAA;cAAM+N,SAAS,EAAC,qBAAqB;cAAAC,QAAA,EAAEE;YAAU;cAAAK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO;UACzD;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eACN1O,OAAA;YAAK+N,SAAS,EAAC,MAAM;YAAAC,QAAA,gBACnBhO,OAAA;cAAG+N,SAAS,EAAE,uBAAuBI,QAAQ,GAAG,YAAY,GAAG,eAAe,EAAG;cAAAH,QAAA,EAC9EK;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACT,CAAC,eACJ1O,OAAA;cAAG+N,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAEM;YAAe;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvD,CAAC,EACLR,UAAU,GAAGD,UAAU,iBACtBjO,OAAA;YAAK+N,SAAS,EAAE,mBAAmBK,WAAW,GAAG,cAAc,GAAG,aAAa;UAAG;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CACrF;QAAA,GAtBOR,UAAU;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAuBf,CAAC;MAEV,CAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CACN;EAED,MAAMC,eAAe,GAAGA,CAACnH,KAAK,EAAEqC,KAAK,EAAEoC,IAAI,GAAG,MAAM,EAAE2C,OAAO,GAAG,IAAI,EAAEC,QAAQ,GAAG,KAAK,EAAEC,IAAI,GAAG,IAAI,EAAEC,aAAa,GAAG,KAAK,KAAK;IAC7H,oBACE/O,OAAA;MAAK+N,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxBhO,OAAA;QAAO+N,SAAS,EAAC,qDAAqD;QAAAC,QAAA,GACnEc,IAAI,iBAAIxQ,KAAK,CAAC0Q,aAAa,CAACF,IAAI,EAAE;UAAEf,SAAS,EAAE;QAAe,CAAC,CAAC,EAChEvG,KAAK,EACLqH,QAAQ,iBAAI7O,OAAA;UAAM+N,SAAS,EAAC,mBAAmB;UAAAC,QAAA,EAAC;QAAC;UAAAO,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpD,CAAC,EAEPzC,IAAI,KAAK,QAAQ,gBAChBjM,OAAA;QACEuF,KAAK,EAAEvE,QAAQ,CAAC6I,KAAK,CAAE;QACvBoF,QAAQ,EAAGjF,CAAC,IAAKJ,iBAAiB,CAACC,KAAK,EAAEG,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAE;QAC1DwI,SAAS,EAAE,wJACT3J,UAAU,CAACyF,KAAK,CAAC,GAAG,gBAAgB,GAAG,uCAAuC,EAC7E;QAAAmE,QAAA,gBAEHhO,OAAA;UAAQuF,KAAK,EAAC,EAAE;UAAAyI,QAAA,GAAC,SAAO,EAACxG,KAAK;QAAA;UAAA+G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAS,CAAC,EACvCE,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAElI,GAAG,CAACwI,MAAM,iBAClBlP,OAAA;UAA2BuF,KAAK,EAAE2J,MAAM,CAAC3J,KAAM;UAACwI,SAAS,EAAC,aAAa;UAAAC,QAAA,EACpEkB,MAAM,CAAC1H;QAAK,GADF0H,MAAM,CAAC3J,KAAK;UAAAgJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAEjB,CACT,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACI,CAAC,GACPzC,IAAI,KAAK,UAAU,gBACrBjM,OAAA;QACEuF,KAAK,EAAEvE,QAAQ,CAAC6I,KAAK,CAAE;QACvBoF,QAAQ,EAAGjF,CAAC,IAAKJ,iBAAiB,CAACC,KAAK,EAAEG,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAE;QAC1D4J,IAAI,EAAE,CAAE;QACRC,WAAW,EAAE,SAAS5H,KAAK,CAAC6H,WAAW,CAAC,CAAC,KAAM;QAC/CtB,SAAS,EAAE,oKACT3J,UAAU,CAACyF,KAAK,CAAC,GAAG,gBAAgB,GAAG,uCAAuC;MAC7E;QAAA0E,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,GACAzC,IAAI,KAAK,UAAU,gBACrBjM,OAAA;QAAO+N,SAAS,EAAC,4CAA4C;QAAAC,QAAA,gBAC3DhO,OAAA;UACEiM,IAAI,EAAC,UAAU;UACfqD,OAAO,EAAE,CAAC,CAACtO,QAAQ,CAAC6I,KAAK,CAAE;UAC3BoF,QAAQ,EAAGjF,CAAC,IAAKJ,iBAAiB,CAACC,KAAK,EAAEG,CAAC,CAACG,MAAM,CAACmF,OAAO,CAAE;UAC5DvB,SAAS,EAAC;QAAuE;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClF,CAAC,eACF1O,OAAA;UAAM+N,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAExG;QAAK;UAAA+G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC,gBAER1O,OAAA;QAAK+N,SAAS,EAAC,UAAU;QAAAC,QAAA,GACtB,CAAC,eAAe,EAAE,WAAW,EAAE,WAAW,EAAE,gBAAgB,EAAE,cAAc,EAAE,eAAe,EAAE,qBAAqB,EAAE,eAAe,CAAC,CAACjG,QAAQ,CAAC8B,KAAK,CAAC,iBACrJ7J,OAAA;UAAK+N,SAAS,EAAC,0EAA0E;UAAAC,QAAA,EAAC;QAAC;UAAAO,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CACjG,eACD1O,OAAA;UACEiM,IAAI,EAAEA,IAAK;UACX1G,KAAK,EAAEvE,QAAQ,CAAC6I,KAAK,CAAC,IAAI,EAAG;UAC7BoF,QAAQ,EAAGjF,CAAC,IAAK;YACfJ,iBAAiB,CAACC,KAAK,EAAEG,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAC;YACxC,IAAIwJ,aAAa,IAAIlF,KAAK,KAAK,YAAY,EAAEX,kBAAkB,CAACc,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAC;YAC/E;YACA,IAAI,CAACwJ,aAAa,IAAIlF,KAAK,KAAK,YAAY,IAAI,CAAC,CAAC,WAAW,EAAC,gBAAgB,EAAC,aAAa,CAAC,CAAC9B,QAAQ,CAAC/G,QAAQ,CAACS,QAAQ,CAAC,EAAEqH,aAAa,CAACkB,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAC;UAC1J,CAAE;UACF6J,WAAW,EAAE,SAAS5H,KAAK,CAAC6H,WAAW,CAAC,CAAC,KAAM;UAC/CtB,SAAS,EAAE,wJACT3J,UAAU,CAACyF,KAAK,CAAC,GAAG,gBAAgB,GAAG,uCAAuC,IAC5EA,KAAK,KAAK,KAAK,GAAG,OAAO,GAAG,EAAE,IAAI,CAAC,eAAe,EAAE,WAAW,EAAE,WAAW,EAAE,gBAAgB,EAAE,cAAc,EAAE,eAAe,EAAE,qBAAqB,EAAE,eAAe,CAAC,CAAC9B,QAAQ,CAAC8B,KAAK,CAAC,GAAG,MAAM,GAAG,EAAE;QAAG;UAAA0E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9M,CAAC,EAED7E,KAAK,KAAK,KAAK,IAAI7I,QAAQ,CAACE,GAAG,CAAC2E,MAAM,KAAK,EAAE,iBAC5C7F,OAAA;UAAK+N,SAAS,EAAC,qDAAqD;UAAAC,QAAA,EACjEtK,WAAW,gBACV1D,OAAA,CAAClB,OAAO;YAACiP,SAAS,EAAC;UAAoC;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,GACxD9K,UAAU,gBACZ5D,OAAA,CAACnB,WAAW;YAACkP,SAAS,EAAC;UAAwB;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAElD1O,OAAA;YACEuP,OAAO,EAAEA,CAAA,KAAMnH,SAAS,CAACpH,QAAQ,CAACE,GAAG,CAAE;YACvC6M,SAAS,EAAC,sFAAsF;YAAAC,QAAA,EACjG;UAED;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ;QACT;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CACN,EAGAK,aAAa,IAAIlF,KAAK,KAAK,YAAY,IAAI7F,sBAAsB,CAAC6B,MAAM,GAAG,CAAC,iBAC3E7F,OAAA;UAAK+N,SAAS,EAAC,6HAA6H;UAAAC,QAAA,EACzIhK,sBAAsB,CAAC0C,GAAG,CAAC0C,MAAM,iBAChCpJ,OAAA;YAEE+N,SAAS,EAAC,+EAA+E;YACzFwB,OAAO,EAAEA,CAAA,KAAM;cACbtO,WAAW,CAACyH,IAAI;gBAAA,IAAA8G,eAAA;gBAAA,OAAK;kBACnB,GAAG9G,IAAI;kBACP+G,UAAU,EAAErG,MAAM,CAACC,IAAI;kBACvBqG,aAAa,EAAEtG,MAAM,CAACE,OAAO;kBAC7BqG,WAAW,EAAEvG,MAAM,CAACI,KAAK;kBACzBoG,WAAW,EAAE,EAAAJ,eAAA,GAAApG,MAAM,CAAC8C,OAAO,cAAAsD,eAAA,uBAAdA,eAAA,CAAgB/F,KAAK,KAAIL,MAAM,CAACK,KAAK,IAAI,EAAE;kBACxDoG,aAAa,EAAEzG,MAAM,CAAC0G,QAAQ,IAAI1G,MAAM,CAACnD,OAAO,IAAI;gBACtD,CAAC;cAAA,CAAC,CAAC;cACHhC,yBAAyB,CAAC,EAAE,CAAC;YAC/B,CAAE;YAAA+J,QAAA,gBAEFhO,OAAA;cAAK+N,SAAS,EAAC,wBAAwB;cAAAC,QAAA,EAAE5E,MAAM,CAACC;YAAI;cAAAkF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3D1O,OAAA;cAAK+N,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAE5E,MAAM,CAACE,OAAO,EAAC,UAAG,EAACF,MAAM,CAAC0G,QAAQ;YAAA;cAAAvB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA,GAf5EtF,MAAM,CAAC2G,EAAE;YAAAxB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAgBX,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACN,EAEA,CAACK,aAAa,IAAIlF,KAAK,KAAK,YAAY,IAAI,CAAC,CAAC,WAAW,EAAC,gBAAgB,EAAC,aAAa,CAAC,CAAC9B,QAAQ,CAAC/G,QAAQ,CAACS,QAAQ,CAAC,IAAIqC,iBAAiB,CAAC+B,MAAM,GAAG,CAAC,iBACpJ7F,OAAA;UAAK+N,SAAS,EAAC,6HAA6H;UAAAC,QAAA,EACzIlK,iBAAiB,CAAC4C,GAAG,CAAC0C,MAAM,iBAC3BpJ,OAAA;YAEE+N,SAAS,EAAC,+EAA+E;YACzFwB,OAAO,EAAEA,CAAA,KAAM;cACbzE,4BAA4B,CAAC1B,MAAM,CAAC;cACpCrF,oBAAoB,CAAC,EAAE,CAAC;YAC1B,CAAE;YAAAiK,QAAA,gBAEFhO,OAAA;cAAK+N,SAAS,EAAC,wBAAwB;cAAAC,QAAA,EAAE5E,MAAM,CAACC;YAAI;cAAAkF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3D1O,OAAA;cAAK+N,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAE5E,MAAM,CAACE,OAAO,EAAC,UAAG,EAACF,MAAM,CAAC0G,QAAQ;YAAA;cAAAvB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA,GAR5EtF,MAAM,CAAC2G,EAAE;YAAAxB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OASX,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CACN,EAEAtK,UAAU,CAACyF,KAAK,CAAC,iBAChB7J,OAAA;QAAK+N,SAAS,EAAC,wCAAwC;QAAAC,QAAA,gBACrDhO,OAAA,CAACN,WAAW;UAACqO,SAAS,EAAC;QAAc;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,EACvCtK,UAAU,CAACyF,KAAK,CAAC;MAAA;QAAA0E,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACf,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAEV,CAAC;EAED,MAAMsB,UAAU,GAAGA,CAAA,KAAM;IACvB,QAAQxL,WAAW;MACjB,KAAK,CAAC;QACJ,oBACExE,OAAA;UAAK+N,SAAS,EAAC,WAAW;UAAAC,QAAA,gBAExBhO,OAAA;YAAK+N,SAAS,EAAC,kDAAkD;YAAAC,QAAA,gBAC/DhO,OAAA;cAAI+N,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAmB;cAAAO,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,EAC3EC,eAAe,CAAC,WAAW,EAAE,UAAU,EAAE,QAAQ,EAAEpH,SAAS,EAAE,IAAI,EAAE9I,GAAG,CAAC,eACzEuB,OAAA;cAAK+N,SAAS,EAAC,MAAM;cAAAC,QAAA,EAClBW,eAAe,CAAC,aAAa,EAAE,kBAAkB,EAAE,QAAQ,EAAEhH,mBAAmB,EAAE,IAAI;YAAC;cAAA4G,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrF,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAEN1O,OAAA;YAAK+N,SAAS,EAAC,kDAAkD;YAAAC,QAAA,gBAC/DhO,OAAA;cAAI+N,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAmB;cAAAO,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC5E1O,OAAA;cAAK+N,SAAS,EAAC,uCAAuC;cAAAC,QAAA,gBACpDhO,OAAA;gBAAK+N,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAC3BW,eAAe,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAEtP,IAAI;cAAC;gBAAAkP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrD,CAAC,EACLC,eAAe,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE5P,QAAQ,CAAC,EAC/D4P,eAAe,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,EACnDA,eAAe,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,EACrDA,eAAe,CAAC,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAEpP,KAAK,CAAC,EACnEoP,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAErP,OAAO,CAAC,EAChFqP,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAErP,OAAO,CAAC;YAAA;cAAAiP,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC9E,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAGV,KAAK,CAAC;QACJ,oBACE1O,OAAA;UAAK+N,SAAS,EAAC,WAAW;UAAAC,QAAA,eAExBhO,OAAA;YAAK+N,SAAS,EAAC,kDAAkD;YAAAC,QAAA,gBAC/DhO,OAAA;cAAI+N,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAkB;cAAAO,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC3E1O,OAAA;cAAK+N,SAAS,EAAC,uCAAuC;cAAAC,QAAA,GACnDW,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,QAAQ,EAAElH,cAAc,EAAE,IAAI,EAAEzI,UAAU,CAAC,EAC9F2P,eAAe,CAAC,oBAAoB,EAAE,cAAc,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE5P,QAAQ,CAAC,EACnF4P,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,QAAQ,EAAEjH,cAAc,EAAE,IAAI,CAAC,EAClFiH,eAAe,CAAC,iBAAiB,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAEtP,IAAI,CAAC,EAC9EsP,eAAe,CAAC,aAAa,EAAE,aAAa,EAAE,QAAQ,EAAE/G,kBAAkB,EAAE,IAAI,EAAE3I,IAAI,CAAC;YAAA;cAAAsP,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrF,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAEV,KAAK,CAAC;QACJ,OAAOvG,cAAc,CAACL,cAAc,gBAClC9H,OAAA;UAAK+N,SAAS,EAAC,kDAAkD;UAAAC,QAAA,gBAC/DhO,OAAA;YAAI+N,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAAqB;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EAC7E1N,QAAQ,CAACU,gBAAgB,KAAK,MAAM,gBACnC1B,OAAA;YAAK+N,SAAS,EAAC,WAAW;YAAAC,QAAA,GACvBW,eAAe,CAACrH,aAAa,CAACN,kBAAkB,EAAE,eAAe,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAEhI,UAAU,CAAC,EACpG2P,eAAe,CAAC,eAAe,EAAE,cAAc,EAAE,QAAQ,CAAC,EAC1DA,eAAe,CAAC,uBAAuB,EAAE,qBAAqB,EAAE,MAAM,CAAC,EACvEA,eAAe,CAAC,wBAAwB,EAAE,qBAAqB,EAAE,QAAQ,CAAC,EAC1EA,eAAe,CAAC,kBAAkB,EAAE,eAAe,EAAE,QAAQ,CAAC;UAAA;YAAAJ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5D,CAAC,gBAEN1O,OAAA;YAAK+N,SAAS,EAAC,uCAAuC;YAAAC,QAAA,gBAEpDhO,OAAA;cAAK+N,SAAS,EAAC,WAAW;cAAAC,QAAA,GACvBW,eAAe,CAACrH,aAAa,CAACN,kBAAkB,EAAE,eAAe,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAEhI,UAAU,CAAC,EACpG2P,eAAe,CAAC,YAAY,EAAE,WAAW,EAAE,QAAQ,CAAC,EACpDA,eAAe,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,QAAQ,CAAC,EAC9DA,eAAe,CAAC,YAAY,EAAE,WAAW,EAAE,QAAQ,CAAC,EAEpD,CAAC,WAAW,EAAC,WAAW,EAAC,WAAW,EAAC,cAAc,CAAC,CAAC5G,QAAQ,CAAC/G,QAAQ,CAACU,gBAAgB,CAAC,GACrFiN,eAAe,CAAC,qBAAqB,EAAE,gBAAgB,EAAE,QAAQ,CAAC,GAClE,IAAI;YAAA;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL,CAAC,eAEN1O,OAAA;cAAK+N,SAAS,EAAC,WAAW;cAAAC,QAAA,GACvBW,eAAe,CAAC,eAAe,EAAE,cAAc,EAAE,QAAQ,CAAC,EAC1DA,eAAe,CAAC,uBAAuB,EAAE,qBAAqB,EAAE,MAAM,CAAC,EACvEA,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,QAAQ,CAAC,EAC5DA,eAAe,CAAC,wBAAwB,EAAE,qBAAqB,EAAE,QAAQ,CAAC,EAC1EA,eAAe,CAAC,kBAAkB,EAAE,eAAe,EAAE,QAAQ,CAAC;YAAA;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC5D,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC,gBAEN1O,OAAA;UAAK+N,SAAS,EAAC,mBAAmB;UAAAC,QAAA,gBAChChO,OAAA,CAAChB,UAAU;YAAC+O,SAAS,EAAC;UAAsC;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC/D1O,OAAA;YAAI+N,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAAkC;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC3F1O,OAAA;YAAG+N,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAsD;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpF,CACN;MAEH,KAAK,CAAC;QACJ;QACA,IAAI1N,QAAQ,CAACS,QAAQ,KAAK,gBAAgB,IAAIT,QAAQ,CAACU,gBAAgB,KAAK,UAAU,EAAE;UACtF,oBACE1B,OAAA;YAAK+N,SAAS,EAAC,6DAA6D;YAAAC,QAAA,gBAC1EhO,OAAA;cAAAgO,QAAA,gBACEhO,OAAA;gBAAI+N,SAAS,EAAC,qCAAqC;gBAAAC,QAAA,EAAC;cAAmB;gBAAAO,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC5E1O,OAAA;gBAAK+N,SAAS,EAAC,uCAAuC;gBAAAC,QAAA,GACnDW,eAAe,CAAC,aAAa,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE1P,IAAI,EAAE,IAAI,CAAC,EAC5E0P,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,CAAC,EAC1DA,eAAe,CAAC,cAAc,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAExP,KAAK,CAAC,EACzEwP,eAAe,CAAC,cAAc,EAAE,aAAa,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAEvP,IAAI,CAAC,EAC1EuP,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAEzP,MAAM,CAAC;cAAA;gBAAAqP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7E,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACN1O,OAAA;cAAAgO,QAAA,gBACEhO,OAAA;gBAAI+N,SAAS,EAAC,qCAAqC;gBAAAC,QAAA,EAAC;cAAoB;gBAAAO,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC7E1O,OAAA;gBAAK+N,SAAS,EAAC,uCAAuC;gBAAAC,QAAA,GACnDW,eAAe,CAAC,aAAa,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE1P,IAAI,CAAC,EACtE0P,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,CAAC,EAC1DA,eAAe,CAAC,cAAc,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAExP,KAAK,CAAC,EACzEwP,eAAe,CAAC,cAAc,EAAE,aAAa,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAEvP,IAAI,CAAC,EAC1EuP,eAAe,CAAC,gBAAgB,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAEzP,MAAM,CAAC,EAC/EyP,eAAe,CAAC,kBAAkB,EAAE,qBAAqB,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAEtP,IAAI,CAAC,eAGtFW,OAAA;kBAAK+N,SAAS,EAAC,eAAe;kBAAAC,QAAA,gBAC5BhO,OAAA;oBAAO+N,SAAS,EAAC,2CAA2C;oBAAAC,QAAA,EAAC;kBAE7D;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC,eACR1O,OAAA;oBAAK+N,SAAS,EAAC,gBAAgB;oBAAAC,QAAA,gBAC7BhO,OAAA;sBACEiM,IAAI,EAAC,QAAQ;sBACbsD,OAAO,EAAEA,CAAA,KAAM3F,iBAAiB,CAAC,YAAY,EAAE,QAAQ,CAAE;sBACzDmE,SAAS,EAAE,iDACT/M,QAAQ,CAAC+B,UAAU,KAAK,QAAQ,GAC5B,sCAAsC,GACtC,0DAA0D,EAC7D;sBAAAiL,QAAA,EACJ;oBAED;sBAAAO,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,eACT1O,OAAA;sBACEiM,IAAI,EAAC,QAAQ;sBACbsD,OAAO,EAAEA,CAAA,KAAM3F,iBAAiB,CAAC,YAAY,EAAE,QAAQ,CAAE;sBACzDmE,SAAS,EAAE,iDACT/M,QAAQ,CAAC+B,UAAU,KAAK,QAAQ,GAC5B,0CAA0C,GAC1C,0DAA0D,EAC7D;sBAAAiL,QAAA,EACJ;oBAED;sBAAAO,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACN,CAAC,eACN1O,OAAA;oBAAG+N,SAAS,EAAC,4BAA4B;oBAAAC,QAAA,EAAC;kBAE1C;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAG,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAEV,CAAC,MAAM;UACL,MAAM3H,UAAU,GAAG/F,QAAQ,CAACS,QAAQ,KAAK,WAAW;UACpD,oBACEzB,OAAA;YAAK+N,SAAS,EAAC,kDAAkD;YAAAC,QAAA,gBAC/DhO,OAAA;cAAI+N,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAE1G,aAAa,CAACJ;YAAkB;cAAAqH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAC3F1O,OAAA;cAAK+N,SAAS,EAAC,uCAAuC;cAAAC,QAAA,gBACpDhO,OAAA;gBAAK+N,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAC3BW,eAAe,CAACrH,aAAa,CAACL,WAAW,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAEhI,IAAI;cAAC;gBAAAsP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChF,CAAC,EACLC,eAAe,CAACrH,aAAa,CAACH,YAAY,EAAE,eAAe,EAAE,MAAM,CAAC,EACpEwH,eAAe,CAAC,OAAO,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAExP,KAAK,CAAC,EAClEwP,eAAe,CAAC,OAAO,EAAE,aAAa,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAEvP,IAAI,CAAC,EACnEuP,eAAe,CAACrH,aAAa,CAACD,YAAY,EAAE,eAAe,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAEnI,MAAM,CAAC,EAGzF,CAAC6H,UAAU,iBACV/G,OAAA,CAAAE,SAAA;gBAAA8N,QAAA,gBACEhO,OAAA;kBAAAgO,QAAA,gBACEhO,OAAA;oBAAOiQ,OAAO,EAAC,uBAAuB;oBAAClC,SAAS,EAAC,8CAA8C;oBAAAC,QAAA,EAAC;kBAAqB;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC,eAC7H1O,OAAA;oBACEiM,IAAI,EAAC,MAAM;oBACX8D,EAAE,EAAC,uBAAuB;oBAC1BxK,KAAK,EAAEvE,QAAQ,CAAC8B,mBAAmB,IAAI,EAAG;oBAC1CmM,QAAQ,EAAEjF,CAAC,IAAIJ,iBAAiB,CAAC,qBAAqB,EAAEI,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAE;oBACxEwI,SAAS,EAAC;kBAAwJ;oBAAAQ,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACnK,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACC,CAAC,eAGN1O,OAAA;kBAAK+N,SAAS,EAAC,eAAe;kBAAAC,QAAA,gBAC5BhO,OAAA;oBAAO+N,SAAS,EAAC,2CAA2C;oBAAAC,QAAA,EAAC;kBAE7D;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC,eACR1O,OAAA;oBAAK+N,SAAS,EAAC,gBAAgB;oBAAAC,QAAA,gBAC7BhO,OAAA;sBACEiM,IAAI,EAAC,QAAQ;sBACbsD,OAAO,EAAEA,CAAA,KAAM3F,iBAAiB,CAAC,YAAY,EAAE,QAAQ,CAAE;sBACzDmE,SAAS,EAAE,iDACT/M,QAAQ,CAAC+B,UAAU,KAAK,QAAQ,GAC5B,sCAAsC,GACtC,0DAA0D,EAC7D;sBAAAiL,QAAA,EACJ;oBAED;sBAAAO,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,eACT1O,OAAA;sBACEiM,IAAI,EAAC,QAAQ;sBACbsD,OAAO,EAAEA,CAAA,KAAM3F,iBAAiB,CAAC,YAAY,EAAE,QAAQ,CAAE;sBACzDmE,SAAS,EAAE,iDACT/M,QAAQ,CAAC+B,UAAU,KAAK,QAAQ,GAC5B,0CAA0C,GAC1C,0DAA0D,EAC7D;sBAAAiL,QAAA,EACJ;oBAED;sBAAAO,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACN,CAAC,eACN1O,OAAA;oBAAG+N,SAAS,EAAC,4BAA4B;oBAAAC,QAAA,EAAC;kBAE1C;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAG,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD,CAAC;cAAA,eACN,CACH,EAGA3H,UAAU,iBACT/G,OAAA;gBAAAgO,QAAA,gBACEhO,OAAA;kBAAOiQ,OAAO,EAAC,uBAAuB;kBAAClC,SAAS,EAAC,8CAA8C;kBAAAC,QAAA,EAAC;gBAA8B;kBAAAO,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACtI1O,OAAA;kBACEiM,IAAI,EAAC,MAAM;kBACX8D,EAAE,EAAC,uBAAuB;kBAC1BxK,KAAK,EAAEvE,QAAQ,CAAC8B,mBAAmB,IAAI,EAAG;kBAC1CmM,QAAQ,EAAEjF,CAAC,IAAIJ,iBAAiB,CAAC,qBAAqB,EAAEI,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAE;kBACxE6J,WAAW,EAAC,uCAAuC;kBACnDrB,SAAS,EAAC;gBAAwJ;kBAAAQ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnK,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CACN;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAEV;MAEF,KAAK,CAAC;QACJ,OAAOvG,cAAc,CAACF,iBAAiB,gBACrCjI,OAAA;UAAK+N,SAAS,EAAC,kDAAkD;UAAAC,QAAA,gBAC/DhO,OAAA;YAAI+N,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAAqB;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC9E1O,OAAA;YAAK+N,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBhO,OAAA;cAAK+N,SAAS,EAAC,uCAAuC;cAAAC,QAAA,gBACpDhO,OAAA;gBAAK+N,SAAS,EAAC,WAAW;gBAAAC,QAAA,gBACxBhO,OAAA;kBAAI+N,SAAS,EAAC,qCAAqC;kBAAAC,QAAA,EAAC;gBAAoB;kBAAAO,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,EAC5EC,eAAe,CAAC,mBAAmB,EAAE,kBAAkB,EAAE,UAAU,CAAC,EACpEA,eAAe,CAAC,eAAe,EAAE,cAAc,EAAE,UAAU,CAAC,EAC5DA,eAAe,CAAC,wBAAwB,EAAE,sBAAsB,EAAE,UAAU,CAAC,EAC7EA,eAAe,CAAC,kBAAkB,EAAE,iBAAiB,EAAE,UAAU,CAAC,EAClEA,eAAe,CAAC,wBAAwB,EAAE,sBAAsB,EAAE,UAAU,CAAC;cAAA;gBAAAJ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC3E,CAAC,eACN1O,OAAA;gBAAK+N,SAAS,EAAC,WAAW;gBAAAC,QAAA,GACvBW,eAAe,CAAC,qBAAqB,EAAE,oBAAoB,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAEnP,IAAI,CAAC,eAE5FQ,OAAA;kBAAAgO,QAAA,gBACEhO,OAAA;oBAAO+N,SAAS,EAAC,2CAA2C;oBAAAC,QAAA,EAAC;kBAAuB;oBAAAO,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC,eAC5F1O,OAAA;oBACEiM,IAAI,EAAC,MAAM;oBACXiE,QAAQ;oBACRC,MAAM,EAAC,yBAAyB;oBAChClB,QAAQ,EAAElF,oBAAqB;oBAC/BgE,SAAS,EAAC;kBAAwL;oBAAAQ,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACnM,CAAC,EAED1N,QAAQ,CAACwC,SAAS,IAAIxC,QAAQ,CAACwC,SAAS,CAACqC,MAAM,GAAG,CAAC,iBAClD7F,OAAA;oBAAK+N,SAAS,EAAC,gBAAgB;oBAAAC,QAAA,EAC5BhN,QAAQ,CAACwC,SAAS,CAACkD,GAAG,CAAC,CAACqG,IAAI,EAAE1C,CAAC;sBAAA,IAAA+F,mBAAA;sBAAA,oBAC9BpQ,OAAA;wBAAa+N,SAAS,EAAC,qDAAqD;wBAAAC,QAAA,GACzEjB,IAAI,CAACd,IAAI,IAAIc,IAAI,CAACd,IAAI,CAACoE,UAAU,CAAC,OAAO,CAAC,gBACzCrQ,OAAA;0BAAKsQ,GAAG,EAAEC,GAAG,CAACC,eAAe,CAACzD,IAAI,CAAE;0BAAC0D,GAAG,EAAE1D,IAAI,CAAC1D,IAAK;0BAAC0E,SAAS,EAAC;wBAAgC;0BAAAQ,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAE,CAAC,gBAElG1O,OAAA;0BAAM+N,SAAS,EAAC,wFAAwF;0BAAAC,QAAA,EAAC;wBAAG;0BAAAO,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAM,CACnH,eACD1O,OAAA;0BAAM+N,SAAS,EAAC,sCAAsC;0BAAAC,QAAA,EAAEjB,IAAI,CAAC1D;wBAAI;0BAAAkF,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAO,CAAC,eACzE1O,OAAA;0BACEiM,IAAI,EAAC,MAAM;0BACX1G,KAAK,EAAE,EAAA6K,mBAAA,GAAA1L,aAAa,CAACmG,IAAI,CAACH,GAAG,IAAIA,GAAG,CAACJ,SAAS,KAAKD,CAAC,CAAC,cAAA+F,mBAAA,uBAA9CA,mBAAA,CAAgD7F,IAAI,KAAI,EAAG;0BAClE0E,QAAQ,EAAEjF,CAAC,IAAIW,wBAAwB,CAACN,CAAC,EAAEL,CAAC,CAACG,MAAM,CAAC5E,KAAK,CAAE;0BAC3D6J,WAAW,EAAC,uBAAuB;0BACnCrB,SAAS,EAAC;wBAA4D;0BAAAQ,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OACvE,CAAC,eACF1O,OAAA;0BACEiM,IAAI,EAAC,QAAQ;0BACb8B,SAAS,EAAC,6DAA6D;0BACvEwB,OAAO,EAAEA,CAAA,KAAM/E,oBAAoB,CAACH,CAAC,CAAE;0BAAA2D,QAAA,EACxC;wBAED;0BAAAO,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAQ,CAAC;sBAAA,GApBDrE,CAAC;wBAAAkE,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAqBN,CAAC;oBAAA,CACP;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CACN;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACE,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACN1O,OAAA;cAAAgO,QAAA,EACGW,eAAe,CAAC,eAAe,EAAE,cAAc,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAEnP,IAAI;YAAC;cAAA+O,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC7E,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,gBAEN1O,OAAA;UAAK+N,SAAS,EAAC,mBAAmB;UAAAC,QAAA,gBAChChO,OAAA,CAACR,IAAI;YAACuO,SAAS,EAAC;UAAsC;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACzD1O,OAAA;YAAI+N,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAA0B;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACnF1O,OAAA;YAAG+N,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAuD;YAAAO,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrF,CACN;MAEH;QACE,OAAO,IAAI;IACf;EACF,CAAC;;EAED;EACA,MAAMgC,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAIC,KAAK,GAAG,CAAC,CAAC,CAAC;IACf,IAAIxI,cAAc,CAACL,cAAc,EAAE6I,KAAK,EAAE;IAC1C,IAAIxI,cAAc,CAACH,cAAc,EAAE2I,KAAK,EAAE;IAC1C,IAAIxI,cAAc,CAACF,iBAAiB,EAAE0I,KAAK,EAAE;IAC7C,OAAOA,KAAK;EACd,CAAC;EAED,MAAM1C,UAAU,GAAGyC,aAAa,CAAC,CAAC;EAElC,oBACE1Q,OAAA;IAAK+N,SAAS,EAAC,oEAAoE;IAAAC,QAAA,gBAEjFhO,OAAA;MAAK+N,SAAS,EAAC,mDAAmD;MAAAC,QAAA,gBAChEhO,OAAA;QAAK+N,SAAS,EAAC;MAAwF;QAAAQ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAC9G1O,OAAA;QAAK+N,SAAS,EAAC;MAAuG;QAAAQ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC1H,CAAC,eAGN1O,OAAA;MAAQ+N,SAAS,EAAC,gEAAgE;MAAAC,QAAA,eAChFhO,OAAA;QAAK+N,SAAS,EAAC,6BAA6B;QAAAC,QAAA,eAC1ChO,OAAA;UAAK+N,SAAS,EAAC,mCAAmC;UAAAC,QAAA,gBAChDhO,OAAA;YAAK+N,SAAS,EAAC,mBAAmB;YAAAC,QAAA,gBAChChO,OAAA;cACEuP,OAAO,EAAEA,CAAA,KAAM3B,MAAM,CAACgD,OAAO,CAACC,IAAI,CAAC,CAAE;cACrC9C,SAAS,EAAC,4FAA4F;cAAAC,QAAA,eAEtGhO,OAAA,CAACtB,SAAS;gBAACqP,SAAS,EAAC;cAAoB;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACtC,CAAC,eACT1O,OAAA;cAAK+N,SAAS,EAAC,mBAAmB;cAAAC,QAAA,gBAChChO,OAAA;gBAAK+N,SAAS,EAAC,6FAA6F;gBAAAC,QAAA,eAC1GhO,OAAA,CAACP,IAAI;kBAACsO,SAAS,EAAC;gBAAoB;kBAAAQ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACpC,CAAC,eACN1O,OAAA;gBAAAgO,QAAA,gBACEhO,OAAA;kBAAI+N,SAAS,EAAC,8BAA8B;kBAAAC,QAAA,EAAC;gBAAc;kBAAAO,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAChE1O,OAAA;kBAAG+N,SAAS,EAAC,uBAAuB;kBAAAC,QAAA,EAAC;gBAAyB;kBAAAO,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC/D,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAEN1O,OAAA;YAAK+N,SAAS,EAAC,6BAA6B;YAAAC,QAAA,gBAC1ChO,OAAA;cACEuP,OAAO,EAAEA,CAAA,KAAM9D,UAAU,CAAC,IAAI,CAAE;cAChCqF,QAAQ,EAAExM,MAAO;cACjByJ,SAAS,EAAC,8IAA8I;cAAAC,QAAA,GAEvJ1J,MAAM,gBAAGtE,OAAA,CAAClB,OAAO;gBAACiP,SAAS,EAAC;cAA2B;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,gBAAG1O,OAAA,CAACrB,IAAI;gBAACoP,SAAS,EAAC;cAAc;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EAAC,YAElG;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAET1O,OAAA;cACEuP,OAAO,EAAEA,CAAA,KAAM9D,UAAU,CAAC,KAAK,CAAE;cACjCqF,QAAQ,EAAExM,MAAO;cACjByJ,SAAS,EAAC,oLAAoL;cAAAC,QAAA,GAE7L1J,MAAM,gBAAGtE,OAAA,CAAClB,OAAO;gBAACiP,SAAS,EAAC;cAA2B;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,gBAAG1O,OAAA,CAACnB,WAAW;gBAACkP,SAAS,EAAC;cAAc;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EAAC,aAEzG;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,eAET1O,OAAA;MAAK+N,SAAS,EAAC,sCAAsC;MAAAC,QAAA,GAElDF,mBAAmB,CAAC,CAAC,eAGtB9N,OAAA;QAAK+N,SAAS,EAAC,oEAAoE;QAAAC,QAAA,gBACjFhO,OAAA;UAAK+N,SAAS,EAAC,MAAM;UAAAC,QAAA,gBACnBhO,OAAA;YAAI+N,SAAS,EAAC,oCAAoC;YAAAC,QAAA,GAC/CxJ,WAAW,KAAK,CAAC,IAAI,iCAAiC,EACtDA,WAAW,KAAK,CAAC,IAAI,oBAAoB,EACzCA,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAI,uBAAuB,EAC7EtD,WAAW,KAAK,CAAC,IAAI,CAAC2D,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IAAI,oBAAoB,EAC5GxD,WAAW,KAAK,CAAC,IAAI,CAAC2D,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAiB,IAAI,uBAAuB,EACpJzD,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IAAI,oBAAoB,EAC3GxD,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAiB,IAAI,uBAAuB,EACnJzD,WAAW,KAAK,CAAC,IAAI,uBAAuB;UAAA;YAAA+J,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3C,CAAC,eACL1O,OAAA;YAAG+N,SAAS,EAAC,eAAe;YAAAC,QAAA,GACzBxJ,WAAW,KAAK,CAAC,IAAI,0DAA0D,EAC/EA,WAAW,KAAK,CAAC,IAAI,4CAA4C,EACjEA,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAI,iCAAiC,EACvFtD,WAAW,KAAK,CAAC,IAAI,CAAC2D,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IAAI,gCAAgC,EACxHxD,WAAW,KAAK,CAAC,IAAI,CAAC2D,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAiB,IAAI,sCAAsC,EACnKzD,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAIK,cAAc,CAACH,cAAc,IAAI,gCAAgC,EACvHxD,WAAW,KAAK,CAAC,IAAI2D,cAAc,CAACL,cAAc,IAAI,CAACK,cAAc,CAACH,cAAc,IAAIG,cAAc,CAACF,iBAAiB,IAAI,sCAAsC,EAClKzD,WAAW,KAAK,CAAC,IAAI,sCAAsC;UAAA;YAAA+J,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3D,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC,EAELsB,UAAU,CAAC,CAAC,eAGbhQ,OAAA;UAAK+N,SAAS,EAAC,sEAAsE;UAAAC,QAAA,gBACnFhO,OAAA;YACEuP,OAAO,EAAEA,CAAA,KAAM9K,cAAc,CAACsM,IAAI,CAACC,GAAG,CAAC,CAAC,EAAExM,WAAW,GAAG,CAAC,CAAC,CAAE;YAC5DsM,QAAQ,EAAEtM,WAAW,KAAK,CAAE;YAC5BuJ,SAAS,EAAC,8HAA8H;YAAAC,QAAA,gBAExIhO,OAAA,CAACtB,SAAS;cAACqP,SAAS,EAAC;YAAc;cAAAQ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,YAExC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAET1O,OAAA;YAAK+N,SAAS,EAAC,6BAA6B;YAAAC,QAAA,GACzCxJ,WAAW,KAAKyJ,UAAU,IAAIjN,QAAQ,CAACiC,kBAAkB,iBACxDjD,OAAA;cACEuP,OAAO,EAAE9B,wBAAyB;cAClCM,SAAS,EAAC,uGAAuG;cAAAC,QAAA,gBAEjHhO,OAAA,CAACpB,IAAI;gBAACmP,SAAS,EAAC;cAAc;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,yBAEnC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CACT,EAEAlK,WAAW,GAAGyJ,UAAU,gBACvBjO,OAAA;cACEuP,OAAO,EAAEA,CAAA,KAAM9K,cAAc,CAACsM,IAAI,CAACE,GAAG,CAAChD,UAAU,EAAEzJ,WAAW,GAAG,CAAC,CAAC,CAAE;cACrEuJ,SAAS,EAAC,sJAAsJ;cAAAC,QAAA,GACjK,MAEC,eAAAhO,OAAA,CAACtB,SAAS;gBAACqP,SAAS,EAAC;cAAyB;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC3C,CAAC,gBAET1O,OAAA;cACEuP,OAAO,EAAEA,CAAA,KAAM9D,UAAU,CAAC,KAAK,CAAE;cACjCqF,QAAQ,EAAExM,MAAO;cACjByJ,SAAS,EAAC,kLAAkL;cAAAC,QAAA,GAE3L1J,MAAM,gBAAGtE,OAAA,CAAClB,OAAO;gBAACiP,SAAS,EAAC;cAA2B;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,gBAAG1O,OAAA,CAACnB,WAAW;gBAACkP,SAAS,EAAC;cAAc;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,EAAC,aAEzG;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CACT;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAGLhL,WAAW,iBACV1D,OAAA;QAAK+N,SAAS,EAAC,gGAAgG;QAAAC,QAAA,gBAC7GhO,OAAA,CAAClB,OAAO;UAACiP,SAAS,EAAC;QAA2B;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,mBAEnD;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN,EAEA9K,UAAU,iBACT5D,OAAA;QAAK+N,SAAS,EAAC,iGAAiG;QAAAC,QAAA,gBAC9GhO,OAAA,CAACnB,WAAW;UAACkP,SAAS,EAAC;QAAc;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,6BAE1C;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eACN1O,OAAA,CAACH,cAAc;MAAA0O,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACf,CAAC;AAEV,CAAC;AAACtO,EAAA,CAnzCID,YAAY;EAAA,QAC8BR,OAAO,EACpCC,WAAW;AAAA;AAAAsR,EAAA,GAFxB/Q,YAAY;AAqzClB,eAAeA,YAAY;AAAC,IAAA+Q,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}